<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { /*

Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/
(function(){function e(g){this.t={};this.tick=function(h,k,f){this.t[h]=[void 0!=f?f:(new Date).getTime(),k];if(void 0==f)try{window.console.timeStamp("CSI/"+h)}catch(m){}};this.getStartTickTime=function(){return this.t.start[0]};this.tick("start",null,g)}var a;if(window.performance)var d=(a=window.performance.timing)&&a.responseStart;var l=0<d?new e(d):new e;window.jstiming={Timer:e,load:l};if(a){var b=a.navigationStart;0<b&&d>=b&&(window.jstiming.srt=d-b)}if(a){var c=window.jstiming.load;0<b&&d>=
b&&(c.tick("_wtsrt",void 0,b),c.tick("wtsrt_","_wtsrt",d),c.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),c&&0<b&&(c.tick("_tbnd",void 0,window.chrome.csi().startE),c.tick("tbnd_","_tbnd",b))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,c&&0<b&&(c.tick("_tbnd",void 0,window.external.startE),c.tick("tbnd_","_tbnd",b))),a&&(window.jstiming.pt=a)}catch(g){}})(); })()
</script>
<link rel="shortcut icon" href="../_/rsrc/1518480252104/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="https://ssl.gstatic.com/sites/p/c9c36f/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { function d(a){return document.getElementById(a)}window.byId=d;function g(a){return a.replace(/^\s+|\s+$/g,"")}window.trim=g;var h=[],k=0;window.JOT_addListener=function(a,b,c){var f=new String(k++);a={eventName:a,handler:b,compId:c,key:f};h.push(a);return f};window.JOT_removeListenerByKey=function(a){for(var b=0;b<h.length;b++)if(h[b].key==a){h.splice(b,1);break}};window.JOT_removeAllListenersForName=function(a){for(var b=0;b<h.length;b++)h[b].eventName==a&&h.splice(b,1)};
window.JOT_postEvent=function(a,b,c){var f={eventName:a,eventSrc:b||{},payload:c||{}};if(window.JOT_fullyLoaded)for(b=h.length,c=0;c<b&&c<h.length;c++){var e=h[c];e&&e.eventName==a&&(f.listenerCompId=e.compId||"",(e="function"==typeof e.handler?e.handler:window[e.handler])&&e(f))}else window.JOT_delayedEvents.push({eventName:a,eventSrc:b,payload:c})};window.JOT_delayedEvents=[];window.JOT_fullyLoaded=!1;
window.JOT_formatRelativeToNow=function(a,b){a=((new Date).getTime()-a)/6E4;if(1440<=a||0>a)return null;var c=0;60<=a&&(a/=60,c=2);2<=a&&c++;return b?window.JOT_siteRelTimeStrs[c].replace("__duration__",Math.floor(a)):window.JOT_userRelTimeStrs[c].replace("__duration__",Math.floor(a))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/a/orabuntu-lxc.com/brandydandyoracle/kvm-and-openvswitch","deleted":false,"title":"KVM and OpenvSwitch","dir":"ltr"},{"path":"/a/orabuntu-lxc.com/brandydandyoracle/kvm-and-openvswitch/kvm-openvswitch-1","deleted":false,"title":"KVM OVS UEL 14.04","dir":"ltr"}];
  var JOT_clearDotPath = 'https://ssl.gstatic.com/sites/p/c9c36f/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"gvizGstaticVersion":"current","enableAnalytics":true,"pageSharingId":"jotspot_page","codeembeds":{"outerIframeSrc":"https://www.gstatic.com/jotspot/embeds/code/0f08d42392f2000e7e3f3daf5b427a43/outer_iframe.html","innerIframeSrc":"https://937448403-jotspot-embeds.googleusercontent.com/code/8d87fa64604b2a11fae2ed06104c58d3/inner_iframe.html"},"enableUniversalAnalytics":false,"sharingPolicy":"OPENED","siteTitle":"brandydandyoracle","experiments":{"enableSubpagesGadgetInTakeout":true,"overrideDisableDomainEditing":false,"DisableSiteEditingFeature__disable_site_editing":true,"disableDomainEditing":false},"jot2atari":{"eligibility":"INELIGIBLE"},"onepickUrl":"https://docs.google.com/picker","adsensePublisherId":null,"features":{"moreMobileStyleImprovements":null,"subscriptionDataMigrationInProgress":null,"plusBadge":false},"configProperties":{"disableSiteEditing":null},"isPublic":true,"newSitesBaseUrl":"https://sites.google.com","isConsumer":false,"serverFlags":{"jot2AtariLearnMoreUrl":"https://support.google.com/sites/answer/7035197"},"domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://accounts.google.com/AccountChooser?continue\u003dhttps://sites.google.com/a/orabuntu-lxc.com/brandydandyoracle/kvm-and-openvswitch/kvm-openvswitch-1\u0026service\u003djotspot","analyticsAccountId":"UA-54224306-1","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"https://gg.google.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["https://ssl.gstatic.com/sites/p/c9c36f/system/app/css/sitelayouteditor.css"],"text":["https://ssl.gstatic.com/sites/p/c9c36f/system/js/codemirror.js","https://ssl.gstatic.com/sites/p/c9c36f/system/app/css/codemirror_css.css","https://ssl.gstatic.com/sites/p/c9c36f/system/js/trog_edit__en.js","https://ssl.gstatic.com/sites/p/c9c36f/system/app/css/trogedit.css","/a/orabuntu-lxc.com/brandydandyoracle/_/rsrc/1628148289000/system/app/css/editor.css","https://ssl.gstatic.com/sites/p/c9c36f/system/app/css/codeeditor.css","/a/orabuntu-lxc.com/brandydandyoracle/_/rsrc/1628148289000/system/app/css/camelot/editor-jfk.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"orabuntu-lxc.com","baseUri":"/a/orabuntu-lxc.com/brandydandyoracle","name":"brandydandyoracle","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/kvm-and-openvswitch","parentWuid":"wuid:gx:4184304c507d6cf0","siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"KVM OVS UEL 14.04","locale":"en","wuid":"wuid:gx:5c2152473fdc6ccc","revision":1,"path":"/kvm-and-openvswitch/kvm-openvswitch-1","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"kvm-openvswitch-1","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false,"isGoogleAdmin":false},"gadgets":{"baseUri":"/a/orabuntu-lxc.com/brandydandyoracle/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="KVM OVS UEL 14.04 - brandydandyoracle" />
<meta itemprop="name" content="KVM OVS UEL 14.04 - brandydandyoracle" />
<meta property="og:title" content="KVM OVS UEL 14.04 - brandydandyoracle" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="https://ssl.gstatic.com/sites/p/c9c36f/system/app/themes/solitudeolive/standard-css-solitudeolive-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="../_/rsrc/1628148289000/system/app/css/overlay.css%3Fcb=solitudeolive93320goog-ws-leftcontentthemedefaultstandard.css" />
<link rel="stylesheet" type="text/css" href="../_/rsrc/1628148289000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/a/orabuntu%2dlxc.com/brandydandyoracle/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>KVM OVS UEL 14.04 - brandydandyoracle</title>
<meta itemprop="image" content="https://sites.google.com/a/orabuntu-lxc.com/brandydandyoracle/_/rsrc/1518480256916/kvm-and-openvswitch/kvm-openvswitch-1/gparted-1.png" />
<meta property="og:image" content="https://sites.google.com/a/orabuntu-lxc.com/brandydandyoracle/_/rsrc/1518480256916/kvm-and-openvswitch/kvm-openvswitch-1/gparted-1.png" />
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner" style="height: 93px"><div class="sites-header-cell-buffer-wrapper"><h2><a href="../index.html" dir="ltr" id="sites-chrome-userheader-title">brandydandyoracle</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="https://sites.google.com/a/orabuntu-lxc.com/brandydandyoracle/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
<div class="sites-header-nav"><ul class="sites-header-nav-container-boxes"><li class="unselected"><a class="sites-navigation-link unselected" href="../system/app/pages/sitemap/hierarchy.html">Sitemap</a></li></ul><div style="clear: both;"></div></div>
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:320px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_2bd" class="sites-embed" role="navigation"><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList" class="has-expander"><li class="topLevel nav-first parent " wuid="gx:1771d7481512b604"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../home.html" jotId="wuid:gx:1771d7481512b604" class="sites-navigation-link topLevel">Home</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../home/brother-mfc-456cn-ubuntu-driver.html" jotId="wuid:gx:687d1f16adfece4e" class="sites-navigation-link">Brother MFC-456CN Ubuntu Driver</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../home/resume-short.html" jotId="wuid:gx:7ed50173758f1f8d" class="sites-navigation-link">Resume-Short</a></div></li></ul></li><li class="topLevel "><div dir="ltr" style="padding-left: 19px;"><a href="../aws.html" jotId="wuid:gx:513e26955ed0bab9" class="sites-navigation-link topLevel">AWS</a></div></li><li class="topLevel parent " wuid="gx:2d7d78782d5199fb"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../blackberry-workspaces.html" jotId="wuid:gx:2d7d78782d5199fb" class="sites-navigation-link topLevel">Blackberry Workspaces</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../blackberry-workspaces/blackberry-workspaces-in-lxc-linux-containers.html" jotId="wuid:gx:3cc6d6487c8feafe" class="sites-navigation-link">Blackberry Workspaces in LXC Linux Containers</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../blackberry-workspaces/blackberry-workspaces-on-aws-ec2.html" jotId="wuid:gx:11790a2b5038525c" class="sites-navigation-link">Blackberry Workspaces on AWS EC2</a></div></li></ul></li><li class="topLevel "><div dir="ltr" style="padding-left: 19px;"><a href="../blackberry-workspaces-in-lxc-linux-containers-on-aws-ec2.html" jotId="wuid:gx:1529117a57ecdba8" class="sites-navigation-link topLevel">Blackberry Workspaces in LXC Linux Containers on AWS EC2</a></div></li><li class="topLevel parent " wuid="gx:515464018f6bd717"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../centos7.html" jotId="wuid:gx:515464018f6bd717" class="sites-navigation-link topLevel">CentOS7</a></div><ul role="navigation" class="has-expander"><li class="parent closed " wuid="gx:46a7d96b1e768956"><div dir="ltr" style="padding-left: 19px;"><div class="expander"></div><a href="../centos7/centos7-desktop.html" jotId="wuid:gx:46a7d96b1e768956" class="sites-navigation-link">CentOS7 Desktop</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="../centos7/centos7-desktop/cisco-anyconnect-vpn-centos-7.html" jotId="wuid:gx:50d39b77de17a94c" class="sites-navigation-link">Cisco AnyConnect VPN CentOS 7 GNOME Desktop</a></div></li><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="../centos7/centos7-desktop/cisco-anyconnect-vpn-centos-7-server-gui-with-kde.html" jotId="wuid:gx:77bba3a647193c" class="sites-navigation-link">Cisco AnyConnect VPN CentOS 7 Server GUI with KDE</a></div></li></ul></li><li class="parent closed " wuid="gx:73046cf3c3d2eaf2"><div dir="ltr" style="padding-left: 19px;"><div class="expander"></div><a href="../centos7/centos7-general.html" jotId="wuid:gx:73046cf3c3d2eaf2" class="sites-navigation-link">CentOS7 General</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="../centos7/centos7-general/dns-named-install-centos7-1.html" jotId="wuid:gx:3ac64e4220d3882e" class="sites-navigation-link">DNS DHCP Install CentOS7</a></div></li><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="../centos7/centos7-general/lxc-create-centos-7-2-container.html" jotId="wuid:gx:317f96357032310b" class="sites-navigation-link">LXC Create CentOS 7.2 Container</a></div></li><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="../centos7/centos7-general/lxc-source-build-centos7.html" jotId="wuid:gx:5affb1858ab31aa9" class="sites-navigation-link">LXC Source Build CentOS7</a></div></li><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="../centos7/centos7-general/openvswitch-source-build-centos7.html" jotId="wuid:gx:156568a493298e2c" class="sites-navigation-link">OVS  (OpenvSwitch) Source Build CentOS7</a></div></li><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="../centos7/centos7-general/scst-centos-7-2-1511-core.html" jotId="wuid:gx:212b0b144e1fcb8c" class="sites-navigation-link">SCST Source Build CentOS7</a></div></li><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="../centos7/centos7-general/xfs-lvm-grow-centos7.html" jotId="wuid:gx:5e00471ebcc94e3e" class="sites-navigation-link">XFS LVM Grow CentOS7</a></div></li></ul></li></ul></li><li class="topLevel parent " wuid="gx:4184304c507d6cf0"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../kvm-and-openvswitch.html" jotId="wuid:gx:4184304c507d6cf0" class="sites-navigation-link topLevel">KVM and OpenvSwitch</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="add-pv-kvm-guest-vg.html" jotId="wuid:gx:f4ec37bc44defc6" class="sites-navigation-link">KVM Add PV Guest VG</a></div></li><li class="parent closed " wuid="gx:140bef1e880d2c0c"><div dir="ltr" style="padding-left: 19px;"><div class="expander"></div><a href="kvm-dg-migration.html" jotId="wuid:gx:140bef1e880d2c0c" class="sites-navigation-link">KVM DG Migration</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="kvm-dg-migration/rman-script.html" jotId="wuid:gx:67093dbbc93cdadc" class="sites-navigation-link">RMAN Script</a></div></li></ul></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="kvm-dns-oel-6-5.html" jotId="wuid:gx:5f50087695eef84b" class="sites-navigation-link">KVM DNS OEL 6.5</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="kvm-dns-ul-14-04.html" jotId="wuid:gx:42ab043f5ac96f0f" class="sites-navigation-link">KVM DNS UL 14.04</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="kvm-lxc-dns-ul-14-04.html" jotId="wuid:gx:2cd19b29fe55d875" class="sites-navigation-link">KVM LXC DNS UL 14.04</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="kvm-mail-oel-6-5.html" jotId="wuid:gx:76072d3822550956" class="sites-navigation-link">KVM MAIL OEL 6.5</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="kvm-oracle-clone.html" jotId="wuid:gx:152a84896b4db53b" class="sites-navigation-link">KVM Oracle Clone</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="ovs-kvm-oel-6-5.html" jotId="wuid:gx:371cf26362b6010e" class="sites-navigation-link">KVM OVS OEL 6.5</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="kvm-ovs-oel-6-5.html" jotId="wuid:gx:75ead37952686999" class="sites-navigation-link">KVM OVS OEL 6.5</a></div></li><li class=""><div class="current-bg" jotId="wuid:gx:5c2152473fdc6ccc" dir="ltr" style="padding-left: 38px;">KVM OVS UEL 14.04</div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="resize-swap-lv.html" jotId="wuid:gx:399989aadef41fc3" class="sites-navigation-link">KVM Resize Swap LV</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="remove-kvm-disk.html" jotId="wuid:gx:707b288cc8f2b5a6" class="sites-navigation-link">Remove KVM Disk</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="remove-kvm-vbdp-disk.html" jotId="wuid:gx:33b6b83da936ce09" class="sites-navigation-link">Remove KVM VBDP Disk</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="resize-kvm-disk.html" jotId="wuid:gx:623a431aae174a92" class="sites-navigation-link">Resize KVM Disk</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="solaris-10-kvm-ovs-12c-gi-rac.html" jotId="wuid:gx:422583d75ebc70db" class="sites-navigation-link">Solaris 10 KVM OVS 12c GI RAC</a></div></li></ul></li><li class="topLevel parent " wuid="gx:4327ced0f58d8a86"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../lenovo-thinkpad-p70.html" jotId="wuid:gx:4327ced0f58d8a86" class="sites-navigation-link topLevel">Lenovo ThinkPad P70</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lenovo-thinkpad-p70/a-brief-guide-to-running-multiple-os-on-lenovo-thinkpad-p70-mobile-workstation.html" jotId="wuid:gx:48694287bced9d0a" class="sites-navigation-link">A Brief Guide to Running Multiple OS  on Lenovo ThinkPad P70 Mobile Workstation</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lenovo-thinkpad-p70/booting-to-graphical-ui-oracle-uek4-kernel-on-lenovo-p70-thinkpad.html" jotId="wuid:gx:30d8c05433ca020b" class="sites-navigation-link">Booting to Graphical UI Desktop Oracle UEK4 Kernel on Lenovo P70 Thinkpad</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lenovo-thinkpad-p70/configure-wired-network-uek3-lenovo-p70-thinkpad.html" jotId="wuid:gx:77458fd960e08fe6" class="sites-navigation-link">Configure Wired Network UEK3 Lenovo P70 ThinkPad</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lenovo-thinkpad-p70/configure-wireless-network-uek3-lenovo-p70-thinkpad.html" jotId="wuid:gx:784425a052a48fc4" class="sites-navigation-link">Configure Wireless Network UEK3 Lenovo P70 ThinkPad</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lenovo-thinkpad-p70/configuring-external-monitors-on-oracle-linux-uek4-kernel-on-lenovo-p70-thinkpad.html" jotId="wuid:gx:6d22a62e4b021a82" class="sites-navigation-link">Configuring External Monitors on Oracle Linux UEK4 Kernel on Lenovo P70 ThinkPad</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lenovo-thinkpad-p70/configuring-wifi-on-oracle-linux-uek4-kernel.html" jotId="wuid:gx:2491259c2c6fb6e7" class="sites-navigation-link">Configuring WIFI on Oracle Linux UEK4 Kernel on Lenovo P70 ThinkPad</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lenovo-thinkpad-p70/advantages-of-running-multiple-linux-distros-on-lenovo-p70-thinkpad-mobile-workstation.html" jotId="wuid:gx:3e26fa7db9c8ec5d" class="sites-navigation-link">Fixing BooBoos with Multiple Linux Distros on Lenovo P70 ThinkPad Mobile Workstation</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lenovo-thinkpad-p70/flash-installation-oracle-linux-uek4-lenovo-p70-mobile-workstation.html" jotId="wuid:gx:206da7bba5eb893d" class="sites-navigation-link">Flash Installation Oracle Linux UEK4 Lenovo P70 Mobile Workstation</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lenovo-thinkpad-p70/lenovo-thinkpad-p70-bios-flash-upgrade.html" jotId="wuid:gx:13c9853fd6822c1e" class="sites-navigation-link">Lenovo ThinkPad P70 BIOS Flash Upgrade</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lenovo-thinkpad-p70/samsung-256-gb-m-2-950-pro-nvme.html" jotId="wuid:gx:4cf81fe1594a405c" class="sites-navigation-link">Samsung 256 Gb M.2 950 Pro NVME</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lenovo-thinkpad-p70/samsung-evo-950-pro-256gb-m-2-ssd-vs-pm951-512gb-m-2-ssd.html" jotId="wuid:gx:5ea2a361cb8c66c8" class="sites-navigation-link">Samsung [(evo950 nvme) vs (pm951 nvme)] vs. Toshiba [OCZ RD400 1Tb nvme] M.2</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lenovo-thinkpad-p70/ubuntu-17-10-artful-aardvark-lenovo-p70-mobile-workstation.html" jotId="wuid:gx:6fcad2f1dc0cfefc" class="sites-navigation-link">Ubuntu 17.10 Artful Aardvark Lenovo P70 Mobile Workstation</a></div></li></ul></li><li class="topLevel parent " wuid="gx:2a65617e5bca4df7"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../lenovo-p72.html" jotId="wuid:gx:2a65617e5bca4df7" class="sites-navigation-link topLevel">Lenovo ThinkPad P72</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lenovo-p72/lenovo-part-40an0230us-thinkpad-thunderbolt-3-workstation-dock.html" jotId="wuid:gx:3b289d1da9ec8d8" class="sites-navigation-link">Lenovo Part #40AN0230US ThinkPad Thunderbolt 3 Workstation Dock</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lenovo-p72/lenovo-part-gx90m61235-thinkpad-usb-c-travel-hub.html" jotId="wuid:gx:62e9dde894d17ff7" class="sites-navigation-link">Lenovo Part #GX90M61235 ThinkPad USB-C Travel Hub</a></div></li></ul></li><li class="topLevel parent " wuid="gx:3c0bb513eca76dd7"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../lxc-linux-containers.html" jotId="wuid:gx:3c0bb513eca76dd7" class="sites-navigation-link topLevel">LXC Linux Containers</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lxc-linux-containers/install-oracle-supported-lxc-version-on-oracle-linux-uek4.html" jotId="wuid:gx:2803b780a785d633" class="sites-navigation-link">Install Oracle-Supported LXC Version on Oracle Linux 7 UEK4</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lxc-linux-containers/lxc-3-0-1-oracle-8-source-build.html" jotId="wuid:gx:6d97bc40356b5b00" class="sites-navigation-link">LXC 3.0.1 Oracle 8 Source Build</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lxc-linux-containers/lxc-environment-oel6.html" jotId="wuid:gx:498ae875c3ff8712" class="sites-navigation-link">LXC Environment OEL6</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lxc-linux-containers/lxc-in-windows-10-bash-shell.html" jotId="wuid:gx:6b5a1e6d23bf1535" class="sites-navigation-link">LXC in Windows 10 Bash Shell</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lxc-linux-containers/lxc-iproute2.html" jotId="wuid:gx:4770b5dee1c84e5d" class="sites-navigation-link">LXC iproute2</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lxc-linux-containers/lxc-oracle-rdbms.html" jotId="wuid:gx:66170fca9aaf9bdb" class="sites-navigation-link">LXC Oracle RDBMS</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lxc-linux-containers/lxc-ovs-bind-dns.html" jotId="wuid:gx:5ba336cc440e699a" class="sites-navigation-link">LXC OVS BIND DNS</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lxc-linux-containers/lxc-vlc-oel6-5.html" jotId="wuid:gx:4e0871c894b402f5" class="sites-navigation-link">LXC VLC OEL6.5</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lxc-linux-containers/nvme-in-lxc.html" jotId="wuid:gx:344f13d75997f6ef" class="sites-navigation-link">NVME in LXC</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lxc-linux-containers/source-build-lxc-ubuntu-16-04.html" jotId="wuid:gx:3668e93ca6fd3ec7" class="sites-navigation-link">Source Build LXC Ubuntu 16.04</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../lxc-linux-containers/veth-pair-cleanup-lxc.html" jotId="wuid:gx:eb4a3c8e75f750" class="sites-navigation-link">Veth Pair Cleanup LXC</a></div></li></ul></li><li class="topLevel parent " wuid="gx:904bf1e1a964cfa"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../oracle-in-lxd-1.html" jotId="wuid:gx:904bf1e1a964cfa" class="sites-navigation-link topLevel">LXD the Lighter-visor</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../oracle-in-lxd-1/building-oracle-enteprise-in-lxd.html" jotId="wuid:gx:3385e4f2498c1f97" class="sites-navigation-link">Building Oracle Enteprise in LXD</a></div></li></ul></li><li class="topLevel parent " wuid="gx:141aad64735ed8a7"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../openvswitch-ovs.html" jotId="wuid:gx:141aad64735ed8a7" class="sites-navigation-link topLevel">OpenvSwitch (OVS)</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../openvswitch-ovs/build-networkmanager-1-11-1-on-ubuntu-17-10.html" jotId="wuid:gx:4cd3336e7866b65e" class="sites-navigation-link">Build NetworkManager 1.11.1 on Ubuntu 17.10</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../openvswitch-ovs/configuring-virtualbox-vms-for-openvswitch-networking.html" jotId="wuid:gx:102f61a047f4fe27" class="sites-navigation-link">Configuring VirtualBox VMs for OpenvSwitch Networking</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../openvswitch-ovs/install-openvswitch-oel-uek3.html" jotId="wuid:gx:2603341f63b9d97a" class="sites-navigation-link">Install OpenvSwitch OEL UEK3</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../openvswitch-ovs/networking-problem-1.html" jotId="wuid:gx:65a0bbff837cdb64" class="sites-navigation-link">Networking Problem:  "The Lawnmower Man"</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../openvswitch-ovs/openvswitch-patch-ports.html" jotId="wuid:gx:9eac33f7488f9a0" class="sites-navigation-link">OpenvSwitch Patch Ports</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../openvswitch-ovs/build-openvswitch-from-source-on-oracle-linux-uek.html" jotId="wuid:gx:5d8addb931f09666" class="sites-navigation-link">OVS Source Build Oracle Linux 6 UEK3 Kernel</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../openvswitch-ovs/openvswitch-source-build-oracle-linux-7-uek4.html" jotId="wuid:gx:9f9da13c419a4e6" class="sites-navigation-link">OVS Source Build Oracle Linux 7 UEK4 Kernel</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../openvswitch-ovs/ovs-source-build-ubuntu-linux-16-04.html" jotId="wuid:gx:cc6b77eb34b437c" class="sites-navigation-link">OVS Source Build Ubuntu Linux 16.04</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../openvswitch-ovs/ovs-switch-as-a-service.html" jotId="wuid:gx:657c023b7927b1fa" class="sites-navigation-link">OVS Switch-As-A-Service Oracle Linux 7 UEK4</a></div></li></ul></li><li class="topLevel parent " wuid="gx:2a47e1cfadbf417d"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../orabuntu-lxc.html" jotId="wuid:gx:2a47e1cfadbf417d" class="sites-navigation-link topLevel">Orabuntu-LXC</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../orabuntu-lxc/using-systemd-resolved-in-a-networkmanager-environment.html" jotId="wuid:gx:87f2aaaf2ecb31b" class="sites-navigation-link">Configuring systemd-resolved in a NetworkManager Environment</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../orabuntu-lxc/lxc-containerized-dns-dhcp-configurations.html" jotId="wuid:gx:3d12f3317c481ea" class="sites-navigation-link">LXC Containerized DNS-DHCP Configurations (Ubuntu dnsmasq bind9)</a></div></li></ul></li><li class="topLevel parent " wuid="gx:56211f056f6b1e69"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../oracle-asmlib.html" jotId="wuid:gx:56211f056f6b1e69" class="sites-navigation-link topLevel">Oracle ASM and ASMLib</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../oracle-asmlib/build-asmlib-from-source.html" jotId="wuid:gx:37a420222f203d29" class="sites-navigation-link">ASMLib Source Build RHEL5</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../oracle-asmlib/build-asmlib-from-source-on-rhel6.html" jotId="wuid:gx:258e6072b6403dc3" class="sites-navigation-link">ASMLib Source Build RHEL6</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../oracle-asmlib/rename-asm-sysdg.html" jotId="wuid:gx:44112e6c154428fe" class="sites-navigation-link">Rename ASM SYSDG</a></div></li></ul></li><li class="topLevel "><div dir="ltr" style="padding-left: 19px;"><a href="../oracle-in-lxd.html" jotId="wuid:gx:1e2c0c88ac7cfde3" class="sites-navigation-link topLevel">Oracle in LXD</a></div></li><li class="topLevel parent " wuid="gx:7024699ef06b6856"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../oracle-linux-uek-kernel.html" jotId="wuid:gx:7024699ef06b6856" class="sites-navigation-link topLevel">Oracle Linux UEK Kernel</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../oracle-linux-uek-kernel/configuring-ipmi-console-redirection.html" jotId="wuid:gx:323acc64d4abf9a4" class="sites-navigation-link">Configuring IPMI Console Redirection</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../oracle-linux-uek-kernel/getting-kernel-headers-for-oracle-linux-uek-kernels.html" jotId="wuid:gx:264700ca67aa6f51" class="sites-navigation-link">Getting Kernel Headers Oracle Linux 7 UEK</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../oracle-linux-uek-kernel/lxc-source-build-oracle-linux-uek4.html" jotId="wuid:gx:65f6caada28e4879" class="sites-navigation-link">LXC Source Build Oracle Linux 7 UEK4</a></div></li></ul></li><li class="topLevel parent " wuid="gx:392e9c328d805127"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../oracle-rac.html" jotId="wuid:gx:392e9c328d805127" class="sites-navigation-link topLevel">Oracle RAC</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../oracle-rac/re-ip-rac.html" jotId="wuid:gx:60fa56c8049956b9" class="sites-navigation-link">Re-IP RAC</a></div></li></ul></li><li class="topLevel parent " wuid="gx:49aa6ea0c073802a"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../oracle-rac-in-lxc-linux-containers.html" jotId="wuid:gx:49aa6ea0c073802a" class="sites-navigation-link topLevel">Oracle RAC in LXC Linux Containers</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../oracle-rac-in-lxc-linux-containers/12c-asm-flex-cluster-on-violin-memory-array.html" jotId="wuid:gx:2d93d5e8d118918d" class="sites-navigation-link">12c ASM Flex Cluster on Violin Memory Array</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../oracle-rac-in-lxc-linux-containers/oracle-12c-6-node-asm-gns-flex-rac-on-lxc-linux-containers-ubuntu-15-04.html" jotId="wuid:gx:31b7a6e9df077adf" class="sites-navigation-link">Oracle 12c 6-node ASM GNS Flex RAC on LXC Linux Containers Ubuntu 15.04</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../oracle-rac-in-lxc-linux-containers/oracle-12c-rac-asm-flex-cluster-on-ubuntu-14-10.html" jotId="wuid:gx:6d52027c26f6bd96" class="sites-navigation-link">Oracle 12c RAC ASM Flex Cluster on LXC Linux Containers Ubuntu 14.10</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../oracle-rac-in-lxc-linux-containers/oracle-12c-rac-asm-flex-cluster-on-lxc-linux-containers-ubuntu-14-10.html" jotId="wuid:gx:7cf2aebcf0bd8b4a" class="sites-navigation-link">Oracle 12c RAC ASM Flex Cluster on LXC Linux Containers Ubuntu 14.10</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../oracle-rac-in-lxc-linux-containers/oracle-12c-rac-asm-flex-cluster-on-lxc-linux-containers-ubuntu-15-04.html" jotId="wuid:gx:e7aeed695cf1a4a" class="sites-navigation-link">Oracle 12c RAC ASM Flex Cluster on LXC Linux Containers Ubuntu 15.04</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../oracle-rac-in-lxc-linux-containers/oracle-12c-rac-in-gce-on-ubuntu-14-04-1.html" jotId="wuid:gx:ed0be0d284c02f0" class="sites-navigation-link">Oracle 12c RAC in GCE on Ubuntu 14.04.1</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../oracle-rac-in-lxc-linux-containers/oracle-lxc-vlc.html" jotId="wuid:gx:3ecee06d4a4b2ffe" class="sites-navigation-link">Oracle EE ASM 12c LXC Ubuntu 14.04</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../oracle-rac-in-lxc-linux-containers/docker-11gr2-ee-ul.html" jotId="wuid:gx:2863b8f1b8a0ae5d" class="sites-navigation-link">Oracle EE DB 11gR2 Docker Ubuntu 14.04</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../oracle-rac-in-lxc-linux-containers/oracle-rac-6-node-12c-gns-asm-flex-cluster-ubuntu-15-04-automated.html" jotId="wuid:gx:1360b78ff726d213" class="sites-navigation-link">Oracle RAC 6-node 12c GNS ASM Flex Cluster Ubuntu 15.04 Automated</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../oracle-rac-in-lxc-linux-containers/oracle-rac-6-node-12c-gns-asm-flex-cluster-ubuntu-15-04-install.html" jotId="wuid:gx:d6f61d65bebb324" class="sites-navigation-link">Oracle RAC 6-node 12c GNS ASM Flex Cluster Ubuntu 15.04 Install</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../oracle-rac-in-lxc-linux-containers/ubuntu-14-04-1-asm-flex-cluster-on-lxc-containers.html" jotId="wuid:gx:55d12384bf11a4ac" class="sites-navigation-link">Ubuntu 14.04.1 Oracle GI 12c ASM Flex Cluster on LXC Containers</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../oracle-rac-in-lxc-linux-containers/lxc-ovs-rac-gns.html" jotId="wuid:gx:3a38a5c143561a9b" class="sites-navigation-link">Ubuntu LXC OEL OVS ASM GNS RAC (12c)</a></div></li></ul></li><li class="topLevel parent " wuid="gx:b42a27877981be1"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../oracle-rman.html" jotId="wuid:gx:b42a27877981be1" class="sites-navigation-link topLevel">Oracle RMAN</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../oracle-rman/rman-active-duplicate-script.html" jotId="wuid:gx:51524327d66ae40f" class="sites-navigation-link">RMAN Active Duplicate Script</a></div></li></ul></li><li class="topLevel parent " wuid="gx:89ec64364eab694"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../engineering-docs.html" jotId="wuid:gx:89ec64364eab694" class="sites-navigation-link topLevel">Projects</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../engineering-docs/11gr2---12cr2-dataguard-upgrade-in-ol-lxc-on-ubuntu-17-04.html" jotId="wuid:gx:1da20af09381ca55" class="sites-navigation-link">11gR2 -&gt; 12cR2 Dataguard Upgrade in OL LXC on Ubuntu 17.04</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../engineering-docs/vmos6-oracle-snapshots.html" jotId="wuid:gx:1ea7e4c3c5ca52d" class="sites-navigation-link">VMOS6 Oracle Snapshots</a></div></li></ul></li><li class="topLevel parent " wuid="gx:204d0c728c285380"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../robin-systems.html" jotId="wuid:gx:204d0c728c285380" class="sites-navigation-link topLevel">Robin Systems</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../robin-systems/configuring-hugepages-for-oracle.html" jotId="wuid:gx:52999571538d8ca7" class="sites-navigation-link">Configuring HugePages for Oracle on CentOS 7 Robin Hosts</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../robin-systems/robin-12c-rac-asm-flex-cluster.html" jotId="wuid:gx:4460573d54662758" class="sites-navigation-link">Robin 12c RAC ASM Flex Cluster</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../robin-systems/robin-server-install-centos-7-vm.html" jotId="wuid:gx:573c9ade4fca5871" class="sites-navigation-link">Robin Server Install CentOS 7 VM</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../robin-systems/robin-slob2-pdb-protocols.html" jotId="wuid:gx:4f404578ed53bc1" class="sites-navigation-link">Robin SLOB2 PDB Protocols</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../robin-systems/robin-slob2-testing-notes.html" jotId="wuid:gx:653c530a0894e054" class="sites-navigation-link">Robin SLOB2 Testing Notes</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../robin-systems/robin-virtualbox-ovs.html" jotId="wuid:gx:3ede1bee391dc4db" class="sites-navigation-link">Robin VirtualBox OVS</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../robin-systems/the-surfing-life.html" jotId="wuid:gx:1f2b8b97c48d346a" class="sites-navigation-link">The Surfing Life</a></div></li></ul></li><li class="topLevel parent " wuid="gx:42a5103bbab0903f"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../scst.html" jotId="wuid:gx:42a5103bbab0903f" class="sites-navigation-link topLevel">SCST</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../scst/reset-lun-read-only-attributes.html" jotId="wuid:gx:19d5a823bab350d4" class="sites-navigation-link">Reset LUN Read-Only Attributes</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../scst/scst-create-deb-package-and-install-fpm.html" jotId="wuid:gx:2f9a5abb765dc8ab" class="sites-navigation-link">SCST Create Deb Package and Install</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../scst/scst-debian-dkms-package-build-from-source-ubuntu-17-04.html" jotId="wuid:gx:263b273ada4b1198" class="sites-navigation-link">SCST Debian (DKMS) Package Build from Source (Ubuntu  15.04-17.04+)</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../scst/scst-debian-dkms-package-build-from-source-ubuntu-14-04.html" jotId="wuid:gx:37519387aa0d7b34" class="sites-navigation-link">SCST Debian (DKMS) Package Build from Source (Ubuntu 14.04)</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../scst/scst-debian-package-build-from-source-ubuntu-15-04-17-04.html" jotId="wuid:gx:376a668b36e2458e" class="sites-navigation-link">SCST Debian Package Build from Source (Ubuntu 15.04-17.04+)</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../scst/scst-debian-package-build-from-source-ubuntu-17-04.html" jotId="wuid:gx:23e3728da5d7b341" class="sites-navigation-link">SCST Debian Package Build from Source (Ubuntu 17.04)</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../scst/kvm-scst-oel-6-5.html" jotId="wuid:gx:35aca0b4a22810be" class="sites-navigation-link">SCST KVM OEL 6.5</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../scst/kvm-scst-uek-3-8.html" jotId="wuid:gx:727a09d4af2e0cb6" class="sites-navigation-link">SCST KVM UEK 3.8</a></div></li><li class="parent closed " wuid="gx:22f557a9fc2e1e25"><div dir="ltr" style="padding-left: 19px;"><div class="expander"></div><a href="../scst/scst-linux-san.html" jotId="wuid:gx:22f557a9fc2e1e25" class="sites-navigation-link">SCST Linux SAN</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="../scst/scst-linux-san/add-asm-dg.html" jotId="wuid:gx:2bc6ef8def1e36c9" class="sites-navigation-link">Add ASM DG</a></div></li><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="../scst/scst-linux-san/add-asm-dg-4k.html" jotId="wuid:gx:242dab2dbfad9ac5" class="sites-navigation-link">Add ASM DG (4K)</a></div></li><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="../scst/scst-linux-san/add-asm-lun.html" jotId="wuid:gx:2fedfac6897719" class="sites-navigation-link">Add ASM LUN</a></div></li><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="../scst/scst-linux-san/add-lun.html" jotId="wuid:gx:4b7b14970b8123cc" class="sites-navigation-link">Add LUN</a></div></li><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="../scst/scst-linux-san/resize-asm-lun.html" jotId="wuid:gx:546bc643a9b955fd" class="sites-navigation-link">Resize ASM LUN</a></div></li></ul></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../scst/lxc-scst-ul-14-04.html" jotId="wuid:gx:56ede6a9ffa466a3" class="sites-navigation-link">SCST LXC UL 14.04</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../scst/scst-ol-uek-3.html" jotId="wuid:gx:775819e6573c1127" class="sites-navigation-link">SCST OL UEK 3</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../scst/scst-package-build-and-install-ubuntu-17-04---14-04.html" jotId="wuid:gx:94e286580e7f53a" class="sites-navigation-link">SCST Package Build Install (Ubuntu 14.x-17.x)</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../scst/build-scst-from-source-on-oracle-linux-uek.html" jotId="wuid:gx:11bdab641c7da34" class="sites-navigation-link">SCST Source Build Oracle UEK</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../scst/scst-ubuntu-15-04.html" jotId="wuid:gx:7ac9dfabcffec63d" class="sites-navigation-link">SCST Ubuntu 15.04</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../scst/scst-ubuntu-16-04.html" jotId="wuid:gx:3dd6f13e96e8fcdf" class="sites-navigation-link">SCST Ubuntu 16.04</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../scst/update-gpg-key-email-address-for-signing-debian-packages.html" jotId="wuid:gx:69975edf103e1292" class="sites-navigation-link">Update GPG1 Key Email Address, Add UID, Secret Key</a></div></li></ul></li><li class="topLevel "><div dir="ltr" style="padding-left: 19px;"><a href="../the-surfing-life.html" jotId="wuid:gx:6260f278e385cf3d" class="sites-navigation-link topLevel">The Surfing Life</a></div></li><li class="topLevel parent " wuid="gx:3feac623e97563f8"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../tools.html" jotId="wuid:gx:3feac623e97563f8" class="sites-navigation-link topLevel">Tools</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../tools/awr-analyzer-v3-02.html" jotId="wuid:gx:77df010a1161688f" class="sites-navigation-link">AWR Analyzer v3.02</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../tools/cisco-anyconnect-vpn-centos-7.html" jotId="wuid:gx:1d46650a5d12d8f8" class="sites-navigation-link">Cisco AnyConnect VPN CentOS 7</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../tools/dtrace-linux.html" jotId="wuid:gx:8cdf7bdd75524d8" class="sites-navigation-link">DTrace Linux</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../tools/iotop.html" jotId="wuid:gx:638d81a1909fcba9" class="sites-navigation-link">iotop</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../tools/iscsiadm.html" jotId="wuid:gx:5d490b3b5ae2b18b" class="sites-navigation-link">iscsiadm</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../tools/lynx-html-cli.html" jotId="wuid:gx:3c44570e4d9e5dbe" class="sites-navigation-link">lynx HTML CLI</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../tools/nsupdate.html" jotId="wuid:gx:3dd2f364ba8d97c3" class="sites-navigation-link">nsupdate</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../tools/orion.html" jotId="wuid:gx:5e1bc1ac2b426298" class="sites-navigation-link">Orion</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../tools/perf_stat.html" jotId="wuid:gx:17c3dad58ddee2ec" class="sites-navigation-link">perf_stat</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../tools/qemu-monitor-command.html" jotId="wuid:gx:332a02f511ef9aa0" class="sites-navigation-link">QEMU Monitor Command</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../tools/sflow.html" jotId="wuid:gx:51f13dca17c0f452" class="sites-navigation-link">sflow</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../tools/slob.html" jotId="wuid:gx:6fb549ba8af63cc8" class="sites-navigation-link">SLOB2</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../tools/slob2-12c-rac-pdb-version.html" jotId="wuid:gx:7370bb97c3458d1c" class="sites-navigation-link">SLOB2 (12c RAC PDB Version)</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../tools/tunnels.html" jotId="wuid:gx:67c0050b2d97d566" class="sites-navigation-link">Tunnels</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../tools/vdbench.html" jotId="wuid:gx:5a058833aa18c315" class="sites-navigation-link">VDBench</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../tools/virt-alignment-scan.html" jotId="wuid:gx:7ef6511f7ec6d8fc" class="sites-navigation-link">virt-alignment-scan</a></div></li></ul></li><li class="topLevel parent " wuid="gx:a688388e2cf1712"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="../ubuntu-16-04.html" jotId="wuid:gx:a688388e2cf1712" class="sites-navigation-link topLevel">Ubuntu 16.04</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../ubuntu-16-04/canonical-ubuntu-16-04-livepatch-service.html" jotId="wuid:gx:36531436c1ed4a17" class="sites-navigation-link">Canonical Ubuntu 16.04 Livepatch Service</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../ubuntu-16-04/cisco-anyconnect-vpn-ubunty-16-04.html" jotId="wuid:gx:1f1f8e214e889787" class="sites-navigation-link">Cisco AnyConnect VPN Ubuntu 16.04</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="../ubuntu-16-04/systemd-to-manage-network-interfaces.html" jotId="wuid:gx:182e7ebf6d20564f" class="sites-navigation-link">Systemd to Manage Network Interfaces</a></div></li></ul></li><li class="topLevel "><div dir="ltr" style="padding-left: 19px;"><a href="../zero-downtime-asm-lun-add.html" jotId="wuid:gx:6d5fc0b6a3941475" class="sites-navigation-link topLevel">Zero-Downtime ASM LUN Add</a></div></li><li class="topLevel "><div dir="ltr" style="padding-left: 19px;"><a href="../system/app/pages/sitemap/hierarchy.html" jotId="wuid:gx:5b81d66bdd7a72b7" class="sites-navigation-link topLevel">Sitemap</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_35309087585577514" class="sites-sidebar-plusone-wrapper"><div class="g-plusone" data-count="true" data-size="standard" data-source="google:sites"></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="../kvm-and-openvswitch.html" dir="ltr">KVM and OpenvSwitch</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">KVM OVS UEL 14.04</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><div><br /></div><div lang="en"><div><div><div class="sites-embed-align-left-wrapping-off"><div class="sites-embed-border-off sites-embed" style="width:750px;"><div class="sites-embed-content sites-embed-type-toc"><div class="goog-toc sites-embed-toc-maxdepth-6"><p>Contents</p><ol class="goog-toc"><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Building-KVM-on-Flash-with-OpenvSwitch-SDN-on-Ubuntu-14.04.1-Desktop"><strong>1 </strong>Building KVM on Flash with OpenvSwitch SDN on Ubuntu 14.04.1 Desktop</a><ol class="goog-toc"><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Installing-OpenvSwitch-and-KVM-on-Ubuntu-14.04.1"><strong>1.1 </strong>Installing OpenvSwitch and KVM on Ubuntu 14.04.1</a></li><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Install-OpenSSH-Server-DHCP-and-UML-Utilities"><strong>1.2 </strong>Install OpenSSH Server, DHCP, and UML Utilities</a></li><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Build-OpenvSwitch"><strong>1.3 </strong>Build OpenvSwitch</a><ol class="goog-toc"><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Create-the-crt_ovs_sw1.sh-Script"><strong>1.3.1 </strong>Create the crt_ovs_sw1.sh Script</a></li><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Create-the-etc-init-my-network-up.conf-Script"><strong>1.3.2 </strong>Create the /etc/init/my-network-up.conf Script</a></li></ol></li><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Install-Windows-8-KVM-Guest"><strong>1.4 </strong>Install Windows 8 KVM Guest</a><ol class="goog-toc"><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Install-bind9-DNS-Server"><strong>1.4.1 </strong>Install bind9 DNS Server</a></li><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Configure-bind9-DNS-Server"><strong>1.4.2 </strong>Configure bind9 DNS Server</a></li></ol></li><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Configure-Physical-Windows8-Paritition-as-KVM-Guest"><strong>1.5 </strong>Configure Physical Windows8 Paritition as KVM Guest</a></li><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Layout-of-dev-sda"><strong>1.6 </strong>Layout of /dev/sda</a></li><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Create-Master-Boot-Record-File"><strong>1.7 </strong>Create Master Boot Record File</a></li><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Run-Modprobe-Linear-Command"><strong>1.8 </strong>Run Modprobe Linear Command</a></li><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Build-KVM-Guest-Ubuntu-Server-14.04.1"><strong>1.9 </strong>Build KVM Guest Ubuntu Server 14.04.1</a></li><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Modify-XML-of-KVM-Guest-for-OpenvSwitch"><strong>1.10 </strong>Modify XML of KVM Guest for OpenvSwitch</a></li><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Configure-KVM-Guest-for-Console-Access"><strong>1.11 </strong>Configure KVM Guest for Console Access</a></li><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Configure-DHCP-for-OpenvSwitch"><strong>1.12 </strong>Configure DHCP for OpenvSwitch</a></li><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Verify-KVM-Guest-Obtains-IP-Address-from-DHCP-on-OpenvSwitch"><strong>1.13 </strong>Verify KVM Guest Obtains IP Address from DHCP on OpenvSwitch</a></li><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Optionally-Configuring-Static-IP-Address-for-KVM-Guest"><strong>1.14 </strong>Optionally Configuring Static IP Address for KVM Guest</a></li><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Configure-DNS-for-KVM-Guest-and-Host-Environments"><strong>1.15 </strong>Configure DNS for KVM Guest and Host Environments</a></li><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Configure-Internet-Access-for-KVM-Guest"><strong>1.16 </strong>Configure Internet Access for KVM Guest</a></li><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Enable-the-As-Built-Configuration-to-Survive-Reboots"><strong>1.17 </strong>Enable the As-Built Configuration to Survive Reboots</a></li><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Configure-virtio-blk-data-plane-for-High-IOPS"><strong>1.18 </strong>Configure virtio-blk-data-plane for High IOPS</a></li><li class="goog-toc"><a href="kvm-openvswitch-1.html#TOC-Summary"><strong>1.19 </strong>Summary</a></li></ol></li></ol></div></div></div></div></div><br /></div>
<h2><a name="TOC-Building-KVM-on-Flash-with-OpenvSwitch-SDN-on-Ubuntu-14.04.1-Desktop"></a><font size="3"><span>Building KVM on Flash with OpenvSwitch SDN on Ubuntu 14.04.1 Desktop</span></font></h2>
<p><font size="3">This wiki details how to build KVM virtual guests on flash using OpenvSwitch for the networking, rather than the default libvirt networking. In addition, this wiki also shows how to use virtio-blk-data-plane in your KVM guest to obtain the performance benefit of world-record-setting benchmark IOPS in a KVM guest.  Last, but not least, this wiki shows how to use the "logical_block_size" and "physical_block_size" parameters in your KVM guest XML file to configure your KVM guest for use with high-speed flash storage by setting the relevant block sizes to 512 or 4096 as required.
</font></p><p><font size="3">In particular, most material found on the internet as of the time of writing this wiki describe attaching eth0 directly to the OpenvSwitch, which, while feasible for Ubuntu 14.04.1 server,  is not as feasible when using Ubuntu 14.04.1 Desktop, in a testing type environment, due to the fact that the Desktop version uses the Network-Manager applet and package which is known to not play well in certain operations with OpenvSwitch.
</font></p><p><font size="3">This wiki describes a method which creates an OpenvSwitch, assigns an IP range to the switch, and uses dhcp to deliver ip addresses to KVM guests attached to the switch, all without touching or affecting the function of network-manager.  Internet connectivity for the KVM guests is provided by iptables rules so that physical interfaces on the KVM host need not be directly attached to the OpenvSwitch. This wiki also details how to implement virtio-blk-data-plane for very high bandwidth and IOPS performance in the kvm guest as described by <a href="http://blog.vmsplice.net/2013/03/new-in-qemu-14-high-performance-virtio.html" rel="nofollow">Stefan Hajnoczi at his blog here</a>.
</font></p><p><font size="3">Additional information about virtio-blk-data-plane and it's advantages and some of the world record benchmarks it holds for highest IOPS in a single VM guest can be found <a href="http://rhsummit.files.wordpress.com/2013/06/sarathy_t_1040_kvm_hypervisor_roadmap_and_overview.pdf" rel="nofollow">here</a> and <a href="http://herehttp://events.linuxfoundation.org/sites/events/files/slides/CloudOpen2013_Khoa_Huynh_v3.pdf" rel="nofollow">here</a> and  <a href="http://nyoug.org/Presentations/2014/Standen_Flash_Arrays.pdf" rel="nofollow">here</a>.
</font></p><p><font size="3">The wiki hopes to persuade readers of numerous advantages to other virtualization solutions with respect to the fact that KVM is arguably the best choice when running virtual guests on flash storage because it can leverage the high-speed of flash better than other virtualization solutions.
</font></p><p><font size="3">While I hope that some production users of KVM will get some useful ideas from at least portions of this wiki, I want to say that this wiki is primarily intended to accomplish two things:
</font></p><ol><li><font size="3">To provide a simple and detailed cookbook for using your laptop or desktop machine as a KVM / OpenvSwitch lab; and</font></li><li><font size="3">To showcase the power and simplicity of KVM and OpenvSwitch and hopefully persuade for the adoption of both in enterprise.
</font></li></ol>
<h3><a name="TOC-Installing-OpenvSwitch-and-KVM-on-Ubuntu-14.04.1"></a><font size="3">Installing OpenvSwitch and KVM on Ubuntu 14.04.1</font></h3>
<p><font size="3">OpenvSwitch and KVM are installed from the apt-get repositories in this wiki as shown below.  OpenvSwitch and KVM can also be installed from source for those who want the most recent version.  These repository versions for Ubuntu 14.04.1 have all the features needed. Before installing KVM you need to verify that your system hardware will support KVM using the methods described <a href="https://help.ubuntu.com/community/KVM/Installation" rel="nofollow">here</a> Some of those methods are shown below.
</font></p>
<pre><div class="sites-codeblock sites-codesnippet-block"><font size="4"><span style="color:rgb(0,0,0)"><code>gstanden@vmem:~$ egrep -c '(vmx|svm)' /proc/cpuinfo</code></span></font><font size="3">
</font></div></pre><font size="3"><span style="font-family:arial,sans-serif">If value is "0" it means that your CP doesn't support hardware virtualization.  If 1 or more it does - but you still need to make sure that virtualization is enabled in the BIOS.For example on my Lenovo W520 Mobile Workstation the result is as shown below.
</span></font>
<pre><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem:~$ egrep -c '(vmx|svm)' /proc/cpuinfo

8</code></font><font size="3">
</font></div></pre>
<p><font size="3">Another test is as shown below.
</font></p>
<pre><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem2:~$ kvm-ok<br />The program 'kvm-ok' is currently not installed. You can install it by typing:<br />sudo apt-get install cpu-checker<br />gstanden@vmem2:~$ <br /><br /><br />gstanden@vmem2:~$ sudo apt-get install cpu-checker<br />Reading package lists... Done<br />Building dependency tree       <br />Reading state information... Done<br />The following extra packages will be installed:<br />  msr-tools<br />The following NEW packages will be installed:<br />  cpu-checker msr-tools<br />0 upgraded, 2 newly installed, 0 to remove and 116 not upgraded.<br />Need to get 17.5 kB of archives.<br />After this operation, 112 kB of additional disk space will be used.<br />Do you want to continue? [Y/n] Y<br />Get:1 http://us.archive.ubuntu.com/ubuntu/ trusty/main msr-tools amd64 1.3-2 [10.6 kB]<br />Get:2 http://us.archive.ubuntu.com/ubuntu/ trusty/main cpu-checker amd64 0.7-0ubuntu4 [6,834 B]<br />Fetched 17.5 kB in 0s (60.4 kB/s)      <br />Selecting previously unselected package msr-tools.<br />(Reading database ... 194786 files and directories currently installed.)<br />Preparing to unpack .../msr-tools_1.3-2_amd64.deb ...<br />Unpacking msr-tools (1.3-2) ...<br />Selecting previously unselected package cpu-checker.<br />Preparing to unpack .../cpu-checker_0.7-0ubuntu4_amd64.deb ...<br />Unpacking cpu-checker (0.7-0ubuntu4) ...<br />Processing triggers for man-db (2.6.7.1-1) ...<br />Setting up msr-tools (1.3-2) ...<br />Setting up cpu-checker (0.7-0ubuntu4) ...<br /><br />gstanden@vmem2:~$ <br /><br />gstanden@vmem2:~$ sudo kvm-ok<br /><br />INFO: /dev/kvm does not exist<br />HINT:   sudo modprobe kvm_intel<br />INFO: Your CPU supports KVM extensions<br />INFO: KVM (vmx) is disabled by your BIOS<br />HINT: Enter your BIOS setup and enable Virtualization Technology (VT),<br />      and then hard poweroff/poweron your system<br />KVM acceleration can NOT be used<br />gstanden@vmem2:~$ <br /><br /></code><code>
INFO: /dev/kvm exists
KVM acceleration can be used</code></font></div></pre>
<p><font size="3">Reboot, and go into BIOS and enable virtualization extensions.</font></p><div class="sites-codeblock sites-codesnippet-block"><font size="3"><font size="4"><code>gstanden@vmem2:~$ sudo kvm-ok</code><br /><code>[sudo] password for gstanden: </code><br /><code>INFO: /dev/kvm exists</code><br /><code>KVM acceleration can be used</code><br /><code>gstanden@vmem2:~$ </code></font></font></div><p><font size="3">Next install OpenvSwitch and KVM from repositories as shown below.
</font></p>
<pre><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code><br />gstanden@vmem2:~$ sudo apt-get install openvswitch-switch qemu-kvm libvirt-bin virt-manager | tee log1<br /><br />Reading package lists... Done<br />Building dependency tree       <br />Reading state information... Done<br />The following extra packages will be installed:<br />  augeas-lenses bridge-utils cgroup-lite ebtables gawk ipxe-qemu libaio1<br />  libappindicator1 libaugeas0 libbonobo2-0 libbonobo2-common libbonoboui2-0<br />  libbonoboui2-common libboost-thread1.54.0 libfdt1 libglade2-0 libgnome2-0<br />  libgnome2-bin libgnome2-common libgnomecanvas2-0 libgnomecanvas2-common<br />  libgnomeui-0 libgnomeui-common libgnomevfs2-0 libgnomevfs2-common<br />  libgtk-vnc-1.0-0 libgvnc-1.0-0 libidl-common libidl0 libindicator7 libnetcf1<br />  liborbit-2-0 liborbit2 librados2 librbd1 libsdl1.2debian libseccomp2<br />  libsigsegv2 libusbredirparser1 libvirt0 libvte-common libvte9 libxen-4.4<br />  libxenstore3.0 libxml2-utils openvswitch-common python-appindicator<br />  python-glade2 python-gnome2 python-gtk-vnc python-libvirt python-pyorbit<br />  python-urlgrabber python-vte qemu-keymaps qemu-system-common qemu-system-x86<br />  qemu-utils seabios sharutils virtinst<br />Suggested packages:<br />  augeas-doc gawk-doc augeas-tools libbonobo2-bin desktop-base<br />  libgnomevfs2-bin libgnomevfs2-extra gamin fam gnome-mime-data radvd lvm2<br />  openvswitch-datapath-module python-gtk2-doc python-gnome2-doc<br />  python-pyorbit-dbg samba vde2 sgabios debootstrap bsd-mailx mailx<br />  virt-viewer python-guestfs python-spice-client-gtk<br />The following NEW packages will be installed:<br />  augeas-lenses bridge-utils cgroup-lite ebtables gawk ipxe-qemu libaio1<br />  libappindicator1 libaugeas0 libbonobo2-0 libbonobo2-common libbonoboui2-0<br />  libbonoboui2-common libboost-thread1.54.0 libfdt1 libglade2-0 libgnome2-0<br />  libgnome2-bin libgnome2-common libgnomecanvas2-0 libgnomecanvas2-common<br />  libgnomeui-0 libgnomeui-common libgnomevfs2-0 libgnomevfs2-common<br />  libgtk-vnc-1.0-0 libgvnc-1.0-0 libidl-common libidl0 libindicator7 libnetcf1<br />  liborbit-2-0 liborbit2 librados2 librbd1 libsdl1.2debian libseccomp2<br />  libsigsegv2 libusbredirparser1 libvirt-bin libvirt0 libvte-common libvte9<br />  libxen-4.4 libxenstore3.0 libxml2-utils openvswitch-common<br />  openvswitch-switch python-appindicator python-glade2 python-gnome2<br />  python-gtk-vnc python-libvirt python-pyorbit python-urlgrabber python-vte<br />  qemu-keymaps qemu-kvm qemu-system-common qemu-system-x86 qemu-utils seabios<br />  sharutils virt-manager virtinst<br />0 upgraded, 65 newly installed, 0 to remove and 116 not upgraded.<br />Need to get 13.8 MB of archives.<br />After this operation, 72.7 MB of additional disk space will be used.<br />Do you want to continue? [Y/n] Y<br />Get:1 http://us.archive.ubuntu.com/ubuntu/ trusty/main libsigsegv2 amd64 2.10-2 [15.0 kB]<br />Get:2 http://us.archive.ubuntu.com/ubuntu/ trusty/main gawk amd64 1:4.0.1+dfsg-2.1ubuntu2 [781 kB]<br />Get:3 http://us.archive.ubuntu.com/ubuntu/ trusty/main libaio1 amd64 0.3.109-4 [6,364 B]<br />Get:4 http://us.archive.ubuntu.com/ubuntu/ trusty/main libindicator7 amd64 12.10.2+14.04.20140402-0ubuntu1 [21.9 kB]<br />Get:5 http://us.archive.ubuntu.com/ubuntu/ trusty/main libappindicator1 amd64 12.10.1+13.10.20130920-0ubuntu4 [18.2 kB]<br />Get:6 http://us.archive.ubuntu.com/ubuntu/ trusty/main libbonobo2-common all 2.32.1-0ubuntu5 [34.2 kB]<br />Get:7 http://us.archive.ubuntu.com/ubuntu/ trusty/main libidl-common all 0.8.14-0.2ubuntu4 [8,196 B]<br />Get:8 http://us.archive.ubuntu.com/ubuntu/ trusty/main libidl0 amd64 0.8.14-0.2ubuntu4 [65.9 kB]<br />Get:9 http://us.archive.ubuntu.com/ubuntu/ trusty/main liborbit-2-0 amd64 1:2.14.19-0.3 [138 kB]<br />Get:10 http://us.archive.ubuntu.com/ubuntu/ trusty/main liborbit2 amd64 1:2.14.19-0.3 [14.7 kB]<br />Get:11 http://us.archive.ubuntu.com/ubuntu/ trusty/main libbonobo2-0 amd64 2.32.1-0ubuntu5 [214 kB]<br />Get:12 http://us.archive.ubuntu.com/ubuntu/ trusty/main libglade2-0 amd64 1:2.6.4-2 [44.6 kB]<br />Get:13 http://us.archive.ubuntu.com/ubuntu/ trusty/main libgnomevfs2-common amd64 1:2.24.4-1ubuntu6 [22.8 kB]<br />Get:14 http://us.archive.ubuntu.com/ubuntu/ trusty/main libgnomevfs2-0 amd64 1:2.24.4-1ubuntu6 [210 kB]<br />Get:15 http://us.archive.ubuntu.com/ubuntu/ trusty/main libgnome2-common all 2.32.1-4ubuntu1 [33.3 kB]<br />Get:16 http://us.archive.ubuntu.com/ubuntu/ trusty/main libgnome2-bin amd64 2.32.1-4ubuntu1 [15.0 kB]<br />Get:17 http://us.archive.ubuntu.com/ubuntu/ trusty/main libgnome2-0 amd64 2.32.1-4ubuntu1 [43.2 kB]<br />Get:18 http://us.archive.ubuntu.com/ubuntu/ trusty/main libgnomecanvas2-common all 2.30.3-2 [9,080 B]<br />Get:19 http://us.archive.ubuntu.com/ubuntu/ trusty/main libgnomecanvas2-0 amd64 2.30.3-2 [82.7 kB]<br />Get:20 http://us.archive.ubuntu.com/ubuntu/ trusty/main libbonoboui2-common all 2.24.5-0ubuntu3 [11.4 kB]<br />Get:21 http://us.archive.ubuntu.com/ubuntu/ trusty/main libbonoboui2-0 amd64 2.24.5-0ubuntu3 [151 kB]<br />Get:22 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main libboost-thread1.54.0 amd64 1.54.0-4ubuntu3.1 [26.5 kB]<br />Get:23 http://us.archive.ubuntu.com/ubuntu/ trusty/main libgnomeui-common all 2.24.5-3 [16.5 kB]<br />Get:24 http://us.archive.ubuntu.com/ubuntu/ trusty/main libgnomeui-0 amd64 2.24.5-3 [203 kB]<br />Get:25 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main librados2 amd64 0.80.5-0ubuntu0.14.04.1 [1,407 kB]<br />Get:26 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main librbd1 amd64 0.80.5-0ubuntu0.14.04.1 [316 kB]<br />Get:27 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main libsdl1.2debian amd64 1.2.15-8ubuntu1.1 [162 kB]<br />Get:28 http://us.archive.ubuntu.com/ubuntu/ trusty/main libseccomp2 amd64 2.1.0+dfsg-1 [34.8 kB]<br />Get:29 http://us.archive.ubuntu.com/ubuntu/ trusty/main libusbredirparser1 amd64 0.6-2ubuntu1 [13.2 kB]<br />Get:30 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main qemu-system-common amd64 2.0.0+dfsg-2ubuntu1.3 [158 kB]<br />Get:31 http://us.archive.ubuntu.com/ubuntu/ trusty/main libfdt1 amd64 1.4.0+dfsg-1 [15.7 kB]<br />Get:32 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main augeas-lenses all 1.2.0-0ubuntu1.1 [230 kB]<br />Get:33 http://us.archive.ubuntu.com/ubuntu/ trusty/main bridge-utils amd64 1.5-6ubuntu2 [29.2 kB]<br />Get:34 http://us.archive.ubuntu.com/ubuntu/ trusty/main ebtables amd64 2.0.10.4-3ubuntu1 [77.5 kB]<br />Get:35 http://us.archive.ubuntu.com/ubuntu/ trusty/main ipxe-qemu all 1.0.0+git-20131111.c3d1e78-2ubuntu1 [506 kB]<br />Get:36 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main libaugeas0 amd64 1.2.0-0ubuntu1.1 [135 kB]<br />Get:37 http://us.archive.ubuntu.com/ubuntu/ trusty/main libgvnc-1.0-0 amd64 0.5.3-0ubuntu2 [53.2 kB]<br />Get:38 http://us.archive.ubuntu.com/ubuntu/ trusty/main libgtk-vnc-1.0-0 amd64 0.5.3-0ubuntu2 [22.8 kB]<br />Get:39 http://us.archive.ubuntu.com/ubuntu/ trusty/main libnetcf1 amd64 1:0.2.3-4ubuntu1 [44.4 kB]<br />Get:40 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main libvirt0 amd64 1.2.2-0ubuntu13.1.2 [830 kB]<br />Get:41 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main libxenstore3.0 amd64 4.4.0-0ubuntu5.1 [18.5 kB]<br />Get:42 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main libxen-4.4 amd64 4.4.0-0ubuntu5.1 [272 kB]<br />Get:43 http://us.archive.ubuntu.com/ubuntu/ trusty/main cgroup-lite all 1.9 [3,918 B]<br />Get:44 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main libvirt-bin amd64 1.2.2-0ubuntu13.1.2 [2,064 kB]<br />Get:45 http://us.archive.ubuntu.com/ubuntu/ trusty/main libvte-common all 1:0.28.2-5ubuntu1 [22.8 kB]<br />Get:46 http://us.archive.ubuntu.com/ubuntu/ trusty/main libvte9 amd64 1:0.28.2-5ubuntu1 [374 kB]<br />Get:47 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main libxml2-utils amd64 2.9.1+dfsg1-3ubuntu4.3 [34.7 kB]<br />Get:48 http://us.archive.ubuntu.com/ubuntu/ trusty/main python-appindicator amd64 12.10.1+13.10.20130920-0ubuntu4 [7,706 B]<br />Get:49 http://us.archive.ubuntu.com/ubuntu/ trusty/main python-glade2 amd64 2.24.0-3ubuntu3 [8,744 B]<br />Get:50 http://us.archive.ubuntu.com/ubuntu/ trusty/main python-pyorbit amd64 2.24.0-6ubuntu4 [57.2 kB]<br />Get:51 http://us.archive.ubuntu.com/ubuntu/ trusty/main python-gnome2 amd64 2.28.1+dfsg-1ubuntu2 [136 kB]<br />Get:52 http://us.archive.ubuntu.com/ubuntu/ trusty/main python-gtk-vnc amd64 0.5.3-0ubuntu2 [8,686 B]<br />Get:53 http://us.archive.ubuntu.com/ubuntu/ trusty/main python-libvirt amd64 1.2.2-0ubuntu1 [97.6 kB]<br />Get:54 http://us.archive.ubuntu.com/ubuntu/ trusty/main python-urlgrabber all 3.9.1-4ubuntu3 [42.3 kB]<br />Get:55 http://us.archive.ubuntu.com/ubuntu/ trusty/main python-vte amd64 1:0.28.2-5ubuntu1 [21.7 kB]<br />Get:56 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main qemu-keymaps all 2.0.0+dfsg-2ubuntu1.3 [20.9 kB]<br />Get:57 http://us.archive.ubuntu.com/ubuntu/ trusty/main seabios all 1.7.4-4 [108 kB]<br />Get:58 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main qemu-system-x86 amd64 2.0.0+dfsg-2ubuntu1.3 [1,940 kB]<br />Get:59 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main qemu-kvm amd64 2.0.0+dfsg-2ubuntu1.3 [7,120 B]<br />Get:60 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main qemu-utils amd64 2.0.0+dfsg-2ubuntu1.3 [414 kB]<br />Get:61 http://us.archive.ubuntu.com/ubuntu/ trusty/main sharutils amd64 1:4.14-1ubuntu1 [145 kB]<br />Get:62 http://us.archive.ubuntu.com/ubuntu/ trusty/main virtinst all 0.600.4-3ubuntu2 [179 kB]<br />Get:63 http://us.archive.ubuntu.com/ubuntu/ trusty/main virt-manager all 0.9.5-1ubuntu3 [280 kB]<br />Get:64 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main openvswitch-common amd64 2.0.2-0ubuntu0.14.04.1 [444 kB]<br />Get:65 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main openvswitch-switch amd64 2.0.2-0ubuntu0.14.04.1 [863 kB]<br />Fetched 13.8 MB in 11s (1,206 kB/s)                                            <br />Extracting templates from packages: 100%<br />Selecting previously unselected package libsigsegv2:amd64.<br />(Reading database ... 194800 files and directories currently installed.)<br />Preparing to unpack .../libsigsegv2_2.10-2_amd64.deb ...<br />Unpacking libsigsegv2:amd64 (2.10-2) ...<br />Setting up libsigsegv2:amd64 (2.10-2) ...<br />Processing triggers for libc-bin (2.19-0ubuntu6) ...<br />Selecting previously unselected package gawk.<br />(Reading database ... 194808 files and directories currently installed.)<br />Preparing to unpack .../gawk_1%3a4.0.1+dfsg-2.1ubuntu2_amd64.deb ...<br />Unpacking gawk (1:4.0.1+dfsg-2.1ubuntu2) ...<br />Selecting previously unselected package libaio1:amd64.<br />Preparing to unpack .../libaio1_0.3.109-4_amd64.deb ...<br />Unpacking libaio1:amd64 (0.3.109-4) ...<br />Selecting previously unselected package libindicator7.<br />Preparing to unpack .../libindicator7_12.10.2+14.04.20140402-0ubuntu1_amd64.deb ...<br />Unpacking libindicator7 (12.10.2+14.04.20140402-0ubuntu1) ...<br />Selecting previously unselected package libappindicator1.<br />Preparing to unpack .../libappindicator1_12.10.1+13.10.20130920-0ubuntu4_amd64.deb ...<br />Unpacking libappindicator1 (12.10.1+13.10.20130920-0ubuntu4) ...<br />Selecting previously unselected package libbonobo2-common.<br />Preparing to unpack .../libbonobo2-common_2.32.1-0ubuntu5_all.deb ...<br />Unpacking libbonobo2-common (2.32.1-0ubuntu5) ...<br />Selecting previously unselected package libidl-common.<br />Preparing to unpack .../libidl-common_0.8.14-0.2ubuntu4_all.deb ...<br />Unpacking libidl-common (0.8.14-0.2ubuntu4) ...<br />Selecting previously unselected package libidl0:amd64.<br />Preparing to unpack .../libidl0_0.8.14-0.2ubuntu4_amd64.deb ...<br />Unpacking libidl0:amd64 (0.8.14-0.2ubuntu4) ...<br />Selecting previously unselected package liborbit-2-0:amd64.<br />Preparing to unpack .../liborbit-2-0_1%3a2.14.19-0.3_amd64.deb ...<br />Unpacking liborbit-2-0:amd64 (1:2.14.19-0.3) ...<br />Selecting previously unselected package liborbit2:amd64.<br />Preparing to unpack .../liborbit2_1%3a2.14.19-0.3_amd64.deb ...<br />Unpacking liborbit2:amd64 (1:2.14.19-0.3) ...<br />Selecting previously unselected package libbonobo2-0:amd64.<br />Preparing to unpack .../libbonobo2-0_2.32.1-0ubuntu5_amd64.deb ...<br />Unpacking libbonobo2-0:amd64 (2.32.1-0ubuntu5) ...<br />Selecting previously unselected package libglade2-0:amd64.<br />Preparing to unpack .../libglade2-0_1%3a2.6.4-2_amd64.deb ...<br />Unpacking libglade2-0:amd64 (1:2.6.4-2) ...<br />Selecting previously unselected package libgnomevfs2-common.<br />Preparing to unpack .../libgnomevfs2-common_1%3a2.24.4-1ubuntu6_amd64.deb ...<br />Unpacking libgnomevfs2-common (1:2.24.4-1ubuntu6) ...<br />Selecting previously unselected package libgnomevfs2-0:amd64.<br />Preparing to unpack .../libgnomevfs2-0_1%3a2.24.4-1ubuntu6_amd64.deb ...<br />Unpacking libgnomevfs2-0:amd64 (1:2.24.4-1ubuntu6) ...<br />Selecting previously unselected package libgnome2-common.<br />Preparing to unpack .../libgnome2-common_2.32.1-4ubuntu1_all.deb ...<br />Unpacking libgnome2-common (2.32.1-4ubuntu1) ...<br />Selecting previously unselected package libgnome2-bin.<br />Preparing to unpack .../libgnome2-bin_2.32.1-4ubuntu1_amd64.deb ...<br />Unpacking libgnome2-bin (2.32.1-4ubuntu1) ...<br />Selecting previously unselected package libgnome2-0:amd64.<br />Preparing to unpack .../libgnome2-0_2.32.1-4ubuntu1_amd64.deb ...<br />Unpacking libgnome2-0:amd64 (2.32.1-4ubuntu1) ...<br />Selecting previously unselected package libgnomecanvas2-common.<br />Preparing to unpack .../libgnomecanvas2-common_2.30.3-2_all.deb ...<br />Unpacking libgnomecanvas2-common (2.30.3-2) ...<br />Selecting previously unselected package libgnomecanvas2-0:amd64.<br />Preparing to unpack .../libgnomecanvas2-0_2.30.3-2_amd64.deb ...<br />Unpacking libgnomecanvas2-0:amd64 (2.30.3-2) ...<br />Selecting previously unselected package libbonoboui2-common.<br />Preparing to unpack .../libbonoboui2-common_2.24.5-0ubuntu3_all.deb ...<br />Unpacking libbonoboui2-common (2.24.5-0ubuntu3) ...<br />Selecting previously unselected package libbonoboui2-0:amd64.<br />Preparing to unpack .../libbonoboui2-0_2.24.5-0ubuntu3_amd64.deb ...<br />Unpacking libbonoboui2-0:amd64 (2.24.5-0ubuntu3) ...<br />Selecting previously unselected package libboost-thread1.54.0:amd64.<br />Preparing to unpack .../libboost-thread1.54.0_1.54.0-4ubuntu3.1_amd64.deb ...<br />Unpacking libboost-thread1.54.0:amd64 (1.54.0-4ubuntu3.1) ...<br />Selecting previously unselected package libgnomeui-common.<br />Preparing to unpack .../libgnomeui-common_2.24.5-3_all.deb ...<br />Unpacking libgnomeui-common (2.24.5-3) ...<br />Selecting previously unselected package libgnomeui-0:amd64.<br />Preparing to unpack .../libgnomeui-0_2.24.5-3_amd64.deb ...<br />Unpacking libgnomeui-0:amd64 (2.24.5-3) ...<br />Selecting previously unselected package librados2.<br />Preparing to unpack .../librados2_0.80.5-0ubuntu0.14.04.1_amd64.deb ...<br />Unpacking librados2 (0.80.5-0ubuntu0.14.04.1) ...<br />Selecting previously unselected package librbd1.<br />Preparing to unpack .../librbd1_0.80.5-0ubuntu0.14.04.1_amd64.deb ...<br />Unpacking librbd1 (0.80.5-0ubuntu0.14.04.1) ...<br />Selecting previously unselected package libsdl1.2debian:amd64.<br />Preparing to unpack .../libsdl1.2debian_1.2.15-8ubuntu1.1_amd64.deb ...<br />Unpacking libsdl1.2debian:amd64 (1.2.15-8ubuntu1.1) ...<br />Selecting previously unselected package libseccomp2:amd64.<br />Preparing to unpack .../libseccomp2_2.1.0+dfsg-1_amd64.deb ...<br />Unpacking libseccomp2:amd64 (2.1.0+dfsg-1) ...<br />Selecting previously unselected package libusbredirparser1:amd64.<br />Preparing to unpack .../libusbredirparser1_0.6-2ubuntu1_amd64.deb ...<br />Unpacking libusbredirparser1:amd64 (0.6-2ubuntu1) ...<br />Selecting previously unselected package qemu-system-common.<br />Preparing to unpack .../qemu-system-common_2.0.0+dfsg-2ubuntu1.3_amd64.deb ...<br />Unpacking qemu-system-common (2.0.0+dfsg-2ubuntu1.3) ...<br />Selecting previously unselected package libfdt1:amd64.<br />Preparing to unpack .../libfdt1_1.4.0+dfsg-1_amd64.deb ...<br />Unpacking libfdt1:amd64 (1.4.0+dfsg-1) ...<br />Selecting previously unselected package augeas-lenses.<br />Preparing to unpack .../augeas-lenses_1.2.0-0ubuntu1.1_all.deb ...<br />Unpacking augeas-lenses (1.2.0-0ubuntu1.1) ...<br />Selecting previously unselected package bridge-utils.<br />Preparing to unpack .../bridge-utils_1.5-6ubuntu2_amd64.deb ...<br />Unpacking bridge-utils (1.5-6ubuntu2) ...<br />Selecting previously unselected package ebtables.<br />Preparing to unpack .../ebtables_2.0.10.4-3ubuntu1_amd64.deb ...<br />Unpacking ebtables (2.0.10.4-3ubuntu1) ...<br />Selecting previously unselected package ipxe-qemu.<br />Preparing to unpack .../ipxe-qemu_1.0.0+git-20131111.c3d1e78-2ubuntu1_all.deb ...<br />Unpacking ipxe-qemu (1.0.0+git-20131111.c3d1e78-2ubuntu1) ...<br />Selecting previously unselected package libaugeas0.<br />Preparing to unpack .../libaugeas0_1.2.0-0ubuntu1.1_amd64.deb ...<br />Unpacking libaugeas0 (1.2.0-0ubuntu1.1) ...<br />Selecting previously unselected package libgvnc-1.0-0.<br />Preparing to unpack .../libgvnc-1.0-0_0.5.3-0ubuntu2_amd64.deb ...<br />Unpacking libgvnc-1.0-0 (0.5.3-0ubuntu2) ...<br />Selecting previously unselected package libgtk-vnc-1.0-0.<br />Preparing to unpack .../libgtk-vnc-1.0-0_0.5.3-0ubuntu2_amd64.deb ...<br />Unpacking libgtk-vnc-1.0-0 (0.5.3-0ubuntu2) ...<br />Selecting previously unselected package libnetcf1.<br />Preparing to unpack .../libnetcf1_1%3a0.2.3-4ubuntu1_amd64.deb ...<br />Unpacking libnetcf1 (1:0.2.3-4ubuntu1) ...<br />Selecting previously unselected package libvirt0.<br />Preparing to unpack .../libvirt0_1.2.2-0ubuntu13.1.2_amd64.deb ...<br />Unpacking libvirt0 (1.2.2-0ubuntu13.1.2) ...<br />Selecting previously unselected package libxenstore3.0.<br />Preparing to unpack .../libxenstore3.0_4.4.0-0ubuntu5.1_amd64.deb ...<br />Unpacking libxenstore3.0 (4.4.0-0ubuntu5.1) ...<br />Selecting previously unselected package libxen-4.4.<br />Preparing to unpack .../libxen-4.4_4.4.0-0ubuntu5.1_amd64.deb ...<br />Unpacking libxen-4.4 (4.4.0-0ubuntu5.1) ...<br />Selecting previously unselected package cgroup-lite.<br />Preparing to unpack .../cgroup-lite_1.9_all.deb ...<br />Unpacking cgroup-lite (1.9) ...<br />Selecting previously unselected package libvirt-bin.<br />Preparing to unpack .../libvirt-bin_1.2.2-0ubuntu13.1.2_amd64.deb ...<br />Unpacking libvirt-bin (1.2.2-0ubuntu13.1.2) ...<br />Selecting previously unselected package libvte-common.<br />Preparing to unpack .../libvte-common_1%3a0.28.2-5ubuntu1_all.deb ...<br />Unpacking libvte-common (1:0.28.2-5ubuntu1) ...<br />Selecting previously unselected package libvte9.<br />Preparing to unpack .../libvte9_1%3a0.28.2-5ubuntu1_amd64.deb ...<br />Unpacking libvte9 (1:0.28.2-5ubuntu1) ...<br />Selecting previously unselected package libxml2-utils.<br />Preparing to unpack .../libxml2-utils_2.9.1+dfsg1-3ubuntu4.3_amd64.deb ...<br />Unpacking libxml2-utils (2.9.1+dfsg1-3ubuntu4.3) ...<br />Selecting previously unselected package python-appindicator.<br />Preparing to unpack .../python-appindicator_12.10.1+13.10.20130920-0ubuntu4_amd64.deb ...<br />Unpacking python-appindicator (12.10.1+13.10.20130920-0ubuntu4) ...<br />Selecting previously unselected package python-glade2.<br />Preparing to unpack .../python-glade2_2.24.0-3ubuntu3_amd64.deb ...<br />Unpacking python-glade2 (2.24.0-3ubuntu3) ...<br />Selecting previously unselected package python-pyorbit.<br />Preparing to unpack .../python-pyorbit_2.24.0-6ubuntu4_amd64.deb ...<br />Unpacking python-pyorbit (2.24.0-6ubuntu4) ...<br />Selecting previously unselected package python-gnome2.<br />Preparing to unpack .../python-gnome2_2.28.1+dfsg-1ubuntu2_amd64.deb ...<br />Unpacking python-gnome2 (2.28.1+dfsg-1ubuntu2) ...<br />Selecting previously unselected package python-gtk-vnc.<br />Preparing to unpack .../python-gtk-vnc_0.5.3-0ubuntu2_amd64.deb ...<br />Unpacking python-gtk-vnc (0.5.3-0ubuntu2) ...<br />Selecting previously unselected package python-libvirt.<br />Preparing to unpack .../python-libvirt_1.2.2-0ubuntu1_amd64.deb ...<br />Unpacking python-libvirt (1.2.2-0ubuntu1) ...<br />Selecting previously unselected package python-urlgrabber.<br />Preparing to unpack .../python-urlgrabber_3.9.1-4ubuntu3_all.deb ...<br />Unpacking python-urlgrabber (3.9.1-4ubuntu3) ...<br />Selecting previously unselected package python-vte.<br />Preparing to unpack .../python-vte_1%3a0.28.2-5ubuntu1_amd64.deb ...<br />Unpacking python-vte (1:0.28.2-5ubuntu1) ...<br />Selecting previously unselected package qemu-keymaps.<br />Preparing to unpack .../qemu-keymaps_2.0.0+dfsg-2ubuntu1.3_all.deb ...<br />Unpacking qemu-keymaps (2.0.0+dfsg-2ubuntu1.3) ...<br />Selecting previously unselected package seabios.<br />Preparing to unpack .../seabios_1.7.4-4_all.deb ...<br />Unpacking seabios (1.7.4-4) ...<br />Selecting previously unselected package qemu-system-x86.<br />Preparing to unpack .../qemu-system-x86_2.0.0+dfsg-2ubuntu1.3_amd64.deb ...<br />Unpacking qemu-system-x86 (2.0.0+dfsg-2ubuntu1.3) ...<br />Selecting previously unselected package qemu-kvm.<br />Preparing to unpack .../qemu-kvm_2.0.0+dfsg-2ubuntu1.3_amd64.deb ...<br />Unpacking qemu-kvm (2.0.0+dfsg-2ubuntu1.3) ...<br />Selecting previously unselected package qemu-utils.<br />Preparing to unpack .../qemu-utils_2.0.0+dfsg-2ubuntu1.3_amd64.deb ...<br />Unpacking qemu-utils (2.0.0+dfsg-2ubuntu1.3) ...<br />Selecting previously unselected package sharutils.<br />Preparing to unpack .../sharutils_1%3a4.14-1ubuntu1_amd64.deb ...<br />Unpacking sharutils (1:4.14-1ubuntu1) ...<br />Selecting previously unselected package virtinst.<br />Preparing to unpack .../virtinst_0.600.4-3ubuntu2_all.deb ...<br />Unpacking virtinst (0.600.4-3ubuntu2) ...<br />Selecting previously unselected package virt-manager.<br />Preparing to unpack .../virt-manager_0.9.5-1ubuntu3_all.deb ...<br />Unpacking virt-manager (0.9.5-1ubuntu3) ...<br />Selecting previously unselected package openvswitch-common.<br />Preparing to unpack .../openvswitch-common_2.0.2-0ubuntu0.14.04.1_amd64.deb ...<br />Unpacking openvswitch-common (2.0.2-0ubuntu0.14.04.1) ...<br />Selecting previously unselected package openvswitch-switch.<br />Preparing to unpack .../openvswitch-switch_2.0.2-0ubuntu0.14.04.1_amd64.deb ...<br />Unpacking openvswitch-switch (2.0.2-0ubuntu0.14.04.1) ...<br />Processing triggers for man-db (2.6.7.1-1) ...<br />Processing triggers for gconf2 (3.2.6-0ubuntu2) ...<br />Processing triggers for ureadahead (0.100.0-16) ...<br />ureadahead will be reprofiled on next reboot<br />Processing triggers for install-info (5.2.0.dfsg.1-2) ...<br />Processing triggers for hicolor-icon-theme (0.13-1) ...<br />Processing triggers for gnome-menus (3.10.1-0ubuntu2) ...<br />Processing triggers for desktop-file-utils (0.22-1ubuntu1) ...<br />Processing triggers for bamfdaemon (0.5.1+14.04.20140409-0ubuntu1) ...<br />Rebuilding /usr/share/applications/bamf-2.index...<br />Processing triggers for mime-support (3.54ubuntu1) ...<br />Setting up gawk (1:4.0.1+dfsg-2.1ubuntu2) ...<br />Setting up libaio1:amd64 (0.3.109-4) ...<br />Setting up libindicator7 (12.10.2+14.04.20140402-0ubuntu1) ...<br />Setting up libappindicator1 (12.10.1+13.10.20130920-0ubuntu4) ...<br />Setting up libbonobo2-common (2.32.1-0ubuntu5) ...<br />Setting up libidl-common (0.8.14-0.2ubuntu4) ...<br />Setting up libidl0:amd64 (0.8.14-0.2ubuntu4) ...<br />Setting up liborbit-2-0:amd64 (1:2.14.19-0.3) ...<br />Setting up liborbit2:amd64 (1:2.14.19-0.3) ...<br />Setting up libbonobo2-0:amd64 (2.32.1-0ubuntu5) ...<br />Setting up libglade2-0:amd64 (1:2.6.4-2) ...<br />Setting up libgnomevfs2-common (1:2.24.4-1ubuntu6) ...<br />Setting up libgnomevfs2-0:amd64 (1:2.24.4-1ubuntu6) ...<br />Setting up libgnome2-common (2.32.1-4ubuntu1) ...<br />Setting up libgnomecanvas2-common (2.30.3-2) ...<br />Setting up libgnomecanvas2-0:amd64 (2.30.3-2) ...<br />Setting up libbonoboui2-common (2.24.5-0ubuntu3) ...<br />Setting up libboost-thread1.54.0:amd64 (1.54.0-4ubuntu3.1) ...<br />Setting up libgnomeui-common (2.24.5-3) ...<br />Setting up librados2 (0.80.5-0ubuntu0.14.04.1) ...<br />Setting up librbd1 (0.80.5-0ubuntu0.14.04.1) ...<br />Setting up libsdl1.2debian:amd64 (1.2.15-8ubuntu1.1) ...<br />Setting up libseccomp2:amd64 (2.1.0+dfsg-1) ...<br />Setting up libusbredirparser1:amd64 (0.6-2ubuntu1) ...<br />Setting up qemu-system-common (2.0.0+dfsg-2ubuntu1.3) ...<br />Setting up libfdt1:amd64 (1.4.0+dfsg-1) ...<br />Setting up augeas-lenses (1.2.0-0ubuntu1.1) ...<br />Setting up bridge-utils (1.5-6ubuntu2) ...<br />Setting up ebtables (2.0.10.4-3ubuntu1) ...<br />Setting up ipxe-qemu (1.0.0+git-20131111.c3d1e78-2ubuntu1) ...<br />Setting up libaugeas0 (1.2.0-0ubuntu1.1) ...<br />Setting up libgvnc-1.0-0 (0.5.3-0ubuntu2) ...<br />Setting up libgtk-vnc-1.0-0 (0.5.3-0ubuntu2) ...<br />Setting up libnetcf1 (1:0.2.3-4ubuntu1) ...<br />Setting up libvirt0 (1.2.2-0ubuntu13.1.2) ...<br />Setting up libxenstore3.0 (4.4.0-0ubuntu5.1) ...<br />Setting up libxen-4.4 (4.4.0-0ubuntu5.1) ...<br />Setting up cgroup-lite (1.9) ...<br />cgroup-lite start/running<br />Setting up libvte-common (1:0.28.2-5ubuntu1) ...<br />Setting up libvte9 (1:0.28.2-5ubuntu1) ...<br />Setting up libxml2-utils (2.9.1+dfsg1-3ubuntu4.3) ...<br />Setting up python-appindicator (12.10.1+13.10.20130920-0ubuntu4) ...<br />Setting up python-glade2 (2.24.0-3ubuntu3) ...<br />Setting up python-pyorbit (2.24.0-6ubuntu4) ...<br />Setting up python-gtk-vnc (0.5.3-0ubuntu2) ...<br />Setting up python-libvirt (1.2.2-0ubuntu1) ...<br />Setting up python-urlgrabber (3.9.1-4ubuntu3) ...<br />Setting up python-vte (1:0.28.2-5ubuntu1) ...<br />Setting up qemu-keymaps (2.0.0+dfsg-2ubuntu1.3) ...<br />Setting up seabios (1.7.4-4) ...<br />Setting up qemu-system-x86 (2.0.0+dfsg-2ubuntu1.3) ...<br />qemu-kvm start/running<br />Setting up qemu-utils (2.0.0+dfsg-2ubuntu1.3) ...<br />Setting up sharutils (1:4.14-1ubuntu1) ...<br />Setting up virtinst (0.600.4-3ubuntu2) ...<br />Setting up openvswitch-common (2.0.2-0ubuntu0.14.04.1) ...<br />Setting up openvswitch-switch (2.0.2-0ubuntu0.14.04.1) ...<br />openvswitch-switch start/running<br />Processing triggers for ureadahead (0.100.0-16) ...<br />Setting up libvirt-bin (1.2.2-0ubuntu13.1.2) ...<br />Adding group `libvirtd' (GID 126) ...<br />Done.<br />libvirt-bin start/running, process 4716<br />Setting up libvirt-bin dnsmasq configuration.<br />Setting up qemu-kvm (2.0.0+dfsg-2ubuntu1.3) ...<br />Processing triggers for ureadahead (0.100.0-16) ...<br />Setting up libgnome2-bin (2.32.1-4ubuntu1) ...<br />Setting up libgnome2-0:amd64 (2.32.1-4ubuntu1) ...<br />Setting up libbonoboui2-0:amd64 (2.24.5-0ubuntu3) ...<br />Setting up libgnomeui-0:amd64 (2.24.5-3) ...<br />Setting up python-gnome2 (2.28.1+dfsg-1ubuntu2) ...<br />Setting up virt-manager (0.9.5-1ubuntu3) ...<br />Processing triggers for libc-bin (2.19-0ubuntu6) ...<br />gstanden@vmem2:~$ <br /><br /></code><code>gstanden@vmem:~$ </code><code>sudo apt-get install openvswitch-common openvswitch-controller<br /><br />gstanden@vmem2:~$ sudo apt-get install openvswitch-common openvswitch-controller | tee log2<br /><br />Reading package lists...<br />Building dependency tree...<br />Reading state information...<br />openvswitch-common is already the newest version.<br />openvswitch-common set to manually installed.<br />The following NEW packages will be installed:<br />  openvswitch-controller openvswitch-pki<br />0 upgraded, 2 newly installed, 0 to remove and 116 not upgraded.<br />Need to get 283 kB of archives.<br />After this operation, 958 kB of additional disk space will be used.<br />Get:1 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main openvswitch-pki all 2.0.2-0ubuntu0.14.04.1 [14.8 kB]<br />Get:2 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main openvswitch-controller amd64 2.0.2-0ubuntu0.14.04.1 [268 kB]<br />Fetched 283 kB in 0s (341 kB/s)<br />Selecting previously unselected package openvswitch-pki.<br />(Reading database ... 196477 files and directories currently installed.)<br />Preparing to unpack .../openvswitch-pki_2.0.2-0ubuntu0.14.04.1_all.deb ...<br />Unpacking openvswitch-pki (2.0.2-0ubuntu0.14.04.1) ...<br />Selecting previously unselected package openvswitch-controller.<br />Preparing to unpack .../openvswitch-controller_2.0.2-0ubuntu0.14.04.1_amd64.deb ...<br />Unpacking openvswitch-controller (2.0.2-0ubuntu0.14.04.1) ...<br />Processing triggers for ureadahead (0.100.0-16) ...<br />Processing triggers for man-db (2.6.7.1-1) ...<br />Setting up openvswitch-pki (2.0.2-0ubuntu0.14.04.1) ...<br />Creating controllerca...<br />Creating switchca...<br />Setting up openvswitch-controller (2.0.2-0ubuntu0.14.04.1) ...<br /> * Starting ovs-controller  ovs-controller<br />2014-09-11T01:22:50Z|00001|stream_ssl|INFO|Trusting CA cert from /etc/openvswitch-controller/cacert.pem <br /><span> </span>(/C=US/ST=CA/O=Open vSwitch/OU=switchca/CN=OVS switchca CA Certificate (2014 Sep 10 20:22:49)) (fingerprint c2:12:1e:ea:b1:9e:d7:79:22:ff:8e:0b:21:98:0d:66:76:b6:11:ac)<br />   ...done.<br />Processing triggers for ureadahead (0.100.0-16) ...<br />gstanden@vmem2:~$ <br /><br /></code></font></div></pre>
<p><font size="3">References:  <a href="http://www.rivy.org/2014/04/install-a-kvm-host-on-ubuntu-14-04-trusty-tahr/" rel="nofollow">Install a KVM host on Ubuntu 14.04 Trusty Tahr</a></font>
</p><p><font size="3">After OpenvSwitch has been installed verify correct installation and function with following steps as shown below.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem2:~$ sudo ovs-vsctl show<br /><br />6c15b7a4-1aac-40fb-b312-563401cd0cc1<br />    ovs_version: "2.0.2"<br /><br />gstanden@vmem2:~$ <br /></code></font></div></font></pre>
<p><font size="3">After KVM has been installed verify correct installation and function with the following steps as shown below.  Be sure to use "sudo".<br /></font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem2:~$ sudo virsh -c qemu:///system list<br /> Id    Name                           State<br />----------------------------------------------------<br /><br />gstanden@vmem2:~$ </code></font><font size="3">
</font></div></font></pre><font size="3">Note, If you forgot to use "sudo" in front of the above "virsh" command you will get the following error messages as shown below.  Retry the command using "sudo" for correct operation.<br /><br /><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem2:~$ virsh -c qemu:///system list</code><br /><code>error: failed to connect to the hypervisor</code><br /><code>error: Failed to connect socket to '/var/run/libvirt/libvirt-sock': Permission denied</code><br /><code>gstanden@vmem2:~$ </code></font></div></font><h3><a name="TOC-Install-OpenSSH-Server-DHCP-and-UML-Utilities"></a><font size="3"><span>Install OpenSSH Server, DHCP, and UML Utilities</span></font></h3>
<p><font size="3">All of these are also installed from the apt-get repositories in this wiki as shown below.  These too can probably be installed from source for those who want themost recent version.  These repository versions for Ubuntu 14.04.1 have all the features needed.
</font></p><p><font size="3">The uml-utilities  package is needed to support the "tunctl" functionality used as part of building the OpenvSwitch.
</font></p><p><font size="3">The openssh-server is needed so that it will be possible to ssh from the KVM guest back to the KVM host.  Ubuntu 14.04.1 Desktop version does not come with the openssh-server by default, so it has to be installed.</font></p><p><font size="3">The uuid package, while not used explicitly in this particular wiki page, is used in other pages on this site related to KVM when creating a new KVM guest from an XML file and a new UUID is needed for the XML guest creation, so it is installed now.<br />
</font></p>
<div class="sites-codeblock sites-codesnippet-block"><code><font size="4">gstanden@vmem2:~$ sudo apt-get install uml-utilities openssh-server isc-dhcp-server uuid | tee log3<br /><br />Reading package lists...<br />Building dependency tree...<br />Reading state information...<br />The following extra packages will be installed:<br />  libck-connector0 libossp-uuid16 ncurses-term openssh-sftp-server<br />  python-requests python-urllib3 ssh-import-id<br />Suggested packages:<br />  isc-dhcp-server-ldap rssh molly-guard monkeysphere user-mode-linux<br />The following NEW packages will be installed:<br />  isc-dhcp-server libck-connector0 libossp-uuid16 ncurses-term openssh-server<br />  openssh-sftp-server python-requests python-urllib3 ssh-import-id<br />  uml-utilities uuid<br />0 upgraded, 11 newly installed, 0 to remove and 116 not upgraded.<br />Need to get 1,562 kB of archives.<br />After this operation, 6,436 kB of additional disk space will be used.<br />Do you want to continue? [Y/n] Y<br />Get:1 http://us.archive.ubuntu.com/ubuntu/ trusty/main libck-connector0 amd64 0.4.5-3.1ubuntu2 [10.5 kB]<br />Get:2 http://us.archive.ubuntu.com/ubuntu/ trusty/main isc-dhcp-server amd64 4.2.4-7ubuntu12 [762 kB]<br />Get:3 http://us.archive.ubuntu.com/ubuntu/ trusty/main libossp-uuid16 amd64 1.6.2-1.3ubuntu1 [29.6 kB]<br />Get:4 http://us.archive.ubuntu.com/ubuntu/ trusty/main ncurses-term all 5.9+20140118-1ubuntu1 [243 kB]<br />Get:5 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main openssh-sftp-server amd64 1:6.6p1-2ubuntu2 [34.1 kB]<br />Get:6 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main openssh-server amd64 1:6.6p1-2ubuntu2 [319 kB]<br />Get:7 http://us.archive.ubuntu.com/ubuntu/ trusty/main python-urllib3 all 1.7.1-1build1 [38.9 kB]<br />Get:8 http://us.archive.ubuntu.com/ubuntu/ trusty/main python-requests all 2.2.1-1 [42.5 kB]<br />Get:9 http://us.archive.ubuntu.com/ubuntu/ trusty/universe uuid amd64 1.6.2-1.3ubuntu1 [10.9 kB]<br />Get:10 http://us.archive.ubuntu.com/ubuntu/ trusty/main ssh-import-id all 3.21-0ubuntu1 [9,624 B]<br />Get:11 http://us.archive.ubuntu.com/ubuntu/ trusty/universe uml-utilities amd64 20070815-1.3ubuntu1 [61.9 kB]<br />Preconfiguring packages ...<br />Fetched 1,562 kB in 2s (632 kB/s)<br />Selecting previously unselected package libck-connector0:amd64.<br />(Reading database ... 196492 files and directories currently installed.)<br />Preparing to unpack .../libck-connector0_0.4.5-3.1ubuntu2_amd64.deb ...<br />Unpacking libck-connector0:amd64 (0.4.5-3.1ubuntu2) ...<br />Selecting previously unselected package isc-dhcp-server.<br />Preparing to unpack .../isc-dhcp-server_4.2.4-7ubuntu12_amd64.deb ...<br />Unpacking isc-dhcp-server (4.2.4-7ubuntu12) ...<br />Selecting previously unselected package libossp-uuid16.<br />Preparing to unpack .../libossp-uuid16_1.6.2-1.3ubuntu1_amd64.deb ...<br />Unpacking libossp-uuid16 (1.6.2-1.3ubuntu1) ...<br />Selecting previously unselected package ncurses-term.<br />Preparing to unpack .../ncurses-term_5.9+20140118-1ubuntu1_all.deb ...<br />Unpacking ncurses-term (5.9+20140118-1ubuntu1) ...<br />Selecting previously unselected package openssh-sftp-server.<br />Preparing to unpack .../openssh-sftp-server_1%3a6.6p1-2ubuntu2_amd64.deb ...<br />Unpacking openssh-sftp-server (1:6.6p1-2ubuntu2) ...<br />Selecting previously unselected package openssh-server.<br />Preparing to unpack .../openssh-server_1%3a6.6p1-2ubuntu2_amd64.deb ...<br />Unpacking openssh-server (1:6.6p1-2ubuntu2) ...<br />Selecting previously unselected package python-urllib3.<br />Preparing to unpack .../python-urllib3_1.7.1-1build1_all.deb ...<br />Unpacking python-urllib3 (1.7.1-1build1) ...<br />Selecting previously unselected package python-requests.<br />Preparing to unpack .../python-requests_2.2.1-1_all.deb ...<br />Unpacking python-requests (2.2.1-1) ...<br />Selecting previously unselected package uuid.<br />Preparing to unpack .../uuid_1.6.2-1.3ubuntu1_amd64.deb ...<br />Unpacking uuid (1.6.2-1.3ubuntu1) ...<br />Selecting previously unselected package ssh-import-id.<br />Preparing to unpack .../ssh-import-id_3.21-0ubuntu1_all.deb ...<br />Unpacking ssh-import-id (3.21-0ubuntu1) ...<br />Selecting previously unselected package uml-utilities.<br />Preparing to unpack .../uml-utilities_20070815-1.3ubuntu1_amd64.deb ...<br />Unpacking uml-utilities (20070815-1.3ubuntu1) ...<br />Processing triggers for man-db (2.6.7.1-1) ...<br />Processing triggers for ureadahead (0.100.0-16) ...<br />Processing triggers for ufw (0.34~rc-0ubuntu2) ...<br />Setting up libck-connector0:amd64 (0.4.5-3.1ubuntu2) ...<br />Setting up isc-dhcp-server (4.2.4-7ubuntu12) ...<br />Generating /etc/default/isc-dhcp-server...<br />isc-dhcp-server start/running, process 6157<br />isc-dhcp-server6 stop/pre-start, process 6199<br />Setting up libossp-uuid16 (1.6.2-1.3ubuntu1) ...<br />Setting up ncurses-term (5.9+20140118-1ubuntu1) ...<br />Setting up openssh-sftp-server (1:6.6p1-2ubuntu2) ...<br />Setting up openssh-server (1:6.6p1-2ubuntu2) ...<br />Creating SSH2 RSA key; this may take some time ...<br />Creating SSH2 DSA key; this may take some time ...<br />Creating SSH2 ECDSA key; this may take some time ...<br />Creating SSH2 ED25519 key; this may take some time ...<br />ssh start/running, process 6424<br />Setting up python-urllib3 (1.7.1-1build1) ...<br />Setting up python-requests (2.2.1-1) ...<br />Setting up uuid (1.6.2-1.3ubuntu1) ...<br />Setting up ssh-import-id (3.21-0ubuntu1) ...<br />Setting up uml-utilities (20070815-1.3ubuntu1) ...<br /> * Starting User-mode networking switch uml_switch<br />   ...done.<br />Processing triggers for libc-bin (2.19-0ubuntu6) ...<br />Processing triggers for ureadahead (0.100.0-16) ...<br />Processing triggers for ufw (0.34~rc-0ubuntu2) ...<br /><br />gstanden@vmem2:~$ <br /></font></code></div><h3><a name="TOC-Build-OpenvSwitch"></a>Build OpenvSwitch
</h3><h4><a name="TOC-Create-the-crt_ovs_sw1.sh-Script"></a>Create the crt_ovs_sw1.sh Script<br /></h4><p><font size="3">Our switch is a modification to some procedures described at the <a href="https://www.virtualbox.org/wiki/Advanced_Networking_Linux" rel="nofollow">Advanced Networking Page by Jean-Jacques Sarton</a> which I have modified for use with OpenvSwitch. First we can build the OpenvSwitch using the script shown below. You can replace the ip range specified with whatever internal address range you wish to use.  Note also that the link to the Jean-Jacques work explains how to create additional ports on the switch when adding additional KVM guests.  Note that if you change the address range, you will need to also change the address ranges in the /etc/dhcpd/dhcpd.conf file also shown below.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem2:~$ chmod +x crt_ovs_sw1.sh <br /><br />gstanden@vmem2:~$ ls -lrt crt_ovs_sw1.sh <br />-rwxrwxr-x 1 gstanden gstanden 1834 Sep 10 20:32 crt_ovs_sw1.sh<br /><br />gstanden@vmem2:~$ cat crt_ovs_sw1.sh <br /><br />#!/bin/bash<br /># Requires use of Upstart Script /etc/init/my-network-up.conf to ensure interfaces are up before running.<br /> <br />tunctl -t s1<br />tunctl -t s2<br />tunctl -t s3<br />tunctl -t s4<br />tunctl -t s5<br />tunctl -t s6<br />ip link set s1 up<br />ip link set s2 up<br />ip link set s3 up<br />ip link set s4 up<br />ip link set s5 up<br />ip link set s6 up<br />ovs-vsctl add-br sw1<br />ovs-vsctl add-port sw1 s1<br />ovs-vsctl add-port sw1 s2<br />ovs-vsctl add-port sw1 s3<br />ovs-vsctl add-port sw1 s4<br />ovs-vsctl add-port sw1 s5<br />ovs-vsctl add-port sw1 s6<br />ip link set up dev sw1<br />ip addr add 10.207.39.1/24 dev sw1<br />ip route replace 10.207.39.0/24 dev sw1<br /><br /># GLS 20140825 Get active external interface dynamically at boot.  Tested &amp; works with {wlan0, eth0, bnep0} on NM-manager Ubuntu 14.04.1 Desktop x86_64.<br /># GLS 20140825 Interface "bnep0" is Blackberry Z30 OS10 Bluetooth Tether.<br /><br />### BEGIN Get Active EXTIF Dynamcially. ###<br />function GetInterface<br />{<br />ifconfig|egrep -B1 'inet addr'|egrep -A1 'wlan0|eth0|bnep0'|sed '$!N;s/\n/ /' | sed 's/  */ /g' | cut -f1,7 -d' ' | sed 's/ addr//' | head -1 | cut -f1 -d':'<br />}<br />function GetIP<br />{<br />ifconfig|egrep -B1 'inet addr'|egrep -A1 'wlan0|eth0|bnep0'|sed '$!N;s/\n/ /' | sed 's/  */ /g' | cut -f1,7 -d' ' | sed 's/ addr//' | head -1 | cut -f2 -d':'<br />}<br />### END Get Active EXTIF Dynamically. ###<br /><br />echo '       IP: '$(GetIP)<br />echo 'Interface: '$(GetInterface)<br /><br />INTIF="sw1"<br />EXTIF=$(GetInterface)<br /># EXTIF="wlan0"<br /><br />echo 1 &gt; /proc/sys/net/ipv4/ip_forward<br /><br /># clear existing iptable rules, set a default policy<br />iptables -P INPUT ACCEPT<br />iptables -F INPUT<br />iptables -P OUTPUT ACCEPT<br />iptables -F OUTPUT<br />iptables -P FORWARD DROP<br />iptables -F FORWARD<br />iptables -t nat -F<br /><br /># set forwarding and nat rules<br />iptables -A FORWARD -i $EXTIF -o $INTIF -j ACCEPT<br />iptables -A FORWARD -i $INTIF -o $EXTIF -j ACCEPT<br />iptables -t nat -A POSTROUTING -o $EXTIF -j MASQUERADE<br /><br />service isc-dhcp-server start<br />gstanden@vmem2:~$ 
</code></font></div></font></pre>
<h4><a name="TOC-Create-the-etc-init-my-network-up.conf-Script"></a><font size="3">Create the /etc/init/my-network-up.conf Script</font></h4><p><font size="3">Create the /etc/init/my-network-up.conf script as shown below and make sure it is executable.</font><br /></p><div class="sites-codeblock sites-codesnippet-block"><p><font size="4"><code>gstanden@vmem2:~$ sudo vi /etc/init/my-network-up.conf</code><br /><br /><code>gstanden@vmem2:~$ sudo chmod +x /etc/init/my-network-up.conf</code></font></p><p><font size="4"><code>gstanden@vmem2:~$ ls -l /etc/init/my-network-up.conf </code><br /><code>-rwxr-xr-x 1 root root 456 Sep 10 20:40 /etc/init/my-network-up.conf</code><br /><code>gstanden@vmem2:~$ </code><br /></font></p><p><font size="4"><code>gstanden@vmem2:~$ cat /etc/init/my-network-up.conf </code></font></p><p><font size="4"><code># 'my-network-up.conf' - My custom upstart events</code><br /><code>#</code><br /><code># These are the scripts that run when a network appears.</code><br /><br /><code>description "My custom upstart events"</code><br /><br /><code>start on net-device-up     # Start a daemon or run a script</code><br /><code>stop on net-device-down    # (Optional) Stop a daemon, scripts already self-terminate.</code><br /><br /><code>script</code><br /><code># You can really put shell script in here, including if/then and tests.</code><br /><code>/home/gstanden/crt_ovs_sw1.sh 2&gt;&amp;1 &gt; /home/gstanden/crt_ovs_sw1.log</code><br /><code>end script</code></font></p><p><font size="4"><code>gstanden@vmem2:~$ </code></font></p></div><p><font size="3">If you need to add more ports for additional virtual machines, they can be added using the following commands for example.<br /></font></p><div class="sites-codeblock sites-codesnippet-block"><font size="3"><font size="4"><code>gstanden@vmem1:~$ sudo tunctl -t s7</code><br /><code>Set 's7' persistent and owned by uid 0</code><br /><code>gstanden@vmem1:~$ sudo ip link set s7 up</code><br /><code>gstanden@vmem1:~$ sudo ovs-vsctl add-port sw1 s7</code></font></font></div><p><font size="3">Creation of the additional ports can be scripted and methods of doing that are detailed at the reference </font><font size="3"><font size="3"> <a href="https://www.virtualbox.org/wiki/Advanced_Networking_Linux" rel="nofollow">Advanced Networking Page by Jean-Jacques Sarton <br /></a></font></font></p><p><font size="3">In order to assign ip addresses from DHCP, we need to now configure our DHCP server.  Below is an example configuration file with the necessary configuration for assigning DHCP addresses to the KVM guests.  Once the configuration file has been edited and saved, it is necessary to restart the DHCP service.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code><br />gstanden@vmem2:~$ sudo mv /etc/dhcp/dhcpd.conf /etc/dhcp/dhcpd.conf.pkg.install.original<br /><br />gstanden@vmem2:~$ sudo vi /etc/dhcp/dhcpd.conf<br /><br />gstanden@vmem2:~$ sudo cat /etc/dhcp/dhcpd.conf<br />#<br />                                   # Sample configuration file for ISC dhcpd for Debian<br />#<br />                                   # Attention: If /etc/ltsp/dhcpd.conf exists, that will be used as<br /># configuration file instead of this file.<br />#<br />                                   #<br />                                   <br />                                   # The ddns-updates-style parameter controls whether or not the server will<br /># attempt to do a DNS update when a lease is confirmed. We default to the<br /># behavior of the version 2 packages ('none', since DHCP v2 didn't<br /># have support for DDNS.)<br /><br />ddns-update-style interim;<br />ignore client-updates;<br /><br /># option definitions common to all supported networks...<br />option domain-name "example.org";<br />option domain-name-servers ns1.example.org, ns2.example.org;<br /><br />default-lease-time 600;<br />max-lease-time 7200;<br /><br /># If this DHCP server is the official DHCP server for the local<br /># network, the authoritative directive should be uncommented.<br />#authoritative;<br />                                   <br />                                   # Use this to send dhcp log messages to a different log file (you also<br /># have to hack syslog.conf to complete the redirection).<br />log-facility local7;<br /><br /># No service will be given on this subnet, but declaring it helps the <br /># DHCP server to understand the network topology.<br /><br />#subnet 10.152.187.0 netmask 255.255.255.0 {<br />#}<br />                                   <br />                                   # This is a very basic subnet declaration.<br /><br />#subnet 10.254.239.0 netmask 255.255.255.224 {<br />#  range 10.254.239.10 10.254.239.20;<br />#  option routers rtr-239-0-1.example.org, rtr-239-0-2.example.org;<br />#}<br />                                   <br />                                   # This declaration allows BOOTP clients to get dynamic addresses,<br /># which we don't really recommend.<br /><br />#subnet 10.254.239.32 netmask 255.255.255.224 {<br />#  range dynamic-bootp 10.254.239.40 10.254.239.60;<br />#  option broadcast-address 10.254.239.31;<br />#  option routers rtr-239-32-1.example.org;<br />#}<br />                                   <br />                                   # A slightly different configuration for an internal subnet.<br />#subnet 10.5.5.0 netmask 255.255.255.224 {<br />#  range 10.5.5.26 10.5.5.30;<br />#  option domain-name-servers ns1.internal.example.org;<br />#  option domain-name "internal.example.org";<br />#  option routers 10.5.5.1;<br />#  option broadcast-address 10.5.5.31;<br />#  default-lease-time 600;<br />#  max-lease-time 7200;<br />#}<br />                                   <br />                                   # Hosts which require special configuration options can be listed in<br /># host statements.   If no address is specified, the address will be<br /># allocated dynamically (if possible), but the host-specific information<br /># will still come from the host declaration.<br /><br />#host passacaglia {<br />#  hardware ethernet 0:0:c0:5d:bd:95;<br />#  filename "vmunix.passacaglia";<br />#  server-name "toccata.fugue.com";<br />#}<br />                                   <br />                                   # Fixed IP addresses can also be specified for hosts.   These addresses<br /># should not also be listed as being available for dynamic assignment.<br /># Hosts for which fixed IP addresses have been specified can boot using<br /># BOOTP or DHCP.   Hosts for which no fixed address is specified can only<br /># be booted with DHCP, unless there is an address range on the subnet<br /># to which a BOOTP client is connected which has the dynamic-bootp flag<br /># set.<br />                                   #host fantasia {<br />#  hardware ethernet 08:00:07:26:c0:a5;<br />#  fixed-address fantasia.fugue.com;<br />#}<br />                                   <br />                                   # You can declare a class of clients and then do address allocation<br /># based on that.   The example below shows a case where all clients<br /># in a certain class get addresses on the 10.17.224/24 subnet, and all<br /># other clients get addresses on the 10.0.29/24 subnet.<br /><br />#class "foo" {<br />                                   #  match if substring (option vendor-class-identifier, 0, 4) = "SUNW";<br />#}<br />                                   <br />                                   #shared-network 224-29 {<br />#  subnet 10.17.224.0 netmask 255.255.255.0 {<br />#    option routers rtr-224.example.org;<br />#  }<br />                                   #  subnet 10.0.29.0 netmask 255.255.255.0 {<br />#    option routers rtr-29.example.org;<br />#  }<br />                                   #  pool {<br />                                   #    allow members of "foo";<br />#    range 10.17.224.10 10.17.224.250;<br />#  }<br />                                   #  pool {<br />                                   #    deny members of "foo";<br />#    range 10.0.29.10 10.0.29.230;<br />#  }<br />                                   #}The uml-utilities  package is needed to support the "tunctl" functionality <br />                                   # used as part of building the OpenvSwitch.<br /><br />subnet 10.207.39.0 netmask 255.255.255.0 {<br /><br /># --- default gateway<br />	option routers			10.207.39.1;<br />	option subnet-mask		255.255.255.0;<br /><br />	option domain-name		"vmem.org";<br />	option domain-name-servers	10.207.39.1;<br /><br />#	option ntp-servers		10.207.39.1;<br /><br />	range dynamic-bootp 10.207.39.50 10.207.39.254;<br />	default-lease-time 21600;<br />	max-lease-time 43200;<br />}<br />gstanden@vmem2:~$ sudo chmod +x /etc/dhcp/dhcpd.conf<br /><br />gstanden@vmem2:~$ ls -lrt /etc/dhcp/dhcpd.conf<br />-rwxr-xr-x 1 root root 5145 Sep 10 20:46 /etc/dhcp/dhcpd.conf<br /><br />gstanden@vmem2:~$ </code></font>
</div></font></pre><p><font size="3">Check status of isc-dhcp-server and restart isc-dhcp-server to effect read of new configuration as shown below.</font></p><div class="sites-codeblock sites-codesnippet-block"><font size="3"><font size="4"><code>gstanden@vmem2:~$ sudo service isc-dhcp-server status</code><br /><code>isc-dhcp-server stop/waiting</code><br /><code>gstanden@vmem2:~$ sudo service isc-dhcp-server restart</code><br /><code>stop: Unknown instance: </code><br /><code>isc-dhcp-server start/running, process 6887</code><br /><code>gstanden@vmem2:~</code></font></font></div><p><font size="3">Reboot the Ubuntu KVM host (in this example a Lenovo W540 Mobile Workstation)  to verify that the OpenvSwitch starts and verify start of DHCP server. Expected correct output from the log of the crt_ovs_sw1.sh script, the isc-dhcp-server, and from ovs-vsctl (OpenvSwitch utility) are shown below.</font></p><div class="sites-codeblock sites-codesnippet-block"><p><font size="4"><code>gstanden@vmem2:~$ more crt_ovs_sw1.log</code></font></p><p><font size="4"><code>Set 's1' persistent and owned by uid 0</code><br /><code>Set 's2' persistent and owned by uid 0</code><br /><code>Set 's3' persistent and owned by uid 0</code><br /><code>Set 's4' persistent and owned by uid 0</code><br /><code>Set 's5' persistent and owned by uid 0</code><br /><code>Set 's6' persistent and owned by uid 0</code><br /><code>       IP: 192.168.1.16</code><br /><code>Interface: wlan0isc-dhcp-server start/running, process 2284</code></font></p><p><font size="4"><code>gstanden@vmem2:~$ sudo service isc-dhcp-server status</code><br /><code>[sudo] password for gstanden: </code><br /><code>isc-dhcp-server start/running, process 2284</code></font></p><p><font size="4"><code>gstanden@vmem2:~$ sudo ovs-vsctl show</code><br /><code>6c15b7a4-1aac-40fb-b312-563401cd0cc1</code><br /><code>    Bridge "sw1"</code><br /><code>        Port "s3"</code><br /><code>            Interface "s3"</code><br /><code>        Port "s5"</code><br /><code>            Interface "s5"</code><br /><code>        Port "s2"</code><br /><code>            Interface "s2"</code><br /><code>        Port "sw1"</code><br /><code>            Interface "sw1"</code><br /><code>                type: internal</code><br /><code>        Port "s1"</code><br /><code>            Interface "s1"</code><br /><code>        Port "s6"</code><br /><code>            Interface "s6"</code><br /><code>        Port "s4"</code><br /><code>            Interface "s4"</code><br /><code>    ovs_version: "2.0.2"</code></font></p><p><font size="4"><code>gstanden@vmem2:~$ </code></font></p></div><h3><a name="TOC-Install-Windows-8-KVM-Guest"></a>Install Windows 8 KVM Guest</h3><h4><a name="TOC-Install-bind9-DNS-Server"></a>Install bind9 DNS Server<br /></h4><p><font size="3">Install bind9 DNS server as shown below.</font><br /></p><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem2:~$ sudo apt-get install bind9</code><br /><code>Reading package lists... Done</code><br /><code>Building dependency tree       </code><br /><code>Reading state information... Done</code><br /><code>The following extra packages will be installed:</code><br /><code>  bind9utils</code><br /><code>Suggested packages:</code><br /><code>  bind9-doc</code><br /><code>The following NEW packages will be installed:</code><br /><code>  bind9 bind9utils</code><br /><code>0 upgraded, 2 newly installed, 0 to remove and 7 not upgraded.</code><br /><code>Need to get 432 kB of archives.</code><br /><code>After this operation, 1,632 kB of additional disk space will be used.</code><br /><code>Do you want to continue? [Y/n] Y</code><br /><code>Get:1 http://us.archive.ubuntu.com/ubuntu/ trusty/main bind9utils amd64 1:9.9.5.dfsg-3 [145 kB]</code><br /><code>Get:2 http://us.archive.ubuntu.com/ubuntu/ trusty/main bind9 amd64 1:9.9.5.dfsg-3 [287 kB]</code><br /><code>Fetched 432 kB in 0s (701 kB/s)</code><br /><code>Preconfiguring packages ...</code><br /><code>Selecting previously unselected package bind9utils.</code><br /><code>(Reading database ... 199396 files and directories currently installed.)</code><br /><code>Preparing to unpack .../bind9utils_1%3a9.9.5.dfsg-3_amd64.deb ...</code><br /><code>Unpacking bind9utils (1:9.9.5.dfsg-3) ...</code><br /><code>Selecting previously unselected package bind9.</code><br /><code>Preparing to unpack .../bind9_1%3a9.9.5.dfsg-3_amd64.deb ...</code><br /><code>Unpacking bind9 (1:9.9.5.dfsg-3) ...</code><br /><code>Processing triggers for man-db (2.6.7.1-1) ...</code><br /><code>Processing triggers for ureadahead (0.100.0-16) ...</code><br /><code>ureadahead will be reprofiled on next reboot</code><br /><code>Processing triggers for ufw (0.34~rc-0ubuntu2) ...</code><br /><code>Setting up bind9utils (1:9.9.5.dfsg-3) ...</code><br /><code>Setting up bind9 (1:9.9.5.dfsg-3) ...</code><br /><code>Adding group `bind' (GID 129) ...</code><br /><code>Done.</code><br /><code>Adding system user `bind' (UID 121) ...</code><br /><code>Adding new user `bind' (UID 121) with group `bind' ...</code><br /><code>Not creating home directory `/var/cache/bind'.</code><br /><code>wrote key file "/etc/bind/rndc.key"</code><br /><code>#</code><br /><code> * Starting domain name service... bind9                                                                                                                                                              [ OK ] </code><br /><code>Processing triggers for ureadahead (0.100.0-16) ...</code><br /><code>Processing triggers for ufw (0.34~rc-0ubuntu2) ...</code><br /><code>gstanden@vmem2:~$ </code></font></div><br /><h4><a name="TOC-Configure-bind9-DNS-Server"></a>Configure bind9 DNS Server</h4><p><br /></p><h3><a name="TOC-Configure-Physical-Windows8-Paritition-as-KVM-Guest"></a>Configure Physical Windows8 Paritition as KVM Guest</h3><p><font size="3">The instructions and procedure to be used for this are <a href="http://fds-team.de/cms/articles/2013-12/use-a-real-windows-7-partition-in-virtualbox-kvm-vmware-player-u.html" target="_blank" rel="nofollow">here</a>.  A reference <a href="https://www.vdvyver.net/2012/06/installation-note-for-windows-8-on-kvm/" target="_blank" rel="nofollow">here</a> is also used which describes how to import the processor definitions of the KVM host into the KVM guest needed for Windows 8 correct bootup and operation.</font></p><h3><a name="TOC-Layout-of-dev-sda"></a>Layout of /dev/sda</h3><p><font size="3">Check the current partition layout of /dev/sda.  With Windows 8 this is UEFI boot system and thus does not use the older partitioning system which limited primary partitions to only 4.  This system uses GUID so "gdisk" is used instead of "fdisk" .  The program "gdisk" should be present in a default Ubuntu install, but if not, it can be installed using "sudo apt-get install gdisk".</font></p><p><br /></p><div class="sites-codeblock sites-codesnippet-block"><font size="3"><font size="4"><code>gstanden@vmem2:~$ sudo gdisk -l /dev/sda</code><br /><code>[sudo] password for gstanden: </code><br /><code>GPT fdisk (gdisk) version 0.8.8</code><br /><br /><code>Partition table scan:</code><br /><code>  MBR: protective</code><br /><code>  BSD: not present</code><br /><code>  APM: not present</code><br /><code>  GPT: present</code><br /><br /><code>Found valid GPT with protective MBR; using GPT.</code><br /><code>Disk /dev/sda: 2000409264 sectors, 953.9 GiB</code><br /><code>Logical sector size: 512 bytes</code><br /><code>Disk identifier (GUID): 6C1440F2-7290-484D-86A1-F33DDC9C152E</code><br /><code>Partition table holds up to 128 entries</code><br /><code>First usable sector is 34, last usable sector is 2000409230</code><br /><code>Partitions will be aligned on 2048-sector boundaries</code><br /><code>Total free space is 1023638125 sectors (488.1 GiB)</code><br /><br /><code>Number  Start (sector)    End (sector)  Size       Code  Name</code><br /><code>   1            2048         2050047   1000.0 MiB  2700  </code><br /><code>   2         2050048         2582527   260.0 MiB   EF00  EFI system partition</code><br /><code>   3         2582528         2844671   128.0 MiB   0C01  Microsoft reserved part</code><br /><code>   4         2844672       413194239   195.7 GiB   0700  Basic data partition</code><br /><code>   5       948348928       976773119   13.6 GiB    2700  </code><br /><code>   6       413194240       824193023   196.0 GiB   8300  </code><br /><code>   7       824193024       834678783   5.0 GiB     8200  </code><br /><code>   8       834678784       948348927   54.2 GiB    8300  </code><br /><code>gstanden@vmem2:~$ </code></font></font></div><p><font size="3">The partition information can also be viewed using "gparted" partition editor as shown below for additional detail on the nature of each partition as to type, size, and detailed information. As shown below, the first partition is a Lenovo Windows Recovery Partition.  The partitions and their natures can be listed as shown below.</font></p><div style="display:block;text-align:left"><font size="3"><a href="kvm-openvswitch-1/gparted-1.png%3Fattredirects=0" imageanchor="1"><img border="0" src="../_/rsrc/1518480256916/kvm-and-openvswitch/kvm-openvswitch-1/gparted-1.png" /></a></font></div><br /></div><div lang="en"><table border="1" bordercolor="#888" cellspacing="0" style="border-collapse:collapse;border-color:rgb(136,136,136);border-width:1px"><tbody><tr><td style="width:71px;height:32px;text-align:center"> Partition Number<br /></td><td style="width:70px;height:32px;text-align:center"> Partition</td><td style="text-align:center;width:121px;height:32px"> Label</td><td style="text-align:center;width:148px;height:32px"> Purpose</td><td style="text-align:center;width:60px;height:32px"> OS</td><td style="text-align:center;width:313px;height:32px"> Notes</td><td style="text-align:center;width:67px;height:32px">Start Sector <br /></td><td style="text-align:center;width:67px;height:32px">End Sector <br /></td><td style="text-align:center;width:65px;height:32px"> Size</td><td style="text-align:center;width:60px;height:32px"> Code</td><td style="text-align:center;width:149px;height:32px"> Name<br /></td><td style="text-align:center;width:60px;height:32px"> Flags</td></tr><tr><td style="width:71px;height:48px;text-align:center"> 1</td><td style="width:70px;height:48px;text-align:center"> /dev/sda1</td><td style="text-align:center;width:121px;height:48px">WINRE_DRV <br /></td><td style="text-align:center;width:148px;height:48px">Recovery/Diagnostic <br /></td><td style="text-align:center;width:60px;height:48px"> Windows</td><td style="text-align:center;width:313px;height:48px"> Lenovo Recovery<br /></td><td style="text-align:right;width:67px;height:48px"> <span>   2048</span><span>  </span><br /></td><td style="text-align:right;width:67px;height:48px">2050047 <br /></td><td style="text-align:right;width:65px;height:48px">1000.0 Mb <br /></td><td style="text-align:right;width:60px;height:48px">2700 <br /></td><td style="text-align:left;width:149px;height:48px"> <br /></td><td style="text-align:left;width:60px;height:48px">hidden<br />diag<br /></td></tr><tr><td style="width:71px;height:64px;text-align:center"> 2</td><td style="width:70px;height:64px;text-align:center"> /dev/sda2</td><td style="text-align:center;width:121px;height:64px"> SYSTEM_DRV</td><td style="text-align:center;width:148px;height:64px"> boot/efi</td><td style="text-align:center;width:60px;height:64px"> All<br />Windows<br />Ubuntu<br /></td><td style="text-align:left;width:313px;height:64px">Ubuntu grub2 boot loader is on this partition. The Ubuntu installer looks for the partition marked as boot during install and chooses it for grub2 install.  <br /></td><td style="text-align:right;width:67px;height:64px"> 2050048</td><td style="text-align:right;width:67px;height:64px">2582527<br /></td><td style="text-align:right;width:65px;height:64px"> 260.0 Mb<br /></td><td style="text-align:right;width:60px;height:64px">EF00 <br /></td><td style="text-align:left;width:149px;height:64px"> EFI System Partition</td><td style="text-align:left;width:60px;height:64px"> boot</td></tr><tr><td style="width:71px;height:32px;text-align:center">3</td><td style="width:70px;height:32px;text-align:center"> /dev/sda3</td><td style="text-align:center;width:121px;height:32px"> </td><td style="text-align:center;width:148px;height:32px"> </td><td style="text-align:center;width:60px;height:32px">Windows <br /></td><td style="width:313px;height:32px"> </td><td style="text-align:right;width:67px;height:32px"> 2582528</td><td style="text-align:right;width:67px;height:32px">2844671 <br /></td><td style="text-align:right;width:65px;height:32px">128.0 Mb <br /></td><td style="text-align:right;width:60px;height:32px">0C01  <br /></td><td style="text-align:left;width:149px;height:32px">Microsoft Reserved Partition <br /></td><td style="text-align:left;width:60px;height:32px">msftres <br /></td></tr><tr><td style="width:71px;height:16px;text-align:center">4</td><td style="width:70px;height:16px;text-align:center">/dev/sda4 <br /></td><td style="text-align:center;width:121px;height:16px">Windows8_OS <br /></td><td style="text-align:center;width:148px;height:16px"> </td><td style="text-align:center;width:60px;height:16px"> </td><td style="text-align:center;width:313px;height:16px">Windows 8 "C:" partition   <br /></td><td style="text-align:right;width:67px;height:16px">2844672 <br /></td><td style="text-align:right;width:67px;height:16px">413194239 <br /></td><td style="text-align:right;width:65px;height:16px">195.7 Gb <br /></td><td style="text-align:right;width:60px;height:16px">0700 <br /></td><td style="text-align:left;width:149px;height:16px">Basic Data Partition<br /></td><td style="text-align:left;width:60px;height:16px">msftdata</td></tr><tr><td style="width:71px;height:16px;text-align:center">5</td><td style="width:70px;height:16px;text-align:center">/dev/sda5</td><td style="text-align:center;width:121px;height:16px"> Lenovo_Recovery</td><td style="text-align:center;width:148px;height:16px"><br /></td><td style="text-align:center;width:60px;height:16px"> </td><td style="text-align:center;width:313px;height:16px">Lenovo Recovery<br /></td><td style="text-align:right;width:67px;height:16px">948348928 <br /></td><td style="text-align:right;width:67px;height:16px">976773119 <br /></td><td style="text-align:right;width:65px;height:16px">13.6 Gb <br /></td><td style="width:60px;height:16px;text-align:right">2700</td><td style="text-align:left;width:149px;height:16px"> <br /></td><td style="text-align:left;width:60px;height:16px"> </td></tr><tr><td style="width:71px;height:16px;text-align:center">6</td><td style="width:70px;height:16px;text-align:center">/dev/sda6</td><td style="text-align:center;width:121px;height:16px"><br /></td><td style="text-align:center;width:148px;height:16px">Ubuntu root "/" partition<br /></td><td style="text-align:center;width:60px;height:16px"> </td><td style="text-align:center;width:313px;height:16px"> Ubuntu Linux Root</td><td style="text-align:right;width:67px;height:16px">413194240 <br /></td><td style="text-align:right;width:67px;height:16px">824193023 <br /></td><td style="text-align:right;width:65px;height:16px">196.0 Gb <br /></td><td style="width:60px;height:16px;text-align:right">8300</td><td style="text-align:left;width:149px;height:16px"> <br /></td><td style="text-align:left;width:60px;height:16px"> </td></tr><tr><td style="width:71px;height:16px;text-align:center">7</td><td style="width:70px;height:16px;text-align:center">/dev/sda7</td><td style="text-align:center;width:121px;height:16px"><br /></td><td style="text-align:center;width:148px;height:16px">Ubuntu "swap" partition<br /></td><td style="text-align:center;width:60px;height:16px"> </td><td style="text-align:center;width:313px;height:16px"> Ubuntu Linux Swap</td><td style="text-align:right;width:67px;height:16px">824193024 <br /></td><td style="text-align:right;width:67px;height:16px">834678783 <br /></td><td style="text-align:right;width:65px;height:16px">5.0 Gb <br /></td><td style="width:60px;height:16px;text-align:right">8200 <br /></td><td style="text-align:left;width:149px;height:16px"> <br /></td><td style="text-align:left;width:60px;height:16px"> </td></tr><tr><td style="width:71px;height:32px;text-align:center">8</td><td style="width:70px;height:32px;text-align:center">/dev/sda8</td><td style="text-align:center;width:121px;height:32px"><br /></td><td style="text-align:center;width:148px;height:32px">Ubuntu "/home" partition<br /></td><td style="text-align:center;width:60px;height:32px"> </td><td style="text-align:center;width:313px;height:32px"> Ubuntu Linux Home</td><td style="text-align:right;width:67px;height:32px"> 834678784</td><td style="text-align:right;width:67px;height:32px">948348927 <br /></td><td style="text-align:right;width:65px;height:32px"> 54.2 Gb</td><td style="width:60px;height:32px;text-align:right">8300 <br /></td><td style="text-align:left;width:149px;height:32px"> </td><td style="text-align:left;width:60px;height:32px"> </td></tr></tbody></table><br /></div><div lang="en"><h3><a name="TOC-Create-Master-Boot-Record-File"></a>Create Master Boot Record File</h3><p><font size="3">Create the MBR file as shown below.</font></p><div class="sites-codeblock sites-codesnippet-block"><font size="3"><font size="4"><code>gstanden@vmem2:~$ pwd</code><br /><code>/home/gstanden</code><br /><code>gstanden@vmem2:~$ mkdir kvm</code><br /><code>gstanden@vmem2:~$ cd kvm</code><br /><code>gstanden@vmem2:~/kvm$ mkdir windows8</code><br /><code>gstanden@vmem2:~/kvm$ cd windows8</code><br /><code>gstanden@vmem2:~/kvm/windows8$ dd if=/dev/zero of=boot.mbr count=2048</code><br /><code>2048+0 records in</code><br /><code>2048+0 records out</code><br /><code>1048576 bytes (1.0 MB) copied, 0.0113271 s, 92.6 MB/s</code><br /><code>gstanden@vmem2:~/kvm/windows8$ </code></font></font></div><p><font size="3">Install the package "mdadm" as shown below.</font><br /></p><div class="sites-codeblock sites-codesnippet-block"><font size="3"><font size="4"><code>gstanden@vmem2:~/kvm/windows8$ ls -lrt</code><br /><code>total 1024</code><br /><code>-rw-rw-r-- 1 gstanden gstanden 1048576 Sep 10 22:04 boot.mbr</code><br /><code>gstanden@vmem2:~/kvm/windows8$ pwd</code><br /><code>/home/gstanden/kvm/windows8</code><br /><code>gstanden@vmem2:~/kvm/windows8$ sudo apt-get install mdadm</code><br /><code>[sudo] password for gstanden: </code><br /><code>Reading package lists... Done</code><br /><code>Building dependency tree       </code><br /><code>Reading state information... Done</code><br /><code>The following extra packages will be installed:</code><br /><code>  postfix</code><br /><code>Suggested packages:</code><br /><code>  procmail postfix-mysql postfix-pgsql postfix-ldap postfix-pcre sasl2-bin</code><br /><code>  dovecot-common postfix-cdb postfix-doc</code><br /><code>Recommended packages:</code><br /><code>  default-mta mail-transport-agent</code><br /><code>The following NEW packages will be installed:</code><br /><code>  mdadm postfix</code><br /><code>0 upgraded, 2 newly installed, 0 to remove and 116 not upgraded.</code><br /><code>Need to get 1,447 kB of archives.</code><br /><code>After this operation, 4,799 kB of additional disk space will be used.</code><br /><code>Do you want to continue? [Y/n] Y</code><br /><code>Get:1 http://us.archive.ubuntu.com/ubuntu/ trusty-updates/main mdadm amd64 3.2.5-5ubuntu4.1 [362 kB]</code><br /><code>Get:2 http://us.archive.ubuntu.com/ubuntu/ trusty/main postfix amd64 2.11.0-1 [1,085 kB]</code><br /><code>Fetched 1,447 kB in 1s (1,329 kB/s)</code><br /><code>Preconfiguring packages ...</code><br /><code>Selecting previously unselected package mdadm.</code><br /><code>(Reading database ... 199316 files and directories currently installed.)</code><br /><code>Preparing to unpack .../mdadm_3.2.5-5ubuntu4.1_amd64.deb ...</code><br /><code>Unpacking mdadm (3.2.5-5ubuntu4.1) ...</code><br /><code>Selecting previously unselected package postfix.</code><br /><code>Preparing to unpack .../postfix_2.11.0-1_amd64.deb ...</code><br /><code>Unpacking postfix (2.11.0-1) ...</code><br /><code>Processing triggers for ureadahead (0.100.0-16) ...</code><br /><code>ureadahead will be reprofiled on next reboot</code><br /><code>Processing triggers for doc-base (0.10.5) ...</code><br /><code>Processing 6 added doc-base files...</code><br /><code>Processing triggers for man-db (2.6.7.1-1) ...</code><br /><code>Processing triggers for ufw (0.34~rc-0ubuntu2) ...</code><br /><code>Setting up mdadm (3.2.5-5ubuntu4.1) ...</code><br /><code>Generating mdadm.conf... done.</code><br /><code> Removing any system startup links for /etc/init.d/mdadm-raid ...</code><br /><code>update-initramfs: deferring update (trigger activated)</code><br /><code>Generating grub configuration file ...</code><br /><code>Found linux image: /boot/vmlinuz-3.13.0-35-generic</code><br /><code>Found initrd image: /boot/initrd.img-3.13.0-35-generic</code><br /><code>Found linux image: /boot/vmlinuz-3.13.0-32-generic</code><br /><code>Found initrd image: /boot/initrd.img-3.13.0-32-generic</code><br /><code>Found Windows Boot Manager on /dev/sda2@/EFI/Microsoft/Boot/bootmgfw.efi</code><br /><code>Adding boot menu entry for EFI firmware configuration</code><br /><code>done</code><br /><code> * Starting MD monitoring service mdadm --monitor                                                                                                                                                     [ OK ] </code><br /><code>Setting up postfix (2.11.0-1) ...</code><br /><code>Adding group `postfix' (GID 129) ...</code><br /><code>Done.</code><br /><code>Adding system user `postfix' (UID 121) ...</code><br /><code>Adding new user `postfix' (UID 121) with group `postfix' ...</code><br /><code>Not creating home directory `/var/spool/postfix'.</code><br /><code>Creating /etc/postfix/dynamicmaps.cf</code><br /><code>Adding tcp map entry to /etc/postfix/dynamicmaps.cf</code><br /><code>Adding sqlite map entry to /etc/postfix/dynamicmaps.cf</code><br /><code>Adding group `postdrop' (GID 130) ...</code><br /><code>Done.</code><br /><code>/etc/aliases does not exist, creating it.</code><br /><br /><code>Postfix was not set up.  Start with</code><br /><code>  cp /usr/share/postfix/main.cf.debian /etc/postfix/main.cf</code><br /><code>.  If you need to make changes, edit</code><br /><code>/etc/postfix/main.cf (and others) as needed.  To view Postfix configuration</code><br /><code>values, see postconf(1).</code><br /><br /><code>After modifying main.cf, be sure to run '/etc/init.d/postfix reload'.</code><br /><br /><code>Processing triggers for ureadahead (0.100.0-16) ...</code><br /><code>Processing triggers for initramfs-tools (0.103ubuntu4.2) ...</code><br /><code>update-initramfs: Generating /boot/initrd.img-3.13.0-35-generic</code><br /><code>W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.</code><br /><code>Processing triggers for ufw (0.34~rc-0ubuntu2) ...</code><br /><code>Processing triggers for libc-bin (2.19-0ubuntu6) ...</code></font></font></div><p><font size="3">When the postfix screen appears, select "none" and tab to "Ok" &lt;Enter&gt; to continue as shown below.</font></p><div style="display:block;text-align:left"><a href="kvm-openvswitch-1/postfix-config.png%3Fattredirects=0" imageanchor="1"><img border="0" src="../_/rsrc/1518480256916/kvm-and-openvswitch/kvm-openvswitch-1/postfix-config.png" style="width:100%" /></a></div><br /><h3><a name="TOC-Run-Modprobe-Linear-Command"></a>Run Modprobe Linear Command<font size="3"><br /></font></h3><div class="sites-codeblock sites-codesnippet-block"><font size="3"><font size="4"><code>gstanden@vmem2:~/kvm/windows8$ sudo modprobe linear</code><br /><code>gstanden@vmem2:~/kvm/windows8</code></font></font></div><br /><br /><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem2:~/kvm/windows8$ sudo gdisk -l /dev/sda</code><br /><code>GPT fdisk (gdisk) version 0.8.8</code><br /><br /><code>Partition table scan:</code><br /><code>  MBR: protective</code><br /><code>  BSD: not present</code><br /><code>  APM: not present</code><br /><code>  GPT: present</code><br /><br /><code>Found valid GPT with protective MBR; using GPT.</code><br /><code>Disk /dev/sda: 2000409264 sectors, 953.9 GiB</code><br /><code>Logical sector size: 512 bytes</code><br /><code>Disk identifier (GUID): 6C1440F2-7290-484D-86A1-F33DDC9C152E</code><br /><code>Partition table holds up to 128 entries</code><br /><code>First usable sector is 34, last usable sector is 2000409230</code><br /><code>Partitions will be aligned on 2048-sector boundaries</code><br /><code>Total free space is 1023638125 sectors (488.1 GiB)</code><br /><br /><code>Number  Start (sector)    End (sector)  Size       Code  Name</code><br /><code>   1            2048         2050047   1000.0 MiB  2700  </code><br /><code>   2         2050048         2582527   260.0 MiB   EF00  EFI system partition</code><br /><code>   3         2582528         2844671   128.0 MiB   0C01  Microsoft reserved part</code><br /><code>   4         2844672       413194239   195.7 GiB   0700  Basic data partition</code><br /><code>   5       948348928       976773119   13.6 GiB    2700  </code><br /><code>   6       413194240       824193023   196.0 GiB   8300  </code><br /><code>   7       824193024       834678783   5.0 GiB     8200  </code><br /><code>   8       834678784       948348927   54.2 GiB    8300  </code><br /><code>gstanden@vmem2:~/kvm/windows8$ </code></font></div><br /><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem2:~/kvm/windows8$ sudo dd if=/dev/sda2 of=/srv/boot.mbr</code><br /><code>532480+0 records in</code><br /><code>532480+0 records out</code><br /><code>272629760 bytes (273 MB) copied, 0.833061 s, 327 MB/s</code><br /><br /><code>gstanden@vmem2:~/kvm/windows8$ ls -lrt /srv/boot.mbr</code><br /><code>-rw-r--r-- 1 root root 272629760 Sep 10 22:26 /srv/boot.mbr</code><br /><br /><code>gstanden@vmem2:~/kvm/windows8$ sudo losetup /dev/loop0 /srv/boot.mbr</code><br /><code>gstanden@vmem2:~/kvm/windows8$ </code></font></div><br /><br /><h3><a name="TOC-Build-KVM-Guest-Ubuntu-Server-14.04.1"></a>Build KVM Guest Ubuntu Server 14.04.1
</h3><p><font size="3">For the KVM guest we user Ubuntu Server version.  For this it is necessary to download the installation media from <a href="http://www.ubuntu.com/download/server" rel="nofollow">Ubuntu website</a>.  Once you have downloaded, the iso file can be used for creating the KVM guest as a file.  There is no need to burn it to a physical DVD.
</font></p><p><font size="3">Once the software is downloaded, virt-manager is started to do the GUI-based install.  Note that KVM also supports command-line non-GUI install.  Once the KVM guest has been built, the XML file of the KVM guest will be modified to replace libvirt default networking with OpenvSwitch. Launch virt-manager by going to the ubuntu program launcher and typing the first few letters of the name of the program in the search field, i.e. "virt" and select the "Virtual Machine Manager".  Once that is open, click on the icon showing a computer screen with a yellow dot at the upper-right-hand corner to launch the dialog for creating a new KVM guest.
</font></p>
<div></div>
<div style="display:block;text-align:left"></div><font size="3"><div style="display:block;text-align:left"><a href="kvm-openvswitch-1/virt-manager-1.png%3Fattredirects=0" imageanchor="1"><img border="0" src="../_/rsrc/1518480256917/kvm-and-openvswitch/kvm-openvswitch-1/virt-manager-1.png" /></a></div><br /></font>
<p><font size="3">Then create a new virtual machine dialog is displayed next as shown below.</font></p><p><font size="3"><br /></font>
</p>
<div><font size="3"><a href="https://sites.google.com/wiki/File:Virt-manager-4.png"><img alt="Virt-manager-4" height="402" src="http://img3.wikia.nocookie.net/__cb20140808214837/violin/images/1/1b/Virt-manager-4.png" width="467" /></a></font></div>
<p><font size="3"><br /></font>
</p><p><font size="3">As shown, select a name for your KVM guest machine, for example "kvm1" and also click the radio button for "Local install media (ISO image or CDROM)".  Click on next. <br /></font></p><p><font size="3"><br /></font></p><div style="display:block;text-align:left"><font size="3"><a href="kvm-openvswitch-1/virt-manager-5.png%3Fattredirects=0" imageanchor="1"><img border="0" src="../_/rsrc/1518480256917/kvm-and-openvswitch/kvm-openvswitch-1/virt-manager-5.png" /></a></font></div><font size="3"><br /></font>
<div></div>
<p><font size="3">Choose the OS type and Version as shown.  Then click the "Use ISO image" and click on the "Browse" button which brings up the "Locate ISO media volume" dialog page.  Click on the "Browse Local" button.<br /></font></p><p><br /></p><div style="display:block;text-align:left"><font size="3"><a href="kvm-openvswitch-1/virt-manager-6.png%3Fattredirects=0" imageanchor="1"><img border="0" src="../_/rsrc/1518480256917/kvm-and-openvswitch/kvm-openvswitch-1/virt-manager-6.png" /></a></font></div><font size="3"><br /></font><p><font size="3">This brings up the "Locate ISO media" dialog box. Navigate to the location of your downloaded Ubuntu Server 14.04.1 iso file, which in my case is in the /home/gstanden/Downloads folder as shown.  Click on "Open".  The full path to the ISO is populated.  Click on "Forward". <br /></font></p><p><font size="3"><br /></font></p><div style="display:block;text-align:left"><font size="3"><a href="kvm-openvswitch-1/virt-manager-7.png%3Fattredirects=0" imageanchor="1"><img border="0" src="../_/rsrc/1518480256917/kvm-and-openvswitch/kvm-openvswitch-1/virt-manager-7.png" /></a></font></div><font size="3"><br /></font>
<font size="3">Choosing the ISO file will populate the "New VM - Create a new virtual machine" ISO image field.  Click on "Forward".<br /><br /><br /></font></div><div dir="ltr" lang="en"><div style="display:block;text-align:left"><a href="kvm-openvswitch-1/virt-manager-8.png%3Fattredirects=0" imageanchor="1"><img border="0" src="../_/rsrc/1518480256917/kvm-and-openvswitch/kvm-openvswitch-1/virt-manager-8.png" /></a></div>
<p><font size="3"><br /></font>
</p><p><font size="3">This brings up the dialog for choosing RAM and number of processors.  I normally 
choose at least "2" for processors so that the installer will opt for 
the SMP (symmetric multip processor) version of the kernel during 
install.  Click on "Forward". </font></p><p><font size="3"><br /></font></p><div style="display:block;text-align:left"><a href="kvm-openvswitch-1/virt-manager-9.png%3Fattredirects=0" imageanchor="1"><img border="0" src="../_/rsrc/1518480256917/kvm-and-openvswitch/kvm-openvswitch-1/virt-manager-9.png" /></a></div><br /><p><font size="3">The summary of the KVM guest to be created is shown.  Tick the "Customize configuration before install" box, and also expand the "Advanced Options" so that you can see the additional features.  The "Advanced Options" should be set as shown by default.  If they are not, set them as shown.  Your MAC address will differ from that shown, no need to change it.  Click on "Finish".
</font></p><p><font size="3"><br /></font>
</p>
<div style="display:block;text-align:left"><a href="kvm-openvswitch-1/virt-manager-10.png%3Fattredirects=0" imageanchor="1"><img border="0" src="../_/rsrc/1518480256917/kvm-and-openvswitch/kvm-openvswitch-1/virt-manager-10.png" /></a></div>
<p><font size="3"><br /></font>
</p><p><font size="3">The KVM guest customizations screen is shown next below.</font></p><p><font size="3"><br />
</font></p><div style="display:block;text-align:left"><font size="3"><a href="kvm-openvswitch-1/virt-manager-11.png%3Fattredirects=0" imageanchor="1"><img border="0" src="../_/rsrc/1518480256917/kvm-and-openvswitch/kvm-openvswitch-1/virt-manager-11.png" /></a></font></div><font size="3"><br /></font>
<p><font size="3">Click on the  option in the left pane "Disk 1" which brings up the customization options for the disk.  Set the values as shown in the screenshot below.  These values are needed so that the high-performance feature for high KVM guest bandwidth and IOPS called virtio-blk-data-plane can be set for the virtual disk later. The key settings are as follows: <br /></font></p><font size="3"> Disk Bus:        Virtio <br /></font><br /><font size="3">Cache Mode: none <br /></font><br /><font size="3">IO mode:         native</font><br /></div><div dir="ltr" lang="en">
<p><font size="3"><br /></font>
</p><div style="display:block;text-align:left"><font size="3"><a href="kvm-openvswitch-1/virt-manager-12.png%3Fattredirects=0" imageanchor="1"><img border="0" src="../_/rsrc/1518480256917/kvm-and-openvswitch/kvm-openvswitch-1/virt-manager-12.png" /></a></font></div>
<br /><br /></div><div lang="en"><font size="3">Verify that the Disk bus, Cache mode, and IO mode are all as indicated above and click on "Apply".</font><br /></div><div dir="ltr" lang="en"><p><font size="3">Now click on "Begin Installation" in the upper-left-hand corner on the same dialog box as shown.  A smal dialog box will briefly flash showing that the installation is about to begin, and then a new window will open which is the new virtual KVM running the ISO installation file.</font></p><p><font size="3"><br />
</font></p><div style="display:block;text-align:left"><font size="3"><a href="kvm-openvswitch-1/ubuntu-1.png%3Fattredirects=0" imageanchor="1"><img border="0" src="../_/rsrc/1518480256916/kvm-and-openvswitch/kvm-openvswitch-1/ubuntu-1.png" /></a></font></div><font size="3"><br /></font>
<p><font size="3">Select the language for the new KVM guest as shown.  In this case accepted the default of "English".  With your cursor inside the KVM window (cursor "captured") simply hit &lt;Enter&gt; to accept "English" as the language.
</font></p><p><font size="3">Note:  With KVM, if you need to escape your cursor out of the KVM guest back to the Ubuntu host OS desktop, you can press left &lt;ctrl&gt; + &lt;alt&gt; to escape the cursor from the KVM guest window.
</font></p><p><font size="3">Not all installation dialog screens are shown below as installation of the Ubuntu Server 14.04.1 OS is not the focus of this wiki.  However, a few screenshots are included for some screens that are relevant to the topic of this wiki.  If you need help installing the Ubuntu Server 14.04.1 OS you can check these references for more information.
</font></p><p><font size="3">[ Add references here ]
</font></p><p><font size="3">The "Install Ubuntu Server" splash screen is shown next.  Again, accept defaults as shown, and hit &lt;Enter&gt;. <br /></font></p><p><font size="3"><br /></font></p><div style="display:block;text-align:left"><font size="3"><a href="kvm-openvswitch-1/ubuntu-2.png%3Fattredirects=0" imageanchor="1"><img border="0" src="../_/rsrc/1518480256916/kvm-and-openvswitch/kvm-openvswitch-1/ubuntu-2.png" /></a></font></div><font size="3"><br />
</font><font size="3">
</font><p><font size="3">Several more screens will be presented. Go through the install of the Ubuntu Server 14.04.1 (details are beyond scope of this present wiki).  There are many good rereferences on the internet for how to install Ubuntu Server 14.04.1  The installation completes and the KVM guest is rebooted. Login to the screen at the prompt with your username (not root, this is Ubuntu!) and your password.
</font></p>
<h3><a name="TOC-Modify-XML-of-KVM-Guest-for-OpenvSwitch"></a><font size="3"><span>Modify XML of KVM Guest for OpenvSwitch</span></font></h3>
<p><font size="3">The xml of the KVM guest as created uses the default KVM networking.  It needs to be changed over to OpenvSwitch.  There were some good notes on how to do this <a href="http://lost-and-found-narihiro.blogspot.com/2014/07/ubuntu-1404-install-open-vswitch-with.html" rel="nofollow">here.</a>  The section of KVM guest xml that needs to be changed is shown below.  The editing of the xml of the KVM guest is done with the command "virsh edit &lt;kvm-guest-name&gt;" as shown below. <br /></font></p><p><font size="3"><br /></font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem:~ $ virsh edit kvm1</code></font></div>
</font></pre>
<p><font size="3">This command displays the xml in an editor (usually vi by default).  The section that needs edit for OpenvSwitch is shown below.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>    &lt;interface type='network'&gt;
      &lt;mac address='52:54:00:48:53:03'/&gt;
      &lt;model type='virtio'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03' function='0x0'/&gt;
    &lt;/interface&gt;</code></font></div>
</font></pre>
<p><font size="3">It needs to be changed to the following for OpenvSwitch as shown below.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>    &lt;interface type='bridge'&gt;
      &lt;mac address='52:54:00:48:53:03'/&gt;
      &lt;virtualport type='openvswitch'/&gt;
      &lt;target dev='s1'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03' function='0x0'/&gt;
    &lt;/interface&gt;</code></font></div>
</font></pre>
<p><font size="3">Save the changes in the usual way.  Note that KVM guest xml should not be edited by finding the file on the OS and "vi" it.  Normally the edits will not stick when done in that way.   Always use "virsh edit &lt;kvm-guest-name&gt;" to edit KVM xml files. 
</font></p><p><font size="3">Once you have saved it now use virsh to dump the edited XML so you can see the additional edits that KVM has made automatically as a result of the change to OpenvSwitch as shown below. KVM has added some additional code automatically. <br /></font></p><p><font size="3"><br /></font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>    &lt;interface type='bridge'&gt;
      &lt;mac address='52:54:00:48:53:03'/&gt;
      &lt;virtualport type='openvswitch'&gt;
        &lt;parameters interfaceid='4236e500-4303-49de-8bd0-f2517dc5f346'/&gt;
      &lt;/virtualport&gt;
      &lt;target dev='s1'/&gt;
      &lt;model type='rtl8139'/&gt;
      &lt;alias name='net0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03' function='0x0'/&gt;
    &lt;/interface&gt;</code></font></div>
</font></pre>
<p><font size="3">As we can see above, the KVM guest has indeed gotten an IP address issued to it on the range we specified for the sw1 switch. Test ssh now to the KVM guest and vice-versa from the KVM host as shown below. <br /></font></p><p><font size="3"><br /></font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem1:~$ ssh 10.207.39.51  </code><b><code>&lt;-- Now test ssh from the KVM host to the KVM guest.</code></b><code>

The authenticity of host '10.207.39.51 (10.207.39.51)' can't be established.
ECDSA key fingerprint is fb:5b:72:0b:6f:de:cd:a1:13:80:00:41:87:09:e5:48.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '10.207.39.51' (ECDSA) to the list of known hosts.

gstanden@10.207.39.51's password: 

Welcome to Ubuntu 14.04.1 LTS (GNU/Linux 3.13.0-32-generic x86_64)
.</code><code>
.<br />.<br /><br />Last login: Fri Aug  8 19:32:23 2014

gstanden@kvm1:~$ ssh 10.207.39.1  </code><b><code>&lt;-- Now test ssh in the other direction back to the KVM host.</code></b><code>

The authenticity of host '10.207.39.1 (10.207.39.1)' can't be established.
ECDSA key fingerprint is 44:06:d9:20:e5:d3:cb:dc:c9:76:cc:ea:8b:71:e9:99.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '10.207.39.1' (ECDSA) to the list of known hosts.<br /><br />gstanden@10.207.39.1's password: <br />
Welcome to Ubuntu 14.04.1 LTS (GNU/Linux 3.13.0-32-generic x86_64)</code></font><code>.</code>
<pre><font size="3"><font size="4"><code>.</code><code>
.<br />.<br /></code></font></font></pre><font size="4"><code>Last login: Fri Aug  8 10:18:10 2014 from 10.207.39.20<br /><br />gstanden@vmem1:~$</code></font></div>
</font></pre>
<p><font size="3">So now it is no longer necessary to use the virt-manager console to access the KVM guest.  We have full ssh access two-way between KVM host and guest.  Because the DHCP was built by us for our OpenvSwitch we have full control over the details of our DHCP client as well.
</font></p>
<h3><a name="TOC-Configure-KVM-Guest-for-Console-Access"></a><font size="3"><span>Configure KVM Guest for Console Access</span></font></h3>
<p><font size="3">Even though ssh has been established, it would be useful to have console access without having to resort to the GUI virt-manager console which is small and limiting.  We can configure console access easily according to the instructions <a href="http://www.jaredlog.com/?p=1484" rel="nofollow">here</a>.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@kvm1:~$ sudo cp /etc/init/tty1.conf /etc/init/ttyS0.conf
[sudo] password for gstanden: 

gstanden@kvm1:~$ sudo vi /etc/init/ttyS0.conf

gstanden@kvm1:~$ cat /etc/init/ttyS0.conf 
# tty1 - getty
#
# This service maintains a getty on tty1 from the point the system is
# started until it is shut down again.

start on stopped rc RUNLEVEL=[2345] and (
            not-container or
            container CONTAINER=lxc or
            container CONTAINER=lxc-libvirt)

stop on runlevel [!2345]

respawn
</code><b><code>exec /sbin/getty -8 115200 ttyS0 xterm</code></b><code>

gstanden@kvm1:~$</code></font></div>
</font></pre>
<p><font size="3"><br />
Now edit the following file to tell grub to output all messages to the console as shown below.  The line that needs to be edited is "GRUB_CMDLINE_LINUX_DEFAULT" which needs to be set to "console=ttyS0" as shown below (bolded line).
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@kvm1:~$ cat /etc/default/grub
# If you change this file, run 'update-grub' afterwards to update
# /boot/grub/grub.cfg.
# For full documentation of the options in this file, see:
#   info -f grub -n 'Simple configuration'

GRUB_DEFAULT=0
#GRUB_HIDDEN_TIMEOUT=0
GRUB_HIDDEN_TIMEOUT_QUIET=true
GRUB_TIMEOUT=2
GRUB_DISTRIBUTOR=`lsb_release -i -s 2&gt; /dev/null || echo Debian`

</code><b><code>GRUB_CMDLINE_LINUX_DEFAULT="console=ttyS0"</code></b><code>

GRUB_CMDLINE_LINUX=""

# Uncomment to enable BadRAM filtering, modify to suit your needs
# This works with Linux (no patch required) and with any kernel that obtains
# the memory map information from GRUB (GNU Mach, kernel of FreeBSD ...)
#GRUB_BADRAM="0x01234567,0xfefefefe,0x89abcdef,0xefefefef"

# Uncomment to disable graphical terminal (grub-pc only)
#GRUB_TERMINAL=console

# The resolution used on graphical terminal
# note that you can use only modes which your graphic card supports via VBE
# you can see them in real GRUB with the command `vbeinfo'
#GRUB_GFXMODE=640x480

# Uncomment if you don't want GRUB to pass "root=UUID=xxx" parameter to Linux
#GRUB_DISABLE_LINUX_UUID=true

# Uncomment to disable generation of recovery mode menu entries
#GRUB_DISABLE_RECOVERY="true"

# Uncomment to get a beep at grub start
#GRUB_INIT_TUNE="480 440 1"
gstanden@kvm1:~$</code></font></div>
</font></pre>
<p><font size="3"><br />
After making this change, you must update grub as shown below.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@kvm1:~$ sudo update-grub2

[sudo] password for gstanden: 
Generating grub configuration file ...
Found linux image: /boot/vmlinuz-3.13.0-32-generic
Found initrd image: /boot/initrd.img-3.13.0-32-generic
Found memtest86+ image: /memtest86+.elf
Found memtest86+ image: /memtest86+.bin
done

gstanden@kvm1:~$
</code></font></div></font></pre>
<p><font size="3"><br />
Shutdown the KVM guest after making this change as shown below.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@kvm1:~$ sudo shutdown -h now
[sudo] password for gstanden:</code></font></div>
</font></pre>
<p><font size="3"><br />
Reboot the KVM guest as shown below and then connect to the console using virsh command.  The guest outputs all standard console output now to the terminal session.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem1:~$ virsh start kvm1
Domain kvm1 started

gstanden@vmem1:~$ virsh console kvm1
Connected to domain kvm1
Escape character is ^]
ffffff]
[    0.000000]   Normal   empty
[    0.000000] Movable zone start for each node
[    0.000000] Early memory node ranges
[    0.000000]   node   0: [mem 0x00001000-0x0009efff]
[    0.000000]   node   0: [mem 0x00100000-0x3fffdfff]
[    0.000000] ACPI: PM-Timer IO Port: 0xb008
         .
         .
         .

 * Starting Postfix Mail Transport Agent postfix                         [ OK ] 
 * Restoring resolver state...                                           [ OK ] 
 * Stopping System V runlevel compatibility                              [ OK ]

Ubuntu 14.04.1 LTS kvm1 ttyS0

kvm1 login: gstanden
Password: 
Last login: Fri Aug  8 21:17:00 CDT 2014 on ttyS0
Welcome to Ubuntu 14.04.1 LTS (GNU/Linux 3.13.0-32-generic x86_64)

        .
        .
        .

gstanden@kvm1:~$</code></font></div>
</font></pre>
<h3><a name="TOC-Configure-DHCP-for-OpenvSwitch"></a><font size="3"><span>Configure DHCP for OpenvSwitch</span></font></h3><p><font size="3">Some guides available on this topic use the approach of attaching the internet-connected physical interface to the OpenvSwitch to obtain a DHCP address generated by the actual physical network DHCP provider, for example, in a home network, your internet router. The drawback to this is that if the KVM host (my laptop for example) is taken elsewhere (say to Starbucks, a customer site, or an airport) the network providing internet service, and hence the DHCP address assigned to the KVM guest, will change to match the network being used (e.g. Starbucks network).  In general, we typically want enterprise KVM guests to have a static IP, or at very least always obtain an IP on the same IP network address range (e.g. 10.207.39.x) so we'd rather that the KVM guest get it's IP from a DHCP source that does not change no matter what network the KVM host is on for it's extenal internet.  So that is the primary driver for not deriving IP addresses for the KVM guest when the KVM host is a laptop (in my case a Lenovo W520 Mobile Workstation with 32 Gb of RAM).
</font></p><p><font size="3">The OpenvSwitch "sw1" needs to be able to provide DHCP addresses to the KVM guests.  That was why during the packages install isc-dhcp-server package was installed.  Now we will configue that dhcp service to deliver IP addresses to KVM guests which are attached to that OpenvSwitch (in this case the switch is called "sw1").  Edit the configuration file as shown below.  Once the file has been edited to provide DHCP IP addresses to KVM guests attached to sw1 network, restart the isc-dhcp-server service for the configuration changes to take effect.  Note that this part of the configuration is again from the reference at <a href="https://www.virtualbox.org/wiki/Advanced_Networking_Linux" rel="nofollow">Advanced Networking Page by Jean-Jacques Sarton</a>.  I have shown below the entire file, as modified which actually exists on my test system.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem1:~$ sudo cat /etc/dhcp/dhcpd.conf
[sudo] password for gstanden: 
#
# Sample configuration file for ISC dhcpd for Debian
#
# Attention: If /etc/ltsp/dhcpd.conf exists, that will be used as
# configuration file instead of this file.
#
#

# The ddns-updates-style parameter controls whether or not the server will
# attempt to do a DNS update when a lease is confirmed. We default to the
# behavior of the version 2 packages ('none', since DHCP v2 didn't
# have support for DDNS.)

</code><b><code>ddns-update-style interim;</code></b><code>
ignore client-updates;

# option definitions common to all supported networks...
option domain-name "example.org";
option domain-name-servers ns1.example.org, ns2.example.org;

default-lease-time 600;
max-lease-time 7200;

# If this DHCP server is the official DHCP server for the local
# network, the authoritative directive should be uncommented.
#authoritative;

# Use this to send dhcp log messages to a different log file (you also
# have to hack syslog.conf to complete the redirection).
log-facility local7;

# No service will be given on this subnet, but declaring it helps the 
# DHCP server to understand the network topology.

#subnet 10.152.187.0 netmask 255.255.255.0 {
#}

# This is a very basic subnet declaration.

#subnet 10.254.239.0 netmask 255.255.255.224 {
#  range 10.254.239.10 10.254.239.20;
#  option routers rtr-239-0-1.example.org, rtr-239-0-2.example.org;
#}

# This declaration allows BOOTP clients to get dynamic addresses,
# which we don't really recommend.

#subnet 10.254.239.32 netmask 255.255.255.224 {
#  range dynamic-bootp 10.254.239.40 10.254.239.60;
#  option broadcast-address 10.254.239.31;
#  option routers rtr-239-32-1.example.org;
#}

# A slightly different configuration for an internal subnet.
#subnet 10.5.5.0 netmask 255.255.255.224 {
#  range 10.5.5.26 10.5.5.30;
#  option domain-name-servers ns1.internal.example.org;
#  option domain-name "internal.example.org";
#  option routers 10.5.5.1;
#  option broadcast-address 10.5.5.31;
#  default-lease-time 600;
#  max-lease-time 7200;
#}

# Hosts which require special configuration options can be listed in
# host statements.   If no address is specified, the address will be
# allocated dynamically (if possible), but the host-specific information
# will still come from the host declaration.

#host passacaglia {
#  hardware ethernet 0:0:c0:5d:bd:95;
#  filename "vmunix.passacaglia";
#  server-name "toccata.fugue.com";
#}

# Fixed IP addresses can also be specified for hosts.   These addresses
# should not also be listed as being available for dynamic assignment.
# Hosts for which fixed IP addresses have been specified can boot using
# BOOTP or DHCP.   Hosts for which no fixed address is specified can only
# be booted with DHCP, unless there is an address range on the subnet
# to which a BOOTP client is connected which has the dynamic-bootp flag
# set.
#host fantasia {
#  hardware ethernet 08:00:07:26:c0:a5;
#  fixed-address fantasia.fugue.com;
#}

# You can declare a class of clients and then do address allocation
# based on that.   The example below shows a case where all clients
# in a certain class get addresses on the 10.17.224/24 subnet, and all
# other clients get addresses on the 10.0.29/24 subnet.

#class "foo" {
#  match if substring (option vendor-class-identifier, 0, 4) = "SUNW";
#}

#shared-network 224-29 {
#  subnet 10.17.224.0 netmask 255.255.255.0 {
#    option routers rtr-224.example.org;
#  }
#  subnet 10.0.29.0 netmask 255.255.255.0 {
#    option routers rtr-29.example.org;
#  }
#  pool {
#    allow members of "foo";
#    range 10.17.224.10 10.17.224.250;
#  }
#  pool {
#    deny members of "foo";
#    range 10.0.29.10 10.0.29.230;
#  }
#}

subnet 10.207.39.0 netmask 255.255.255.0 {

# --- default gateway
	option routers			10.207.39.1;
	option subnet-mask		255.255.255.0;

	option domain-name		"vmem.org";
	option domain-name-servers	10.207.39.1;

#	option ntp-servers		10.207.39.1;

	range dynamic-bootp 10.207.39.50 10.207.39.254;
	default-lease-time 21600;
	max-lease-time 43200;
}
gstanden@vmem1:~$</code></font></div>
</font></pre>
<p><font size="3">Note that if you go to the reference quoted above, it shows that the relevant parts of the configuration file that need to be included are those shown below (which are also in my file shown above).  Note that as shown below, the "range dynamic-bootp" can be changed to set whatever IP range you want to reserve for DHCP (for example if you wanted to reserve some IP addresses on your network for static assignment).  In my case, I have reserved addresses 2-49 for static IP assignments, and addresses 50-254 for DHCP.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>ddns-update-style interim;
ignore client-updates;

subnet 10.207.39.0 netmask 255.255.255.0 {

# --- default gateway
	option routers			10.207.39.1;
	option subnet-mask		255.255.255.0;

	option domain-name		"vmem.org";
	option domain-name-servers	10.207.39.1;

#	option ntp-servers		10.207.39.1;

	range dynamic-bootp 10.207.39.50 10.207.39.254;
	default-lease-time 21600;
	max-lease-time 43200;
}</code></font></div>
</font></pre>
<p><font size="3">Now restart the isc-dhcp-server so that it reads the configuration changes and applies them as shown below.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem1:~$ sudo service isc-dhcp-server restart
[sudo] password for gstanden: 

isc-dhcp-server stop/waiting
isc-dhcp-server start/running, process 7697</code></font></div>
</font></pre>
<h3><a name="TOC-Verify-KVM-Guest-Obtains-IP-Address-from-DHCP-on-OpenvSwitch"></a><font size="3"><span>Verify KVM Guest Obtains IP Address from DHCP on OpenvSwitch</span></font></h3>
<p><font size="3">Now reboot the VM and test if the DHCP provides an IP address to the KVM guest as shown below. Note the IP address in bold in bold which was provided by DHCP to the OpenvSwitch on switch sw1.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem1:~$ virsh start kvm1
Domain kvm1 started

gstanden@vmem1:~$ virsh console kvm1
Connected to domain kvm1
Escape character is ^]
-root ro console=ttyS0
[    0.000000] PID hash table entries: 4096 (order: 3, 32768 bytes)
[    0.000000] Checking aperture...
[    0.000000] No AGP bridge found
        .
        .
        .
 * Starting Postfix Mail Transport Agent postfix                         [ OK ] 
 * Restoring resolver state...                                           [ OK ] 
 * Stopping System V runlevel compatibility                              [ OK ]

Ubuntu 14.04.1 LTS kvm1 ttyS0

kvm1 login: gstanden
Password: 
Last login: Fri Aug  8 21:20:21 CDT 2014 on ttyS0
Welcome to Ubuntu 14.04.1 LTS (GNU/Linux 3.13.0-32-generic x86_64)
        .
        .
        .
gstanden@kvm1:~$ ifconfig
eth0      Link encap:Ethernet  HWaddr 52:54:00:48:53:03  
          inet addr:</code><b><code>10.207.39.51</code></b><code>  Bcast:10.207.39.255  Mask:255.255.255.0
          inet6 addr: fe80::5054:ff:fe48:5303/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:13 errors:0 dropped:0 overruns:0 frame:0
          TX packets:21 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:1434 (1.4 KB)  TX bytes:2106 (2.1 KB)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:24 errors:0 dropped:0 overruns:0 frame:0
          TX packets:24 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:1584 (1.5 KB)  TX bytes:1584 (1.5 KB)

gstanden@kvm1:~$</code></font></div>
</font></pre>
<h3><a name="TOC-Optionally-Configuring-Static-IP-Address-for-KVM-Guest"></a><font size="3"><span>Optionally Configuring Static IP Address for KVM Guest</span></font></h3>
<p><font size="3">Once DHCP has been verified and is working with the new KVM guest, optionally the KVM guest can easily be set to use static IP addressing (on the same IP range as the DHCP server is providing in this example).  To switch your KVM guest to use a static IP on the internet-connected IP range it is necessary to edit the /etc/network/interfaces file inside the KVM guest as shown below.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@san1:~$ cat /etc/network/interfaces

# This file describes the network interfaces available on your system
# and how to activate them. For more information, see interfaces(5).

# The loopback network interface
auto lo
iface lo inet loopback

# The primary network interface
auto eth0
iface eth0 inet static
	address 10.207.39.51
	netmask 255.255.255.0
	network 10.207.39.1
	broadcast 10.207.39.255
	gateway 10.207.39.1

# auto eth0
# iface eth0 inet dhcp

gstanden@san1:~$</code></font></div>
</font></pre>
<p><font size="3">The file as shown has configured the KVM guest for a static IP.  If it was desired to re-configure the KVM guest to obtain an IP address from DHCP, then the file would be changed as shown below.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@san1:~$ cat /etc/network/interfaces

# This file describes the network interfaces available on your system
# and how to activate them. For more information, see interfaces(5).

# The loopback network interface
auto lo
iface lo inet loopback

# The primary network interface
auto eth0
# iface eth0 inet static
#	address 10.207.39.20
#	netmask 255.255.255.0
#	network 10.207.39.1
#	broadcast 10.207.39.255
#	gateway 10.207.39.1

auto eth0
iface eth0 inet dhcp

gstanden@san1:~$</code></font></div>
</font></pre>
<p><font size="3">So as you can see, switching between static and dhcp addressing is quite simple, but is provided for completeness so that it is clear even for those unfamiliar with Ubuntu Server networking files. <br /></font></p><h3><a name="TOC-Configure-DNS-for-KVM-Guest-and-Host-Environments"></a><font size="3">Configure DNS for KVM Guest and Host Environments</font></h3><p><font size="3">This is described <a href="kvm-dns-ul-14-04.html" target="_blank">here</a>and <a href="kvm-dns-oel-6-5.html" target="_blank">here</a> at other pages on this blog.</font><br /></p>
<h3><a name="TOC-Configure-Internet-Access-for-KVM-Guest"></a><font size="3"><span>Configure Internet Access for KVM Guest</span></font></h3>
<p><font size="3">The KVM guest now has ssh host-guest support, and also has console.  What it does not yet have is access to the internet for downloading packages etc.  A common way to address this is to attach eth0 (i.e. the public ethernet interface) to the switch.  However, there are some issues with this is a desktop environment where Ubuntu network-manager is being used, so a different method is employed simply using iptables rules to provide access to the internet.  The reference for this is again from the reference <a href="https://www.virtualbox.org/wiki/Advanced_Networking_Linux" rel="nofollow">Advanced Networking Page by Jean-Jacques Sarton</a> .  The rules used to establish this networking are described in this section as shown below.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem1:~$ cat crt_nat.sh
INTIF="sw1"
EXTIF="eth0"
echo 1 &gt; /proc/sys/net/ipv4/ip_forward

# clear existing iptable rules, set a default policy
iptables -P INPUT ACCEPT
iptables -F INPUT 
iptables -P OUTPUT ACCEPT
iptables -F OUTPUT 
iptables -P FORWARD DROP
iptables -F FORWARD 
iptables -t nat -F

# set forwarding and nat rules
iptables -A FORWARD -i $EXTIF -o $INTIF -j ACCEPT
iptables -A FORWARD -i $INTIF -o $EXTIF -j ACCEPT
iptables -t nat -A POSTROUTING -o $EXTIF -j MASQUERADE

gstanden@vmem1:~$</code></font></div>
</font></pre>
<p><font size="3">As stated at the reference <a href="https://www.virtualbox.org/wiki/Advanced_Networking_Linux" rel="nofollow">Advanced Networking Page by Jean-Jacques Sarton</a> for this method to work, INTIF is set to the name of the OpenvSwitch, and EXTIF is set to the physical interface which is connected to the internet, and then the script is run using sudo as shown below.
</font></p>
<pre><font size="3">gstanden@vmem1:~$ sudo ./crt_nat.sh
</font></pre>
<p><font size="3">First, the /etc/resolv.conf in the guest will have a couple of properties that need to be addressed.  As stated at the reference <a href="https://www.virtualbox.org/wiki/Advanced_Networking_Linux" rel="nofollow">Advanced Networking Page by Jean-Jacques Sarton</a> the /etc/resolv.conf needs to match the same /etc/resolv.conf used by the host.  The /etc/resolv.conf used by the host is shown below.
</font></p>
<div class="sites-codeblock sites-codesnippet-block"><pre><font size="4"><code>gstanden@vmem1:~$ sudo cat /etc/resolv.conf
[sudo] password for gstanden: 

# Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)
#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
nameserver 127.0.1.1
gstanden@vmem1:~$
</code></font></pre><font size="4">
</font><p><font size="4"><code>For the method to be used here to obtain internet for the KVM guest we do not want the host-guest network (i.e. the 10.207.39.1 network) as the nameserver entry in the KVM guest /etc/resolv.conf.  However, as the system is currently configured, that network will automatically be assigned and written to the /etc/resolv.conf of the KVM guest. For example, here is how the /etc/resolv.conf looks at this point in the build before the changes we are about to make to change what gets written to the /etc/resolv.conf of the KVM guest on each boot.
</code></font></p><font size="4">
</font><pre><font size="4"><code>gstanden@kvm1:~$ cat /etc/resolv.conf
# Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)
#     </code><b><code>DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN</code></b><code>
nameserver 10.207.39.1
search vmem.org
gstanden@kvm1:~$</code></font></pre></div>
<p><font size="3">Notice that the /etc/resolv.conf has a commented line that warns that edits by hand to this file will be overwritten.  Therefore the file cannot simply be edited by hand.  Fortunately, a method for assigning a specific nameserver is described <a href="http://www.cyberciti.biz/faq/dhclient-etcresolvconf-hooks/" rel="nofollow">here</a>.  At that reference use "Option #3: Configure dhclient.conf".  The required change is made on Ubuntu Desktop 14.04.1 on the host machine in the /etc/dhcp/dhclient.conf file.  The line that needs to be changed is as follows shown below.  Additional information about options for the /etc/dhcp/dhclient.conf is available <a href="https://calomel.org/dhclient.html" rel="nofollow">here</a>.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>#prepend domain-name-servers 127.0.0.1;</code></font></div>
</font></pre>
<p><font size="3">After the change is made, the file should look like that shown below.  Note that it is possible that the prepend line as shown below may get "re-commented out" automatically (this occurred on my system).  However, when that happened, there must have been other changes as well because the /etc/resolv.conf from then on simply did not have any nameserver entry at all, which apparently defaults to localhost (127.0.0.1) which has they same effect as setting nameserver to 127.0.0.1 explicity.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem1:~$ cat /etc/dhcp/dhclient.conf
# Configuration file for /sbin/dhclient, which is included in Debian's
#	dhcp3-client package.
#
# This is a sample configuration file for dhclient. See dhclient.conf's
#	man page for more information about the syntax of this file
#	and a more comprehensive list of the parameters understood by
#	dhclient.
#
# Normally, if the DHCP server provides reasonable information and does
#	not leave anything out (like the domain name, for example), then
#	few changes must be made to this file, if any.
#

option rfc3442-classless-static-routes code 121 = array of unsigned integer 8;

#send host-name "andare.fugue.com";
send host-name = gethostname();
#send dhcp-client-identifier 1:0:a0:24:ab:fb:9c;
#send dhcp-lease-time 3600;
#supersede domain-name "fugue.com home.vix.com";
</code><b><code>prepend domain-name-servers 127.0.0.1;</code></b><code>
request subnet-mask, broadcast-address, time-offset, routers,
	domain-name, domain-name-servers, domain-search, host-name,
	dhcp6.name-servers, dhcp6.domain-search,
	netbios-name-servers, netbios-scope, interface-mtu,
	rfc3442-classless-static-routes, ntp-servers,
	dhcp6.fqdn, dhcp6.sntp-servers;
#require subnet-mask, domain-name-servers;
#timeout 60;
#retry 60;
#reboot 10;
#select-timeout 5;
#initial-interval 2;
#script "/etc/dhcp3/dhclient-script";
#media "-link0 -link1 -link2", "link0 link1";
#reject 192.33.137.209;

#alias {
#  interface "eth0";
#  fixed-address 192.5.5.213;
#  option subnet-mask 255.255.255.255;
#}
ne
#lease {
#  interface "eth0";
#  fixed-address 192.33.137.200;
#  medium "link0 link1";
#  option host-name "andare.swiftmedia.com";
#  option subnet-mask 255.255.255.0;
#  option broadcast-address 192.33.137.255;
#  option routers 192.33.137.250;
#  option domain-name-servers 127.0.0.1;
#  renew 2 2000/1/12 00:00:01;
#  rebind 2 2000/1/12 00:00:01;
#  expire 2 2000/1/12 00:00:01;
#}
gstanden@vmem1:~$</code></font></div>
</font></pre>
<p><font size="3">Once all these changes have been made, the /etc/resolv.conf file of the guest will look like either one or the other of the two versions listed below.  Make the same change to the /etc/dhcp/dhclient.conf file inside the kvm1 guest as well.  After making the changes to these files on both the host and guest, set the files immutable by using "chattr +i /etc/dhcp/dhclient.conf" so that they will not change.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><code>gstanden@san1:~$ cat /etc/resolv.conf</code></div>

# Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)
#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
</font></pre>
<p><font size="3">Or it might look like this as shown below.  However, for the purposes of obtaining internet, either version of the /etc/resolv.conf will work for providing internet service to the KVM guest.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@san1:~$ cat /etc/resolv.conf

# Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)
#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
nameserver 127.0.0.1</code></font></div>
</font></pre>
<h3><a name="TOC-Enable-the-As-Built-Configuration-to-Survive-Reboots"></a><font size="3"><span>Enable the As-Built Configuration to Survive Reboots</span></font></h3>
<p><font size="3">Summarizing so far we have built a KVM guest, and have set it to use OpenvSwitch "sw1" for networking, and have setup host-guest ssh, internet service for the guest, and console access.  Now we would like to add additional LUNs such that those LUNs use and demonstrate two additional features of KVM.  Some of the things that have been built are dynamic, in the sense that some of the configurations we have built in the preceding steps won't survive reboot of the KVM host Ubuntu Deskop 14.04.1.
</font></p><p><font size="3">In particular, while to OpenvSwitch "sw1" itself will survive reboots (it's skeletal configuration is stored by OpenvSwitch) other features of the switch "sw1" will not survive reboot without additional steps being implemented. Some of those features that will not survive reboot are the addition of the port "s1" to the switch and the assignment of the ip address  10.209.39.1 to the switch "sw1".  Also, the "iptables" rules that were applied will not survive reboot without additonal steps.  Finally, the isc-dhcp-server will not start unless the referenced "sw1" and associated port "s1" is ready prior to it starting.  So, all of these need to be somehow implemented and started on reboot.
</font></p><p><font size="3">Note that there are many ways that these needed items for reboot could be set to occur at reboot.  For example, since this is Ubuntu, the "Upstart" scripting system could be used.  It just happens that despite some efforts during my career to get a good handle on "Upstart" script writing, I've never really embraced or understood it very well.  I'd like to invite anyone who reads this wiki who has alternative solutions to my solution which are more elegant, more efficient, or even just different for the sake of being different to recommend them in the comments.  In my case, I have opted for simply putting a script in the "/etc/rc.local" which takes care of all these things that need to happen on reboot, and it works acceptably for my needs.  However, disclaimer, as mentioned, I know that this is probably the least elegant way to do this.  Below is my /etc/rc.local and below that is the script that is run from the /etc/rc.local file.
</font></p><p><font size="3">My /etc/rc.local file is shown below.  As you can see, in addition to running the necessary script, I also do logging for completeness so that I can see if anything unusual happens during the bootup and run of the crt_ovs.sh script.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem1:~$ cat /etc/rc.local

#!/bin/sh -e
#
# rc.local
#
# This script is executed at the end of each multiuser runlevel.
# Make sure that the script will "exit 0" on success or any other
# value on error.
#
# In order to enable or disable this script just change the execution
# bits.
#
# By default this script does nothing.

</code><b><code>sudo /home/gstanden/crt_ovs.sh 2&gt;&amp;1 &gt; /home/gstanden/crt_ovs.log</code></b><code>
sudo chown gstanden:gstanden /home/gstanden/crt_ovs.log

exit 0

gstanden@vmem1:~$</code></font></div>
</font></pre>
<p><font size="3">Next here is my crt_ovs.sh script as shown below.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem1:~$ cat crt_ovs.sh

# This part sets up the OpenvSwitch

tunctl -t s1
ip link set s1 up
ovs-vsctl add-br sw1
ovs-vsctl add-port sw1 s1
ip link set up dev sw1
ip addr add 10.207.39.1/24 dev sw1
ip route replace 10.207.39.0/24 dev sw1

# This part sets up internet service for the KVM guest using iptables rules
# Change the INTIF and EXTIF to suit your system
# INTIF is the name of your OpenvSwitch
# EXTIF is the name of your internet-connected interface

INTIF="sw1"
EXTIF="eth0"
echo 1 &gt; /proc/sys/net/ipv4/ip_forward

# clear existing iptable rules, set a default policy
iptables -P INPUT ACCEPT
iptables -F INPUT 
iptables -P OUTPUT ACCEPT
iptables -F OUTPUT 
iptables -P FORWARD DROP
iptables -F FORWARD 
iptables -t nat -F

# set forwarding and nat rules
iptables -A FORWARD -i $EXTIF -o $INTIF -j ACCEPT
iptables -A FORWARD -i $INTIF -o $EXTIF -j ACCEPT
iptables -t nat -A POSTROUTING -o $EXTIF -j MASQUERADE

# This part starts the DHCP server for the OpenvSwitch once the switch has been configured above.

service isc-dhcp-server start</code></font></div>
</font></pre>
<h3><a name="TOC-Configure-virtio-blk-data-plane-for-High-IOPS"></a><font size="3"><span>Configure virtio-blk-data-plane for High IOPS</span></font></h3>
<p><font size="3">(1) The virtio-blk-data-plane feature for high bandwidth and IOPs performance in the KVM guest; and
</font></p><p><font size="3">(2) Use of the logical_block_size and physical_block_size parameters to deliver 4K logical/physical sector LUNs to the KVM guest.
</font></p><p><font size="3">To do this we need to add a storage LUN to the KVM guest of type raw *.img.  This is because virtio-blk-data-plane has some restrictions as to type of storage LUN that can be used.  Currently the restrictions on use of virtio-blk-data-plane are described at the <a href="http://blog.vmsplice.net/2013/03/new-in-qemu-14-high-performance-virtio.html" rel="nofollow">Stefan Hajnoczi</a> blog in the section "When can virtio-blk-data-plane be used".  Those restrictions are reproduced here for convenience as shown below. 
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>When can virtio-blk data plane be used?

Data plane is suitable for LVM or raw image file configurations where live migration 
and advanced block features are not needed. This covers many configurations where performance 
is the top priority.

Data plane is still an experimental feature because it only supports a subset of QEMU configurations. 
The QEMU 1.4 feature has the following limitations:

    Image formats are not supported (qcow2, qed, etc).
    Live migration is not supported.
    QEMU I/O throttling is not supported but cgroups blk-io controller can be used.
    Only the default "report" I/O error policy is supported (-drive werror=,rerror=).
    Hot unplug is not supported.
    Block jobs (block-stream, drive-mirror, block-commit) are not supported.</code></font></div>
</font></pre>
<p><font size="3"><br />
Please be aware of the above points if considering KVM, especially for any production implementation.  The virtio-blk-data-plane technology is powerful for world-record-setting performance, but keep in mind, for example, as shown below, that live migration is not supported when using virtio-blk-data-plane, as well as the other noted points.
</font></p><p><font size="3">So let's add a virtual raw img LUN to the "kvm1" guest and configure it for virtio-blk-data-plane.  This wiki shows using the virt-manager GUI to add the virtual storage LUN, but this can also be done with the command line as well.
</font></p><p><font size="3">Open up the virt-manager and open up the kvm1 VM in virt-manager as shown in the screenshot below and highlight the "kvm1" guest and click on the "Open" button in the top left corner area.  Be sure to use the button that has "Open" next to it, not the button to the left of it.
</font></p>
<div style="display:block;text-align:left"><a href="kvm-openvswitch-1/vbdp-1.png%3Fattredirects=0" imageanchor="1"><img border="0" src="../_/rsrc/1518480256916/kvm-and-openvswitch/kvm-openvswitch-1/vbdp-1.png" /></a></div><br />
<p><font size="3"><br /></font>
</p><p><font size="3">Next the "kvm1" guest console opens.  We want the GUI information and hardware addition panel, so click the "i" button in the blue circle that is in the upper left corner area of the "kvm1" guest console screen.
</font></p><p><font size="3"><br /></font>
</p>
<div style="display:block;text-align:left"><a href="kvm-openvswitch-1/vbdp-2.png%3Fattredirects=0" imageanchor="1"><img border="0" src="../_/rsrc/1518480256916/kvm-and-openvswitch/kvm-openvswitch-1/vbdp-2.png" /></a></div>
<p><font size="3"><br /></font>
</p><p><font size="3">Now the "kvm1" guest GUI hardware configuration screen is shown. Click on "Add Hardware" button at lower left of screen.
</font></p><p><font size="3"><br /></font>
</p>
<div style="display:block;text-align:left"><a href="kvm-openvswitch-1/vbdp-3.png%3Fattredirects=0" imageanchor="1"><img border="0" src="../_/rsrc/1518480256916/kvm-and-openvswitch/kvm-openvswitch-1/vbdp-3.png" /></a></div>
<p><font size="3"><br /></font>
</p><p><font size="3">The "Storage" add hardware dialog is the default dialog for "Add Hardware" so it is displayed.  This is the dialog that will be used to create a new virtual LUN for the "kvm1" guest.  Be sure to make the selections as shown below (they are non-default settings so they will have to be selected).  Set them as follows:
</font></p><p><font size="3">Device type:  Virtio disk
</font></p><p><font size="3">Cache mode:  none
</font></p><p><font size="3">Storage format: raw
</font></p><p><font size="3">Then click on "Finish".
</font></p><p><font size="3"><br /></font>
</p>
<div style="display:block;text-align:left"><a href="kvm-openvswitch-1/vbdp-5.png%3Fattredirects=0" imageanchor="1"><img border="0" src="../_/rsrc/1518480256916/kvm-and-openvswitch/kvm-openvswitch-1/vbdp-5.png" /></a></div>
<p><font size="3"><br /></font>
</p><p><font size="3">The "kvm1" hardware overview screen is displayed again.  Click on "Virtio Disk 2" to see the properties of the LUN that has just been created.
</font></p><p><font size="3"><br /></font>
</p>
<div style="display:block;text-align:left"><a href="kvm-openvswitch-1/vbdp-6.png%3Fattredirects=0" imageanchor="1"><img border="0" src="../_/rsrc/1518480256916/kvm-and-openvswitch/kvm-openvswitch-1/vbdp-6.png" /></a></div>
<p><font size="3"><br /></font></p><p><font size="3">The properties of the just-created virtual LUN are displayed.  As shown, the values should be as follows.  It will be necessary to set the IO mode on this screen to "native" as shown below.
</font></p><p><font size="3">Disk bus:  Virtio
</font></p><p><font size="3">Storage format:  raw
</font></p><p><font size="3">Cache Mode:  none
</font></p><p><font size="3">IO mode:  native <br /></font></p><p><font size="3"><br /></font></p><div style="display:block;text-align:left"><font size="3"><a href="kvm-openvswitch-1/vbdp-7.png%3Fattredirects=0" imageanchor="1"><img border="0" src="../_/rsrc/1518480256916/kvm-and-openvswitch/kvm-openvswitch-1/vbdp-7.png" /></a></font></div><font size="3"><br /></font>
<p><font size="3">Note that when changing the IO mode to "native" you will get a dialog box indicating that the change will take effect on the next reboot and the main storage dialog will still say "default".  This is normal.  The change to native will take effect on the next reboot.
</font></p><p><font size="3"><br /></font>
</p>
<div style="display:block;text-align:left"><a href="kvm-openvswitch-1/vbdp-8.png%3Fattredirects=0" imageanchor="1"><img border="0" src="../_/rsrc/1518480256917/kvm-and-openvswitch/kvm-openvswitch-1/vbdp-8.png" /></a></div>
<p><font size="3"><br /></font>
</p><p><font size="3">These steps are done.  The storage has been added.  Now shutdown the "kvm1" guest so that the changes will take affect.  Also, be sure to do a "shutdown" and not a "reboot" because we also have to next do a few edits to the "kvm1" guest XML in order to enable virtio-blk-data-plane on the new LUN.  The "kvm1" guest can be shutdown from the command line of the "kvm1" guest or it can be done from the virt-manager console by right-click on the virt-manager kvm1 line.
</font></p><p><font size="3">Now the xml is edited according to the instructions provided in the blog from  <a href="http://blog.vmsplice.net/2013/03/new-in-qemu-14-high-performance-virtio.html" rel="nofollow">Stefan Hajnoczi at his blog here</a> .  However, I provide the actual steps for "kvm1" guest as shown below.
</font></p><p><font size="3">Verify the guest is not running.  (Note:  it's ok to edit the XML when the guest is running, but I prefer to do it with guest shutdown).
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem1:~$ virsh -c qemu:///system list

 Id    Name                           State
----------------------------------------------------

gstanden@vmem1:~$</code></font></div>
</font></pre>
<p><font size="3">Next edit the xml using the virsh command as shown below.  I've also provided a screenshot of how the edited parts should look because this wiki seemed to have some issues with interpreting the XML below as if it was "wiki" XML and not XML from the "kvm1" guest.  So here is the screenshot, and after that follows a listing of the XML file for the kvm1 guest.
</font></p><p><font size="3">Note also that KVM virtio disks are numbered starting from "0" (zero).  So the second added disk gets the number "1" (one) and so on.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem1:~$ virsh edit kvm1
</code></font></div></font></pre>
<p><font size="3"><br />
The edited xml for the "kvm1" guest when edited successfully will be as shown below. I have bolded the sections that have been changed. NOTE:  due to some issues with the way the wikia interprets XML I had to change the lines which is indicated below which starts with "source file"  to "5ource file" so that the wikia will not interpret it as wikia XML.  Please be sure to use an "s" as shown above in the picture of the edit.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem1:~$ virsh dumpxml kvm1
</code><b><span style="color:rgb(0,0,0)"><code>&lt;domain type='kvm' xmlns:qemu='</code><a href="http://libvirt.org/schemas/domain/qemu/1.0'" rel="nofollow"><code>http://libvirt.org/schemas/domain/qemu/1.0'</code></a><code>&gt;</code></span></b><code>
  &lt;name&gt;kvm1&lt;/name&gt;
  &lt;uuid&gt;db82b8a1-d2ab-0696-28d9-01f88275b880&lt;/uuid&gt;
  &lt;memory unit='KiB'&gt;1048576&lt;/memory&gt;
  &lt;currentMemory unit='KiB'&gt;1048576&lt;/currentMemory&gt;
  &lt;vcpu placement='static'&gt;2&lt;/vcpu&gt;
  &lt;os&gt;
    &lt;type arch='x86_64' machine='pc-i440fx-trusty'&gt;hvm&lt;/type&gt;
    &lt;boot dev='hd'/&gt;
  &lt;/os&gt;
  &lt;features&gt;
    &lt;acpi/&gt;
    &lt;apic/&gt;
    &lt;pae/&gt;
  &lt;/features&gt;
  &lt;clock offset='utc'/&gt;
  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;
  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;
  &lt;on_crash&gt;restart&lt;/on_crash&gt;
  &lt;devices&gt;
    &lt;emulator&gt;/usr/bin/kvm-spice&lt;/emulator&gt;
</code><b><code>    &lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' type='raw' cache='none' io='native'/&gt;
      &lt;source file='/var/lib/libvirt/images/kvm1.img'/&gt;
      &lt;target dev='vda' bus='virtio'/&gt;
      &lt;alias name='virtio-disk0'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x05' function='0x0'/&gt;
    &lt;/disk&gt;
    &lt;disk type='file' device='disk'&gt;
      &lt;driver name='qemu' type='raw' cache='none' io='native'/&gt;
      &lt;source file='/var/lib/libvirt/images/kvm1-1.img'/&gt;
      &lt;target dev='vdb' bus='virtio'/&gt;
      &lt;alias name='virtio-disk1'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x07' function='0x0'/&gt;
    &lt;/disk&gt;</code></b><code>
    &lt;disk type='block' device='cdrom'&gt;
      &lt;driver name='qemu' type='raw'/&gt;
      &lt;target dev='hdc' bus='ide'/&gt;
      &lt;readonly/&gt;
      &lt;address type='drive' controller='0' bus='1' target='0' unit='0'/&gt;
    &lt;/disk&gt;
    &lt;controller type='usb' index='0'&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x01' function='0x2'/&gt;
    &lt;/controller&gt;
    &lt;controller type='pci' index='0' model='pci-root'/&gt;
    &lt;controller type='ide' index='0'&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x01' function='0x1'/&gt;
    &lt;/controller&gt;
    &lt;interface type='bridge'&gt;
      &lt;mac address='52:54:00:48:53:03'/&gt;
      &lt;virtualport type='openvswitch'&gt;
        &lt;parameters interfaceid='4236e500-4303-49de-8bd0-f2517dc5f346'/&gt;
      &lt;/virtualport&gt;
      &lt;target dev='s1'/&gt;
      &lt;model type='rtl8139'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x03' function='0x0'/&gt;
    &lt;/interface&gt;
    &lt;serial type='pty'&gt;
      &lt;target port='0'/&gt;
    &lt;/serial&gt;
    &lt;console type='pty'&gt;
      &lt;target type='serial' port='0'/&gt;
    &lt;/console&gt;
    &lt;input type='mouse' bus='ps2'/&gt;
    &lt;input type='keyboard' bus='ps2'/&gt;
    &lt;graphics type='vnc' port='-1' autoport='yes'/&gt;
    &lt;sound model='ich6'&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x04' function='0x0'/&gt;
    &lt;/sound&gt;
    &lt;video&gt;
      &lt;model type='cirrus' vram='9216' heads='1'/&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x02' function='0x0'/&gt;
    &lt;/video&gt;
    &lt;memballoon model='virtio'&gt;
      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x06' function='0x0'/&gt;
    &lt;/memballoon&gt;
  &lt;/devices&gt;
</code><b><code>  &lt;qemu:commandline&gt;
    &lt;qemu:arg value='-set'/&gt;
    &lt;qemu:arg value='device.virtio-disk0.scsi=off'/&gt;
    &lt;qemu:arg value='-set'/&gt;
    &lt;qemu:arg value='device.virtio-disk0.config-wce=off'/&gt;
    &lt;qemu:arg value='-set'/&gt;
    &lt;qemu:arg value='device.virtio-disk0.x-data-plane=on'/&gt;
    &lt;qemu:arg value='-set'/&gt;
    &lt;qemu:arg value='device.virtio-disk1.scsi=off'/&gt;
    &lt;qemu:arg value='-set'/&gt;
    &lt;qemu:arg value='device.virtio-disk1.config-wce=off'/&gt;
    &lt;qemu:arg value='-set'/&gt;
    &lt;qemu:arg value='device.virtio-disk1.x-data-plane=on'/&gt;
  &lt;/qemu:commandline&gt;</code></b><code>
&lt;/domain&gt;</code></font></div>
</font></pre>
<p><font size="3">Now the "kvm1" guest can be started again using the virsh command as shown below.  Once it is up, we can check to make sure that the x-data-plane option (also know as virtio-blk-data-plane) is actually being used and that the XML was configured correctly for virtio-blk-data-plane.  If everything has been configured correctly, the x-data-plane values for both virtual disks will be returned as "true".  This indicates that the "kvm1" guest is now running with the high bandwidth and high IOPS KVM feature.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem1:~$ virsh start kvm1
Domain kvm1 started


gstanden@vmem1:~$ sudo virsh qemu-monitor-command --hmp kvm1 'info qtree' | grep x-data-plane
[sudo] password for gstanden: 

        x-data-plane = true
        x-data-plane = true

gstanden@vmem1:~$</code></font></div>
</font></pre>
<p><font size="3">Modify Added LUN to use 4K Logical and 4K Physical Block Size Inside KVM Guest
</font></p><p><font size="3">Examine the added LUN inside the KVM guest to see it's properties.  Because I am working on a consumer-grade SSD as my KVM host server storage, the default format of this storage is 512 emulated logical / 4K physical sector size for the physical disk because this is a flash storage device at the KVM host (which are always 4K physical sector size)
</font></p><p><font size="3">Inside the kvm1 guest the format is 512 logical / 512 physical sector sizes.  We can see that as shown below.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@vmem1:~$ sudo fdisk -l /dev/sda6
[sudo] password for gstanden: 

Disk /dev/sda6: 617.5 GB, 617501163520 bytes
255 heads, 63 sectors/track, 75073 cylinders, total 1206056960 sectors
Units = sectors of 1 * 512 = 512 bytes
</code><b><code>Sector size (logical/physical): 512 bytes / 4096 bytes</code></b><code>
I/O size (minimum/optimal): 4096 bytes / 4096 bytes
Disk identifier: 0x00000000

Disk /dev/sda6 doesn't contain a valid partition table

gstanden@vmem1:~$ ssh 10.207.39.51
gstanden@10.207.39.51's password: 
Last login: Sat Aug  9 12:27:59 2014 from 10.207.39.1

gstanden@kvm1:~$ sudo fdisk -l /dev/vdb
[sudo] password for gstanden: 

Disk /dev/vdb: 8589 MB, 8589934592 bytes
16 heads, 63 sectors/track, 16644 cylinders, total 16777216 sectors
</code><b><code>Units = sectors of 1 * 512 = 512 bytes</code></b><code>
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disk identifier: 0x00000000

Disk /dev/vdb doesn't contain a valid partition table</code></font></div>
</font></pre>
<p><font size="3">However, we would like the /dev/vdb disk inside the "kvm1" guest to be 4K logical/4K physical sector size, so that we the virtual LUN inside the KVM guest will behave logically exactly the same way that a physical 4K logical/4K physical LUN would behave.  We can do that by editing the XML of the "kvm1" guest again and making use of some XML settings for this purpose as shown below.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><b><code>  &lt;qemu:commandline&gt;</code></b>
<b><code>    &lt;qemu:arg value='-set'/&gt;</code></b><code>
    &lt;qemu:arg value='device.virtio-disk0.scsi=off'/&gt;
    &lt;qemu:arg value='-set'/&gt;
    &lt;qemu:arg value='device.virtio-disk0.config-wce=off'/&gt;
    &lt;qemu:arg value='-set'/&gt;
    &lt;qemu:arg value='device.virtio-disk0.x-data-plane=on'/&gt;
    &lt;qemu:arg value='-set'/&gt;
    &lt;qemu:arg value='device.virtio-disk1.scsi=off'/&gt;
    &lt;qemu:arg value='-set'/&gt;
    &lt;qemu:arg value='device.virtio-disk1.config-wce=off'/&gt;
    &lt;qemu:arg value='-set'/&gt;
    &lt;qemu:arg value='device.virtio-disk1.x-data-plane=on'/&gt;
</code><b><code>    &lt;qemu:arg value='-set'/&gt;</code></b><code>
    &lt;qemu:arg value='device.virtio-disk1.logical_block_size=4096'/&gt;
    &lt;qemu:arg value='-set'/&gt;
    &lt;qemu:arg value='device.virtio-disk1.physical_block_size=4096'/&gt;
 </code><b><code> &lt;/qemu:commandline&gt;</code></b><code>
&lt;/domain&gt;</code></font></div>
</font></pre>
<p><font size="3">With the addition of this XML the new LUN will now be presented to the "kvm1" guest as a 4K logical/4K physical LUN.  The "kvm1" guest is now shutdown and then restarted (don't use reboot for this) so that we can see the effect of this addition to the XML as shown below.
</font></p>
<pre><font size="3"><div class="sites-codeblock sites-codesnippet-block"><font size="4"><code>gstanden@kvm1:~$ sudo fdisk -l /dev/vdb

Note: sector size is 4096 (not 512)

Disk /dev/vdb: 8589 MB, 8589934592 bytes
16 heads, 56 sectors/track, 2340 cylinders, total 2097152 sectors
</code><b><code>Units = sectors of 1 * 4096 = 4096 bytes</code></b><code>
Sector size (logical/physical): 4096 bytes / 4096 bytes
I/O size (minimum/optimal): 4096 bytes / 4096 bytes
Disk identifier: 0x00000000

Disk /dev/vdb doesn't contain a valid partition table
gstanden@kvm1:~$</code></font></div>
</font></pre>
<p><font size="3">NOTE:  A word of caution about switching a LUN to 4K logical / 4K physical sector size.  Once the LUN has been used for something, i.e. once data has been written to it, it is NOT feasible to switch it to a different sector sizing because it will cause LOSS of usable data on the LUN.  The decision about the sector formatting must be made before the LUN is used for anything.
</font></p><p><font size="3">Similarly, DO NOT convert the LUN on which your KVM guest resides to 4K logical / 4K physical sector size after the machine has been built.  That would need to be done at the time of creation of the kvm guest, and it would need to be done only for a kvm guest OS that supports native 4K disk format, and the kvm guest would have to be built with the command line and not the GUI virt-manager because the GUI install method does not have support for the XML parameters mentioned above which set the sector size.
</font></p>
<h3><a name="TOC-Summary"></a><font size="3"><span>Summary</span></font></h3>
<p><font size="3">That's about it.  Comments, amplifications, suggestions, are all encouraged from anyone who reads, uses, and has suggestions about this topic.  There are many more ways to do some of the things discussed in this wiki, and speaking for myself, I would appreciate if people would share these ideas.  The main goal was to show how a fully-functional KVM setup could be built on an Ubuntu Desktop 14.04.1 Laptop environment in such a way that all the excellent enterprise features of KVM, OpenvSwitch, and Advanced Format 4K Flash Storage could be studied in a portable laptop lab environment, complete with a networking setup that provides both DHCP and static addresses, as well as internet access for the KVM guests, all without disrupting the Network-Manager that comes with Ubuntu Desktop 14.04.1.  I hope you found it helpful.  If you did, please leave a comment. Some of the points to summarize which this wiki was intended to show were the following:
</font></p><p><font size="3">(1) How to build a KVM guest using OpenvSwitch compatible with Network-Manager on a deskop
</font></p><p><font size="3">(2) How to configure DHCP for host-only OpenvSwitch networking and assign DHCP or static addresses to KVM guests
</font></p><p><font size="3">(3) How to establish host-guest two-way ssh over Openvswitch networking
</font></p><p><font size="3">(4) How to establish internet connectivity to the WAN using iptables rules rather than attaching physical interface to OpenvSwitch
</font></p><p><font size="3">(5) How to configure virtio-blk-data-plane for high bandwidth and IOPS inside the KVM guest
</font></p><p><font size="3">(6) How to set the logical sector size and the physical sector size inside the KVM guest.
</font></p><p><font size="3">(7) How to add additional ports to the OpenvSwitch so that additional KVM guests can attach to the OpenvSwitch.
</font></p><p><font size="3">Thank You,
</font></p><p><font size="3">Gilbert Standen
</font></p><p><font size="3">St. Louis, MO
</font></p><p><font size="3">August 2014 <br /></font></p><p><br /></p><div><font size="3"><div class="site-code-embed-container" data-code="&lt;script&gt;&#xA;  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){&#xA;  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),&#xA;  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)&#xA;  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');&#xA;&#xA;  ga('create', 'UA-54224306-1', 'auto');&#xA;  ga('send', 'pageview');&#xA;&#xA;&lt;/script&gt;" data-scrollable="true" style="display:block;float:left;width:480px;height:320px;"></div></font></div><font size="3"><br /></font>
</div></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<div id="sites-attachments-container">
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-subfooter"><div class="sites-subfooter-content"><br /></div></div>
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://accounts.google.com/ServiceLogin?continue=https://sites.google.com/a/orabuntu-lxc.com/brandydandyoracle/kvm-and-openvswitch/kvm-openvswitch-1&amp;service=jotspot">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="../system/app/pages/recentChanges.html">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="../system/app/pages/reportAbuse.html" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com/site">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="https://ssl.gstatic.com/sites/p/c9c36f/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/a/orabuntu-lxc.com/brandydandyoracle/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("2bd", "Navigation", true);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_2bd');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXvbsUtc3zC_LBoVbZyRGtWgFMw4Ymf-i3viiAJfdm0tZe9QhJn8cESI70F9CZcH-tOMW78hZGCY1UFp4lDKryG63WPeaLJfILgc7SJcoEQbZYGlSidlRfFjsDLlYb4BXK9bDsvoELgKIut3fVJVUI6SIyxWyQ/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([1109635200000, 1128902400000, 1130657000000, 1143333000000, 1143806400000, 1145000000000, 1146380000000, 1152489600000, 1159800000000, 1159500000000, 1162095000000, 1162075000000, 1162105500000]);
    gsites.Xhr.send('https://sites.google.com/a/orabuntu-lxc.com/brandydandyoracle/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'https://gg.google.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<script type="text/javascript">
          sites.codeembed.init();
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>
</html>
